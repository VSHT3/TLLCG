/*
THIS IS A GENERATED FILE. DO NOT EDIT DIRECTLY.
Edit files in src/ and run 'npm run build'
*/

var T=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports);var ae=T(($o,Ve)=>{var Qt=["a","an","and","are","as","at","be","by","for","from","has","he","in","is","it","its","of","on","that","the","to","was","will","with","the","this","but","they","have","had","what","when","where","who","which","why","how","all","each","every","both","few","more","most","other","some","such","no","nor","not","only","own","same","so","than","too","very","can","will","just","should","now","my","me","we","us","our","your","their","his","her","i","you","do","does","did","am","been","being","get","got","if","or","may","could","would","should","might","must","one","two","three","four","five","six","seven","eight","nine","ten","there","then","these","those","also","any","about","after","again","before","because","between","during","through","under","over","above","below","up","down","out","off","into","since","until","while","once","here","there","see","saw","seen","go","goes","going","gone","went","want","wanted","make","made","use","used","using","day","days","way","ways","thing","things","yes","no","okay","ok"],Yt={keywordGroups:[],keywords:[{id:"kw-1",keyword:"Keyword1",target:"Keyword1",variations:[],enableTags:!1,linkScope:"vault-wide",scopeFolder:"",useRelativeLinks:!1,blockRef:"",requireTag:"",onlyInNotesLinkingTo:!1,suggestMode:!1,preventSelfLink:!1,groupId:null},{id:"kw-2",keyword:"Keyword2",target:"Keyword2",variations:[],enableTags:!1,linkScope:"vault-wide",scopeFolder:"",useRelativeLinks:!1,blockRef:"",requireTag:"",onlyInNotesLinkingTo:!1,suggestMode:!1,preventSelfLink:!1,groupId:null}],autoLinkOnSave:!1,caseSensitive:!1,firstOccurrenceOnly:!0,autoCreateNotes:!1,newNoteFolder:"",newNoteTemplate:`# {{keyword}}

Created: {{date}}

`,customStopWords:[],preventSelfLinkGlobal:!1,statistics:{totalLinksCreated:0,totalNotesProcessed:0,lastRunDate:null}};Ve.exports={DEFAULT_STOP_WORDS:Qt,DEFAULT_SETTINGS:Yt}});var P=T((Ao,Ke)=>{function Xt(o="id"){return`${o}-${Date.now()}-${Math.random().toString(36).substring(2,11)}`}function es(o){return o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ts(o,e,t=40){let s=Math.max(0,e-t),n=Math.min(o.length,e+t);return"..."+o.substring(s,n)+"..."}function ss(o){return typeof o!="string"?o:o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}function ns(o){let e=[],t="",s=!1;for(let n=0;n<o.length;n++){let a=o[n],i=o[n+1];a==='"'&&s&&i==='"'?(t+='"',n++):a==='"'?s=!s:a===","&&!s?(e.push(t.trim()),t=""):t+=a}return e.push(t.trim()),e}Ke.exports={generateId:Xt,escapeRegex:es,getContext:ts,escapeCSV:ss,parseCSVLine:ns}});var qe=T((No,Re)=>{var{DEFAULT_SETTINGS:G}=ae(),{generateId:os}=P();async function is(o){let e=Object.assign({},G,await o.loadData());if(e.statistics||(e.statistics=G.statistics),(!e.customStopWords||!Array.isArray(e.customStopWords))&&(e.customStopWords=G.customStopWords),e.keywordGroups||(e.keywordGroups=[]),e.keywords)for(let t of e.keywords)t.id||(t.id=os("kw")),t.groupId===void 0&&(t.groupId=null),t.enableTags===void 0&&(t.enableTags=null),t.groupId&&t.enableTags===!1&&(t.enableTags=null),t.linkScope===void 0&&(t.linkScope="vault-wide"),t.scopeFolder===void 0&&(t.scopeFolder=""),t.requireTag===void 0&&(t.requireTag=""),t.onlyInNotesLinkingTo===void 0&&(t.onlyInNotesLinkingTo=null),t.groupId&&t.onlyInNotesLinkingTo===!1&&(t.onlyInNotesLinkingTo=null),t.suggestMode===void 0&&(t.suggestMode=null),t.groupId&&t.suggestMode===!1&&(t.suggestMode=null),t.preventSelfLink===void 0&&(t.preventSelfLink=null),t.groupId&&t.preventSelfLink===!1&&(t.preventSelfLink=null),t.useRelativeLinks===void 0&&(t.useRelativeLinks=null),t.groupId&&t.useRelativeLinks===!1&&(t.useRelativeLinks=null);return e}async function as(o,e){o.isSaving=!0,await o.saveData(e),setTimeout(()=>{o.isSaving=!1},100)}function rs(o){o.isSaving=!1,o._handleExternalSettingsChange=async()=>{if(!o.isSaving)try{let e=await o.loadData();if(o.settings=Object.assign({},G,e),o.settings.statistics||(o.settings.statistics=G.statistics),(!o.settings.customStopWords||!Array.isArray(o.settings.customStopWords))&&(o.settings.customStopWords=G.customStopWords),o.settings.keywords)for(let t of o.settings.keywords)t.enableTags===void 0&&(t.enableTags=!1),t.linkScope===void 0&&(t.linkScope="vault-wide"),t.scopeFolder===void 0&&(t.scopeFolder=""),t.useRelativeLinks===void 0&&(t.useRelativeLinks=!1),t.blockRef===void 0&&(t.blockRef=""),t.requireTag===void 0&&(t.requireTag=""),t.onlyInNotesLinkingTo===void 0&&(t.onlyInNotesLinkingTo=!1)}catch(e){}}}Re.exports={loadSettings:is,saveSettings:as,setupSettingsWatcher:rs}});var oe=T((Io,Oe)=>{function ls(o,e){try{let t=o.vault.getMarkdownFiles(),s=null,n=e.endsWith(".md")?e.slice(0,-3):e;for(let l of t){if(l.basename.toLowerCase()===n.toLowerCase()){s=l;break}if((l.path.endsWith(".md")?l.path.slice(0,-3):l.path).toLowerCase()===n.toLowerCase()){s=l;break}}if(!s)return[];let a=o.metadataCache.getFileCache(s);if(!a||!a.frontmatter)return[];let i=a.frontmatter,r=[];return i.aliases&&(Array.isArray(i.aliases)?r=r.concat(i.aliases):typeof i.aliases=="string"&&r.push(i.aliases)),i.alias&&(Array.isArray(i.alias)?r=r.concat(i.alias):typeof i.alias=="string"&&r.push(i.alias)),r.filter(l=>l&&typeof l=="string"&&l.trim())}catch(t){return console.error("Error getting aliases for note:",e,t),[]}}function cs(o,e,t){try{if(!t||t.trim()==="")return!0;let s=t.trim().replace(/^#/,"").toLowerCase(),n=null,a=o.vault.getMarkdownFiles(),i=e.replace(/\.md$/,"");for(let l of a){if(l.basename.toLowerCase()===i.toLowerCase()){n=l;break}if((l.path.endsWith(".md")?l.path.slice(0,-3):l.path).toLowerCase()===i.toLowerCase()){n=l;break}}if(!n)return!1;let r=o.metadataCache.getFileCache(n);if(!r)return!1;if(r.frontmatter){let l=r.frontmatter,c=[];l.tags&&(Array.isArray(l.tags)?c=l.tags:typeof l.tags=="string"&&(c=[l.tags])),l.tag&&(Array.isArray(l.tag)?c=c.concat(l.tag):typeof l.tag=="string"&&c.push(l.tag));for(let u of c)if(typeof u=="string"&&u.replace(/^#/,"").toLowerCase()===s)return!0}if(r.tags){for(let l of r.tags)if(l.tag.replace(/^#/,"").toLowerCase()===s)return!0}return!1}catch(s){return console.error("Error checking tag for note:",e,s),!1}}function ds(o,e,t){try{if(!e)return!1;let s=o.metadataCache.getFileCache(e);if(!s||!s.links||s.links.length===0)return!1;let n=t.replace(/\.md$/,"").toLowerCase();for(let a of s.links){let i=a.link.toLowerCase();if(i===n||i.endsWith("/"+n)||n.endsWith("/"+i))return!0;let r=o.metadataCache.getFirstLinkpathDest(a.link,e.path);if(r){let l=r.basename.toLowerCase(),c=n.split("/").pop();if(l===c)return!0}}return!1}catch(s){return console.error("Error checking links in note:",e.path,s),!1}}async function us(o,e,t){if(o.vault.getMarkdownFiles().find(l=>l.basename===t))return;let a=e.newNoteFolder||"",i=a?`${a}/${t}.md`:`${t}.md`,r=e.newNoteTemplate;r=r.replace(/{{keyword}}/g,t),r=r.replace(/{{date}}/g,new Date().toISOString().split("T")[0]),a&&(o.vault.getAbstractFileByPath(a)||await o.vault.createFolder(a)),await o.vault.create(i,r)}function gs(o,e){let t=o.vault.getMarkdownFiles(),s=e.endsWith(".md")?e.slice(0,-3):e;for(let n of t)if(n.basename.toLowerCase()===s.toLowerCase()||(n.path.endsWith(".md")?n.path.slice(0,-3):n.path).toLowerCase()===s.toLowerCase())return n;return null}Oe.exports={getAliasesForNote:ls,noteHasTag:cs,noteHasLinkToTarget:ds,ensureNoteExists:us,findTargetFile:gs}});var re=T((Do,ze)=>{var{getAliasesForNote:ps}=oe();function Pe(o,e){let t={enableTags:!1,linkScope:"vault-wide",scopeFolder:"",useRelativeLinks:!1,blockRef:"",requireTag:"",onlyInNotesLinkingTo:!1,suggestMode:!1,preventSelfLink:!1};if(e.groupId){let s=o.keywordGroups.find(n=>n.id===e.groupId);s&&s.settings&&Object.assign(t,s.settings)}return e.enableTags!==null&&e.enableTags!==void 0&&(t.enableTags=e.enableTags),e.linkScope!==null&&e.linkScope!==void 0&&e.linkScope!=="vault-wide"&&(t.linkScope=e.linkScope),e.scopeFolder!==null&&e.scopeFolder!==void 0&&e.scopeFolder!==""&&(t.scopeFolder=e.scopeFolder),e.useRelativeLinks!==null&&e.useRelativeLinks!==void 0&&(t.useRelativeLinks=e.useRelativeLinks),e.blockRef!==null&&e.blockRef!==void 0&&e.blockRef!==""&&(t.blockRef=e.blockRef),e.requireTag!==null&&e.requireTag!==void 0&&e.requireTag!==""&&(t.requireTag=e.requireTag),e.onlyInNotesLinkingTo!==null&&e.onlyInNotesLinkingTo!==void 0&&(t.onlyInNotesLinkingTo=e.onlyInNotesLinkingTo),e.suggestMode!==null&&e.suggestMode!==void 0&&(t.suggestMode=e.suggestMode),e.preventSelfLink!==null&&e.preventSelfLink!==void 0&&(t.preventSelfLink=e.preventSelfLink),t}function hs(o,e){let t={};for(let s of e.keywords){if(!s.keyword||!s.keyword.trim()||!s.target||!s.target.trim())continue;let n=Pe(e,s);if(t[s.keyword]={target:s.target,...n,keywordIndex:e.keywords.indexOf(s)},s.variations&&s.variations.length>0)for(let i of s.variations)i.trim()&&(t[i]={target:s.target,...n,keywordIndex:e.keywords.indexOf(s)});let a=ps(o,s.target);if(a&&a.length>0)for(let i of a)i.trim()&&(t[i]||(t[i]={target:s.target,...n,keywordIndex:e.keywords.indexOf(s)}))}return t}function fs(o,e,t,s,n,a){if(s==="vault-wide")return!0;let i=e.parent?e.parent.path:"";if(s==="same-folder"){let r=a(o,t);if(!r)return!1;let l=r.parent?r.parent.path:"";return i===l}if(s==="source-folder"){if(!n)return!0;let r=n.replace(/^\/+|\/+$/g,""),l=i.replace(/^\/+|\/+$/g,"");return l===r||l.startsWith(r+"/")}if(s==="target-folder"){if(!n)return!0;let r=a(o,t);if(!r)return!1;let l=r.parent?r.parent.path:"",c=n.replace(/^\/+|\/+$/g,""),u=l.replace(/^\/+|\/+$/g,"");return u===c||u.startsWith(c+"/")}return!0}ze.exports={getEffectiveKeywordSettings:Pe,buildKeywordMap:hs,checkLinkScope:fs}});var Ge=T((Fo,We)=>{var{DEFAULT_STOP_WORDS:ws}=ae();function le(o){let e=new Set(ws);if(o.customStopWords&&Array.isArray(o.customStopWords))for(let t of o.customStopWords)t&&typeof t=="string"&&e.add(t.toLowerCase().trim());return e}function Q(o,e,t){let s=[],n=le(t),a=o.split(/[\s\-_\/\\,;:]+/);for(let i of a){let r=i.split(/(?=[A-Z])/).filter(l=>l.length>0);for(let l of r){let c=l.trim().replace(/[^\w\s]/g,"").trim();c.length!==0&&(c=c.charAt(0).toUpperCase()+c.slice(1).toLowerCase(),c.length>=3&&!n.has(c.toLowerCase())&&s.push(c))}}return s}function Y(o,e){let t=[],s=le(e),n=o.split(/[.\n]/);for(let a of n){let i=a.match(/\b[A-Z][a-z]+(?:\s+[A-Z][a-z]+){1,3}\b/g);if(i)for(let r of i)r=r.trim(),r.split(/\s+/).some(u=>!s.has(u.toLowerCase()))&&r.length>=5&&t.push(r)}return t}async function ks(o,e,t){let s=o.vault.getMarkdownFiles(),n=new Map,a=new Map,i=new Set(e.keywords.map(l=>l.keyword.toLowerCase()));for(let l of e.keywords)if(l.variations&&l.variations.length>0)for(let c of l.variations)i.add(c.toLowerCase());for(let l of e.keywords){let c=t(l.target);if(c&&c.length>0)for(let u of c)i.add(u.toLowerCase())}for(let l of s){let c=Q(l.basename,!0,e),u=Y(l.basename,e);for(let d of c)if(!i.has(d.toLowerCase())){n.has(d)||n.set(d,{count:0,notes:new Set});let p=n.get(d);p.count+=3,p.notes.add(l.basename)}for(let d of u)if(!i.has(d.toLowerCase())){a.has(d)||a.set(d,{count:0,notes:new Set});let p=a.get(d);p.count+=3,p.notes.add(l.basename)}try{let k=(await o.vault.read(l)).substring(0,5e3).replace(/^---[\s\S]*?---\n/,"");k=k.replace(/\[\[([^\]|]+)(?:\|[^\]]+)?\]\]/g,""),k=k.replace(/\[([^\]]+)\]\([^)]+\)/g,"");let h=Q(k,!1,e),g=Y(k,e);for(let f of h)if(!i.has(f.toLowerCase())){n.has(f)||n.set(f,{count:0,notes:new Set});let w=n.get(f);w.count+=1,w.notes.add(l.basename)}for(let f of g)if(!i.has(f.toLowerCase())){a.has(f)||a.set(f,{count:0,notes:new Set});let w=a.get(f);w.count+=1,w.notes.add(l.basename)}}catch(d){console.log(`Error reading ${l.path}:`,d)}}let r=[];for(let[l,c]of n)r.push({keyword:l,count:c.count,notes:Array.from(c.notes).slice(0,5),totalNotes:c.notes.size});for(let[l,c]of a)r.push({keyword:l,count:c.count,notes:Array.from(c.notes).slice(0,5),totalNotes:c.notes.size});return r.sort((l,c)=>c.count!==l.count?c.count-l.count:c.keyword.length-l.keyword.length),r}async function ys(o,e,t,s){let n=new Map,a=new Map,i=new Set(e.keywords.map(u=>u.keyword.toLowerCase()));for(let u of e.keywords)if(u.variations&&u.variations.length>0)for(let d of u.variations)i.add(d.toLowerCase());for(let u of e.keywords){let d=s(u.target);if(d&&d.length>0)for(let p of d)i.add(p.toLowerCase())}let r=Q(t.basename,!0,e),l=Y(t.basename,e);for(let u of r)if(!i.has(u.toLowerCase())){n.has(u)||n.set(u,{count:0,notes:new Set});let d=n.get(u);d.count+=3,d.notes.add(t.basename)}for(let u of l)if(!i.has(u.toLowerCase())){a.has(u)||a.set(u,{count:0,notes:new Set});let d=a.get(u);d.count+=3,d.notes.add(t.basename)}try{let d=(await o.vault.read(t)).replace(/^---[\s\S]*?---\n/,"");d=d.replace(/\[\[([^\]|]+)(?:\|[^\]]+)?\]\]/g,""),d=d.replace(/\[([^\]]+)\]\([^)]+\)/g,"");let p=Q(d,!1,e),k=Y(d,e);for(let h of p)if(!i.has(h.toLowerCase())){n.has(h)||n.set(h,{count:0,notes:new Set});let g=n.get(h);g.count+=1,g.notes.add(t.basename)}for(let h of k)if(!i.has(h.toLowerCase())){a.has(h)||a.set(h,{count:0,notes:new Set});let g=a.get(h);g.count+=1,g.notes.add(t.basename)}}catch(u){throw console.log(`Error reading ${t.path}:`,u),u}let c=[];for(let[u,d]of n)c.push({keyword:u,count:d.count,notes:Array.from(d.notes),totalNotes:d.notes.size});for(let[u,d]of a)c.push({keyword:u,count:d.count,notes:Array.from(d.notes),totalNotes:d.notes.size});return c.sort((u,d)=>d.count!==u.count?d.count-u.count:d.keyword.length-u.keyword.length),c}We.exports={getStopWords:le,extractWordsFromText:Q,extractPhrasesFromText:Y,analyzeNotesForKeywords:ks,analyzeCurrentNoteForKeywords:ys}});var ce=T((Bo,je)=>{function ms(o){if(!o.startsWith("---"))return null;let e=o.split(`
`),t=-1;for(let s=1;s<e.length;s++)if(e[s].trim()==="---"||e[s].trim()==="..."){t=s;break}if(t!==-1){let s=0;for(let n=0;n<=t;n++)s+=e[n].length+1;return{start:0,end:s}}return null}function vs(o,e){let t=!1,s=!1;for(let n=e-1;n>=Math.max(0,e-500);n--){if(n>0&&o[n]==="]"&&o[n-1]==="]")return!1;if(o[n]==="|"&&!s&&(s=!0),n<o.length-1&&o[n]==="["&&o[n+1]==="["){t=!0;break}if(o[n]===`
`)return!1}if(t&&s)for(let n=e;n<Math.min(o.length,e+500);n++){if(n<o.length-1&&o[n]==="]"&&o[n+1]==="]")return!0;if(o[n]===`
`)break}return!1}function Ss(o,e,t){let s=Math.max(0,e-500),n=Math.min(o.length,e+t+500),a=o.substring(s,e),i=o.substring(e+t,n),r=o.substring(e,e+t),l=a+r+i,c=e-s,u=/(?:https?|ftp|ftps|sftp|file):\/\/[^\s\]]+/gi,d;for(;(d=u.exec(l))!==null;){let w=d.index,m=d.index+d[0].length;if(c>=w&&c<m)return!0}let p=/\bwww\.[a-zA-Z0-9][-a-zA-Z0-9]*(\.[a-zA-Z0-9][-a-zA-Z0-9]*)+[^\s\])"]*/gi;for(;(d=p.exec(l))!==null;){let w=d.index,m=d.index+d[0].length;if(c>=w&&c<m)return!0}let k=/\b[a-zA-Z0-9][-a-zA-Z0-9]*(\.[a-zA-Z0-9][-a-zA-Z0-9]*)*\.(com|org|net|edu|gov|mil|int|info|biz|name|museum|coop|aero|asia|cat|jobs|mobi|travel|xxx|pro|tel|post|co\.uk|co\.jp|co\.kr|co\.nz|co\.au|co\.za|co\.in|co\.id|co\.th|co\.il|ac\.uk|gov\.uk|org\.uk|de|fr|it|es|nl|be|ch|at|se|no|dk|fi|ie|pl|cz|hu|ro|bg|gr|pt|ru|ua|sk|si|hr|lt|lv|ee|cn|jp|kr|tw|hk|sg|my|th|vn|id|ph|in|pk|bd|lk|np|af|au|nz|fj|ca|mx|br|ar|cl|co|pe|ve|ec|uy|py|bo|cr|pa|gt|hn|ni|sv|cu|do|jm|tt|bs|bb|za|eg|ng|ke|gh|tz|ug|zw|ma|dz|tn|sn|ci|cm|ao|mz|na|bw|mw|zm|rw|so|sd|et|ly|iq|ir|sa|ae|kw|qa|om|ye|jo|lb|sy|il|ps|tr|am|az|ge|kz|uz|tm|tj|kg|mn|io|ai|sh|tv|me|cc|ws|to|ly|gl|gd|ms|vg|ag|lc|vc|dm|kn|gp|mq|aw|cw|sx|bq|tc|ky|bm|pr|vi)(?:\b|\/|:|\?|#|$)/gi;for(;(d=k.exec(l))!==null;){let w=d.index,m=d.index+d[0].length;if(c>=w&&c<m&&(w===0||/[\s\(\[\{<"']/.test(l[w-1])))return!0}if(/\.(com|org|net|edu|gov|io|ai|me|tv|co|uk|de|fr|it|jp|cn|au|ca|br|in|ru)\b/i.test(r))return!0;let g=o.substring(Math.max(0,e-100),e),f=o.substring(e+t,Math.min(o.length,e+t+100));return!!(/(?:https?|ftp|ftps):\/\/[^\s]*$/.test(g)||/www\.[^\s]*$/.test(g)||/^\.[a-zA-Z]{2,}(?:\.[a-zA-Z]{2,})?(?:\/|\?|#|:|\s|$)/.test(f))}function bs(o,e){let t=0,s=!1;for(let r=e-1;r>=Math.max(0,e-500);r--){if(r>0&&o[r]==="]"&&o[r-1]==="]"){t--,r--;continue}if(r<o.length-1&&o[r]==="["&&o[r+1]==="["){if(t++,t>0){s=!0;break}r--;continue}if(o[r]===`
`&&t===0)break}if(s)return!0;let n=0;for(let r=0;r<e;r++)o[r]==="`"&&n++;if(n%2===1)return!0;let a=0;for(let r=e-1;r>=Math.max(0,e-300);r--)if(o[r]===")")a--;else if(o[r]==="("){if(a++,a>0&&r>0&&o[r-1]==="]")return!0}else if(o[r]===`
`)break;let i=0;for(let r=e-1;r>=Math.max(0,e-300);r--)if(o[r]==="]")i--;else if(o[r]==="["){if(i++,i>0)for(let l=e;l<Math.min(o.length,e+300);l++){if(o[l]==="]"&&l<o.length-1&&o[l+1]==="(")return!0;if(o[l]===`
`)break}}else if(o[r]===`
`)break;return!1}function Cs(o,e){let t=e;for(;t>0&&o[t-1]!==`
`;)t--;let s=e;for(;s<o.length&&o[s]!==`
`;)s++;let n=o.substring(t,s),a=e-t,i=n.lastIndexOf("^",a);if(i!==-1){let r=n.substring(i,a+1);if(/^\^[\w\-]*$/.test(r))return!0}return!1}function xs(o,e){let t=0,s=0;for(;s<e;)s<o.length-1&&o[s]==="$"&&o[s+1]==="$"?(t++,s+=2):s++;if(t%2===1)return!0;let n=0;for(s=0;s<e;)o[s]==="$"?s<o.length-1&&o[s+1]==="$"?s+=2:(s>0&&o[s-1]==="$"||n++,s++):s++;return n%2===1}function Ls(o,e){let t=e;for(;t>0&&o[t-1]!==`
`;)t--;let s=e;for(;s<o.length&&o[s]!==`
`;)s++;if(!o.substring(t,s).includes("|"))return!1;let a=t-1,i=10,r=0;for(;a>0&&r<i;){let c=a;for(;a>0&&o[a-1]!==`
`;)a--;let u=o.substring(a,c).trim();if(u.includes("|")&&u.includes("-")&&(u.replace(/\|/g,"").match(/-/g)||[]).length>=3)return!0;r++,a--}let l=s+1;for(r=0;l<o.length&&r<3;){let c=l;for(;l<o.length&&o[l]!==`
`;)l++;let u=o.substring(c,l).trim();if(u.includes("|")&&u.includes("-")&&(u.replace(/\|/g,"").match(/-/g)||[]).length>=3)return!0;r++,l++}return!1}je.exports={getFrontmatterBounds:ms,isInsideAlias:vs,isPartOfUrl:Ss,isInsideLinkOrCode:bs,isInsideBlockReference:Cs,isInsideTable:Ls,isInsideMath:xs}});var ue=T((Mo,Ue)=>{var{MarkdownView:Ts}=require("obsidian");function Es(o){return o.replace(/\s+/g,"-").replace(/[^\w\-]/g,"").toLowerCase()}function de(o,e){let t=o.match(/\n\n((?:#[\w\-]+\s*)+)$/),s=t?t[1].match(/#[\w\-]+/g).map(i=>i.substring(1)):[],n=e.filter(i=>!s.includes(i));if(n.length===0)return o;let a=n.map(i=>`#${i}`).join(" ");return s.length>0?o=o.replace(/\n\n((?:#[\w\-]+\s*)+)$/,`

$1 ${a}`):o=o.trimEnd()+`

${a}`,o}async function He(o,e,t){let n=o.vault.getMarkdownFiles().find(a=>a.basename===e);n&&await o.vault.process(n,a=>new RegExp(`#${t}\\b`).test(a)?a:de(a,[t]))}async function $s(o,e,t,s){if(t&&t.length>0){let n=o.workspace.getActiveViewOfType(Ts),i=n&&n.file.path===e.path?n.editor:null;if(i){let r=i.getValue();if(t.every(g=>new RegExp(`#${g}\\b`).test(r)))return;let c=r.match(/\n\n((?:#[\w\-]+\s*)+)$/),u=c?c[1].match(/#[\w\-]+/g).map(g=>g.substring(1)):[],d=t.filter(g=>!u.includes(g));if(d.length===0)return;let p=d.map(g=>`#${g}`).join(" "),k=i.lastLine(),h=i.getLine(k).length;if(u.length>0)for(let g=k;g>=Math.max(0,k-10);g--){let f=i.getLine(g);if(f.trim().match(/^#[\w\-]+(\s+#[\w\-]+)*$/)){i.replaceRange(` ${p}`,{line:g,ch:f.length});break}}else i.replaceRange(`

${p}`,{line:k,ch:h})}else await o.vault.process(e,r=>de(r,t))}if(s&&s.size>0)for(let[n,a]of s)await He(o,n,a)}Ue.exports={sanitizeTagName:Es,addTagsToContent:de,addTagToTargetNote:He,addTagsToFile:$s}});var Ze=T((Vo,_e)=>{var{Notice:X}=require("obsidian");async function As(o,e,t,s,n,a,i=!1){let r=o.workspace.getActiveFile();if(!r){new X("No active file");return}let l=await t(r,i);i&&l?new a(o,l,r.basename).open():!i&&l&&l.changed?(new X(`Linked ${l.linkCount} keyword(s) in current note!`),e.statistics.totalLinksCreated+=l.linkCount,e.statistics.totalNotesProcessed+=1,e.statistics.lastRunDate=new Date().toISOString(),await s(),setTimeout(()=>n(),100)):i||new X("No keywords found to link")}async function Ns(o,e,t,s,n,a,i=!1){let r=o.vault.getMarkdownFiles(),l=0,c=0,u=[];for(let d of r){if(d.extension!=="md")continue;let p=await t(d,i);p&&p.changed&&(c++,l+=p.linkCount,i&&u.push({file:d,fileName:d.basename,...p}))}!i&&c>0&&(e.statistics.totalLinksCreated+=l,e.statistics.totalNotesProcessed+=c,e.statistics.lastRunDate=new Date().toISOString(),await s()),i&&u.length>0?new a(o,u,n).open():i?new X("No keywords found to link in any notes"):new X(`Linked ${l} keyword(s) in ${c} note(s)!`)}_e.exports={linkKeywordsInCurrentNote:As,linkKeywordsInAllNotes:Ns}});var Qe=T((Ko,Je)=>{var{Notice:j}=require("obsidian");async function Is(o,e,t){new t(o,e).open()}async function Ds(o,e,t){let s=o.workspace.getActiveFile();if(!s){new j("No active note found. Please open a note first.");return}new t(o,e,s).open()}function Fs(o,e,t){let s=e.getValue(),n=[],a=s.split(`
`),i=/<span class="akl-suggested-link" data-target="([^"]*)" data-block="([^"]*)" data-use-relative="([^"]*)"[^>]*>([^<]+)<\/span>/g;if(a.forEach((r,l)=>{let c;for(i.lastIndex=0;(c=i.exec(r))!==null;)n.push({lineNumber:l,targetNote:c[1],blockRef:c[2],useRelative:c[3]==="true",matchText:c[4],fullMatch:c[0]})}),n.length===0){new j("No link suggestions found in current note");return}new t(o,e,n).open()}function Bs(o,e,t){let s=o.getCursor(),n=o.getLine(s.line),a=/<span class="akl-suggested-link" data-target="([^"]*)" data-block="([^"]*)" data-use-relative="([^"]*)"[^>]*>([^<]+)<\/span>/g,i=[...n.matchAll(a)];if(i.length===0){new j("No link suggestions found on this line");return}let r=o.getValue(),l=o.posToOffset({line:s.line,ch:0}),c=e(r,l),u=0;i.forEach(d=>{let p=d[0],k=d[1],h=d[2],g=d[3]==="true",f=d[4],w,m=h?`${k}#${h}`:k;if(g){let b=c?f.replace(/\|/g,"\\|"):f,v=encodeURIComponent(k)+".md",N=h?`#${h}`:"";w=`[${b}](${v}${N})`}else c?w=k===f&&!h?`[[${f}]]`:`[[${m}\\|${f}]]`:w=k===f&&!h?`[[${f}]]`:`[[${m}|${f}]]`;n=n.replace(p,w),u++}),o.setLine(s.line,n),new j(`Accepted ${u} link suggestion${u>1?"s":""} on this line`),setTimeout(()=>t(),100)}function Ms(o,e,t){let s=o.getValue(),n=s,a=0,i=/<span class="akl-suggested-link" data-target="([^"]*)" data-block="([^"]*)" data-use-relative="([^"]*)"[^>]*>([^<]+)<\/span>/g;n=s.replace(i,(r,l,c,u,d,p)=>{a++;let k=e(s,p),h,g=c?`${l}#${c}`:l;if(u==="true"){let f=k?d.replace(/\|/g,"\\|"):d,w=encodeURIComponent(l)+".md",m=c?`#${c}`:"";h=`[${f}](${w}${m})`}else k?h=l===d&&!c?`[[${d}]]`:`[[${g}\\|${d}]]`:h=l===d&&!c?`[[${d}]]`:`[[${g}|${d}]]`;return h}),a>0?(o.setValue(n),new j(`Accepted ${a} link suggestion${a>1?"s":""}`),setTimeout(()=>t(),100)):new j("No link suggestions found in current note")}Je.exports={suggestKeywords:Is,suggestKeywordsFromCurrentNote:Ds,reviewSuggestions:Fs,acceptSuggestionAtCursor:Bs,acceptAllSuggestions:Ms}});var Xe=T((Ro,Ye)=>{var{Notice:H}=require("obsidian"),{escapeCSV:ee}=P();async function Vs(o,e){try{let t=JSON.stringify(e.keywords,null,2),n=`auto-keyword-linker-export-${new Date().toISOString().split("T")[0]}.json`;await o.vault.create(n,t),new H(`Keywords exported to ${n}`)}catch(t){new H(`Export failed: ${t.message}`)}}async function Ks(o,e,t){new t(o,e).open()}async function Rs(o){try{let a=`keyword,target,variations,enableTags,linkScope,scopeFolder,useRelativeLinks,blockRef,requireTag,onlyInNotesLinkingTo,suggestMode,preventSelfLink
Python,Languages/Python,"python|py|Python3",false,vault-wide,,false,,,false,false
JavaScript,Languages/JavaScript,"js|javascript",false,vault-wide,,false,,,false,false
API,Documentation/API,"api|REST API",false,same-folder,,false,,reviewed,true,false
`,i="auto-keyword-linker-template.csv";await o.vault.create(i,a),new H(`CSV template downloaded: ${i}`)}catch(e){new H(`Template download failed: ${e.message}`)}}async function qs(o,e){try{let s=["keyword,target,variations,enableTags,linkScope,scopeFolder,useRelativeLinks,blockRef,requireTag,onlyInNotesLinkingTo,suggestMode,preventSelfLink"];for(let r of e.keywords){let l=r.variations&&r.variations.length>0?`"${r.variations.join("|")}"`:"",c=[ee(r.keyword),ee(r.target),l,r.enableTags||!1,r.linkScope||"vault-wide",ee(r.scopeFolder||""),r.useRelativeLinks||!1,ee(r.blockRef||""),ee(r.requireTag||""),r.onlyInNotesLinkingTo||!1,r.suggestMode||!1,r.preventSelfLink||!1].join(",");s.push(c)}let n=s.join(`
`),i=`auto-keyword-linker-export-${new Date().toISOString().split("T")[0]}.csv`;await o.vault.create(i,n),new H(`Keywords exported to ${i}`)}catch(t){new H(`CSV export failed: ${t.message}`)}}async function Os(o,e,t){new t(o,e).open()}Ye.exports={exportKeywords:Vs,importKeywords:Ks,downloadCSVTemplate:Rs,exportKeywordsToCSV:qs,importKeywordsFromCSV:Os}});var tt=T((qo,et)=>{function Ps(o,e,t){new t(o,e).open()}et.exports={showStatistics:Ps}});var nt=T((Oo,st)=>{var{Modal:zs}=require("obsidian"),ge=class extends zs{constructor(e,t){super(e),this.settings=t}onOpen(){let{contentEl:e}=this;e.createEl("h2",{text:"Auto Keyword Linker Statistics"});let t=this.settings.statistics;if(e.createEl("p",{text:`Total Links Created: ${t.totalLinksCreated||0}`}),e.createEl("p",{text:`Total Notes Processed: ${t.totalNotesProcessed||0}`}),e.createEl("p",{text:`Total Keywords Configured: ${this.settings.keywords.length}`}),t.lastRunDate){let a=new Date(t.lastRunDate);e.createEl("p",{text:`Last Run: ${a.toLocaleString()}`})}e.createEl("h3",{text:"Configured Keywords"});let s=e.createEl("ul");for(let a of this.settings.keywords){let i=s.createEl("li");i.appendText(`${a.keyword} \u2192 ${a.target}`),a.variations&&a.variations.length>0&&i.appendText(` (${a.variations.length} variations)`),a.enableTags&&i.appendText(" [Tags enabled]")}let n=e.createEl("button",{text:"Close"});n.style.marginTop="20px",n.addEventListener("click",()=>this.close())}onClose(){let{contentEl:e}=this;e.empty()}};st.exports=ge});var it=T((Po,ot)=>{var{Modal:Ws,Notice:Gs}=require("obsidian"),pe=class extends Ws{constructor(e,t,s=null){super(e),this.plugin=t,this.currentFile=s,this.suggestions=[],this.selectedSuggestions=new Map,this.isAnalyzing=!0,this.searchQuery="",this.sortOrder="frequency-desc"}async onOpen(){let{contentEl:e}=this;e.addClass("akl-suggestion-modal");let t=this.currentFile?`Suggested Keyword Builder - ${this.currentFile.basename}`:"Suggested Keyword Builder";e.createEl("h2",{text:t});let s=e.createDiv({cls:"akl-status"}),n=this.currentFile?"Analyzing current note...":"Analyzing your notes...";s.createEl("p",{text:n,cls:"akl-analyzing"});try{this.currentFile?this.suggestions=await this.plugin.analyzeCurrentNoteForKeywords(this.currentFile):this.suggestions=await this.plugin.analyzeNotesForKeywords(),this.isAnalyzing=!1,s.empty();let a=this.currentFile?1:this.plugin.app.vault.getMarkdownFiles().length,i=a===1?"note":"notes";s.createEl("p",{text:`Found ${this.suggestions.length} suggestions from ${a} ${i}`,cls:"akl-stats"});for(let r of this.suggestions)this.selectedSuggestions.set(r.keyword,{selected:!1,addAsVariationTo:null});this.renderSuggestions(e)}catch(a){s.empty(),s.createEl("p",{text:`Error analyzing notes: ${a.message}`,cls:"akl-error"}),console.error("Error analyzing notes:",a)}}renderSuggestions(e){let t=e.createDiv({cls:"akl-controls-container"}),n=t.createDiv({cls:"akl-search-container"}).createEl("input",{type:"text",placeholder:"Search suggestions...",cls:"akl-search-input"});n.value=this.searchQuery,n.addEventListener("input",g=>{this.searchQuery=g.target.value,this.refreshSuggestionList()});let a=t.createDiv({cls:"akl-sort-container"}),i=a.createEl("label",{text:"Sort by: ",cls:"akl-sort-label"}),r=a.createEl("select",{cls:"akl-sort-select"}),l=[{value:"frequency-desc",label:"Most Common First"},{value:"frequency-asc",label:"Least Common First"},{value:"alpha-asc",label:"A to Z"},{value:"alpha-desc",label:"Z to A"},{value:"length-asc",label:"Shortest First"},{value:"length-desc",label:"Longest First"}];for(let g of l){let f=r.createEl("option",{value:g.value,text:g.label});g.value===this.sortOrder&&(f.selected=!0)}r.addEventListener("change",g=>{this.sortOrder=g.target.value,this.refreshSuggestionList()});let c=e.createDiv({cls:"akl-button-row"});c.createEl("button",{text:"Select All",cls:"akl-mini-button"}).addEventListener("click",()=>{for(let[g,f]of this.selectedSuggestions)this.matchesSearch(g)&&(f.selected=!0);this.refreshSuggestionList()}),c.createEl("button",{text:"Deselect All",cls:"akl-mini-button"}).addEventListener("click",()=>{for(let[g,f]of this.selectedSuggestions)this.matchesSearch(g)&&(f.selected=!1);this.refreshSuggestionList()}),this.suggestionsListEl=e.createDiv({cls:"akl-suggestions-list"}),this.refreshSuggestionList();let p=e.createDiv({cls:"akl-action-row"});p.createEl("button",{text:"Add Selected Keywords",cls:"mod-cta"}).addEventListener("click",()=>this.addSelectedKeywords()),p.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close())}matchesSearch(e){return this.searchQuery?e.toLowerCase().includes(this.searchQuery.toLowerCase()):!0}sortSuggestions(e){let t=[...e];switch(this.sortOrder){case"frequency-desc":t.sort((s,n)=>n.totalNotes-s.totalNotes);break;case"frequency-asc":t.sort((s,n)=>s.totalNotes-n.totalNotes);break;case"alpha-asc":t.sort((s,n)=>s.keyword.localeCompare(n.keyword));break;case"alpha-desc":t.sort((s,n)=>n.keyword.localeCompare(s.keyword));break;case"length-asc":t.sort((s,n)=>s.keyword.length-n.keyword.length);break;case"length-desc":t.sort((s,n)=>n.keyword.length-s.keyword.length);break;default:t.sort((s,n)=>n.totalNotes-s.totalNotes)}return t}refreshSuggestionList(){if(!this.suggestionsListEl)return;this.suggestionsListEl.empty();let e=this.suggestions.filter(t=>this.matchesSearch(t.keyword));if(e.length===0){this.suggestionsListEl.createEl("p",{text:"No suggestions match your search.",cls:"akl-no-results"});return}e=this.sortSuggestions(e);for(let t of e){let s=this.selectedSuggestions.get(t.keyword),n=this.suggestionsListEl.createDiv({cls:"akl-suggestion-item"}),a=n.createDiv({cls:"akl-suggestion-header"}),i=a.createEl("input",{type:"checkbox",cls:"akl-checkbox"});i.checked=s.selected,i.addEventListener("change",d=>{s.selected=d.target.checked});let r=a.createDiv({cls:"akl-suggestion-label"});if(r.createSpan({text:t.keyword,cls:"akl-keyword-text"}),r.createSpan({text:` (${t.totalNotes} notes)`,cls:"akl-count-text"}),t.notes.length>0){let d=n.createDiv({cls:"akl-notes-preview"});d.createEl("span",{text:"In: ",cls:"akl-notes-label"}),d.createEl("span",{text:t.notes.join(", ")+(t.totalNotes>5?"...":""),cls:"akl-notes-list"})}let l=n.createDiv({cls:"akl-variation-selector"});l.createEl("span",{text:"Or add as variation to: ",cls:"akl-variation-label"});let c=l.createEl("select",{cls:"akl-variation-dropdown"}),u=c.createEl("option",{value:"",text:"(None - add as new keyword)"});for(let d of this.plugin.settings.keywords)d.keyword.toLowerCase()!==t.keyword.toLowerCase()&&c.createEl("option",{value:d.keyword,text:d.keyword});c.value=s.addAsVariationTo||"",c.addEventListener("change",d=>{s.addAsVariationTo=d.target.value||null,d.target.value&&(i.checked=!0,s.selected=!0)})}}async addSelectedKeywords(){let e=0,t=0;for(let[n,a]of this.selectedSuggestions)if(a.selected)if(a.addAsVariationTo){let i=this.plugin.settings.keywords.find(r=>r.keyword===a.addAsVariationTo);i&&(i.variations||(i.variations=[]),i.variations.includes(n)||(i.variations.push(n),t++))}else this.plugin.settings.keywords.push({keyword:n,target:n,variations:[],enableTags:!1,linkScope:"vault-wide",scopeFolder:""}),e++;await this.plugin.saveSettings();let s="";e>0&&t>0?s=`Added ${e} new keyword(s) and ${t} variation(s)`:e>0?s=`Added ${e} new keyword(s)`:t>0?s=`Added ${t} variation(s)`:s="No keywords selected",new Gs(s),this.close()}onClose(){let{contentEl:e}=this;e.empty()}};ot.exports=pe});var rt=T((zo,at)=>{var{Modal:js,Notice:he}=require("obsidian"),fe=class extends js{constructor(e,t){super(e),this.plugin=t}onOpen(){let{contentEl:e}=this;e.createEl("h2",{text:"Import Keywords from JSON"}),e.createEl("p",{text:"Select a JSON file from your vault to import keywords. This will ADD to your existing keywords."});let t=this.app.vault.getFiles().filter(r=>r.extension==="json");if(t.length===0){e.createEl("p",{text:"No JSON files found in vault. Please create an export first.",cls:"mod-warning"}),e.createEl("button",{text:"Close"}).addEventListener("click",()=>this.close());return}let s=e.createEl("select");s.style.width="100%",s.style.marginBottom="10px";for(let r of t){let l=s.createEl("option",{text:r.path,value:r.path})}let n=e.createDiv();n.style.display="flex",n.style.gap="10px",n.style.marginTop="20px",n.createEl("button",{text:"Import",cls:"mod-cta"}).addEventListener("click",async()=>{let r=s.value,l=this.app.vault.getAbstractFileByPath(r);if(l)try{let c=await this.app.vault.read(l),u=JSON.parse(c);if(!Array.isArray(u)){new he("Invalid JSON format: expected an array of keywords");return}let d=0,p=0;for(let h of u){h.enableTags===void 0&&(h.enableTags=!1);let g=this.plugin.settings.keywords.findIndex(f=>f.keyword.toLowerCase()===h.keyword.toLowerCase());if(g!==-1){let f=this.plugin.settings.keywords[g];f.variations||(f.variations=[]),h.variations||(h.variations=[]);let w=f.variations.map(b=>b.toLowerCase()),m=h.variations.filter(b=>!w.includes(b.toLowerCase()));m.length>0&&(f.variations.push(...m),p++)}else this.plugin.settings.keywords.push(h),d++}await this.plugin.saveSettings();let k="";d>0&&p>0?k=`Imported: ${d} new keyword(s), merged variations into ${p} existing keyword(s)`:d>0?k=`Imported ${d} new keyword(s)`:p>0?k=`Merged variations into ${p} existing keyword(s)`:k="No new keywords or variations to import",new he(k),this.close(),this.app.setting.close(),this.app.setting.open(),this.app.setting.openTabById(this.plugin.manifest.id)}catch(c){new he(`Import failed: ${c.message}`)}}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close())}onClose(){let{contentEl:e}=this;e.empty()}};at.exports=fe});var dt=T((Wo,ct)=>{var{Modal:Hs,Notice:ie}=require("obsidian"),{parseCSVLine:lt}=P(),we=class extends Hs{constructor(e,t){super(e),this.plugin=t}onOpen(){let{contentEl:e}=this;e.createEl("h2",{text:"Import Keywords from CSV"}),e.createEl("p",{text:"Select a CSV file from your vault to import keywords. This will ADD to your existing keywords."});let t=this.app.vault.getFiles().filter(r=>r.extension==="csv");if(t.length===0){e.createEl("p",{text:"No CSV files found in vault. Download a template first or export existing keywords.",cls:"mod-warning"}),e.createEl("button",{text:"Close"}).addEventListener("click",()=>this.close());return}let s=e.createEl("select");s.style.width="100%",s.style.marginBottom="10px";for(let r of t){let l=s.createEl("option",{text:r.path,value:r.path})}let n=e.createDiv();n.style.display="flex",n.style.gap="10px",n.style.marginTop="20px",n.createEl("button",{text:"Import",cls:"mod-cta"}).addEventListener("click",async()=>{let r=s.value,l=this.app.vault.getAbstractFileByPath(r);if(l)try{let u=(await this.app.vault.read(l)).split(`
`).filter(m=>m.trim());if(u.length===0){new ie("CSV file is empty");return}let d=lt(u[0]),p={};if(d.forEach((m,b)=>{p[m.toLowerCase()]=b}),p.keyword===void 0||p.target===void 0){new ie('CSV must have "keyword" and "target" columns');return}let k=0,h=0,g=0,f=[];for(let m=1;m<u.length;m++){let b=m+1;try{let v=lt(u[m]);if(v.length===0||!v[p.keyword])continue;let N=v[p.keyword]||"",F=v[p.target]||"";if(!N.trim()||!F.trim()){f.push(`Line ${b}: Missing keyword or target`),g++;continue}let L=v[p.variations]||"",B=L?L.split("|").map($=>$.trim()).filter($=>$):[],I=$=>{if(typeof $=="boolean")return $;let M=String($).toLowerCase().trim();return M==="true"||M==="yes"||M==="1"},V={keyword:N.trim(),target:F.trim(),variations:B,enableTags:I(v[p.enabletags]||!1),linkScope:v[p.linkscope]||"vault-wide",scopeFolder:v[p.scopefolder]||"",useRelativeLinks:I(v[p.userelativelinks]||!1),blockRef:v[p.blockref]||"",requireTag:v[p.requiretag]||"",onlyInNotesLinkingTo:I(v[p.onlyinnoteslinkingto]||!1),suggestMode:I(v[p.suggestmode]||!1),preventSelfLink:I(v[p.preventselflink]||!1)},D=this.plugin.settings.keywords.findIndex($=>$.keyword.toLowerCase()===V.keyword.toLowerCase());if(D!==-1){let $=this.plugin.settings.keywords[D],M=new Set($.variations.map(K=>K.toLowerCase())),O=!1;for(let K of V.variations)M.has(K.toLowerCase())||($.variations.push(K),O=!0);O&&h++}else this.plugin.settings.keywords.push(V),k++}catch(v){f.push(`Line ${b}: ${v.message}`),g++}}await this.plugin.saveSettings();let w="";k>0&&h>0?w=`Imported: ${k} new keyword(s), merged variations into ${h} existing keyword(s)`:k>0?w=`Imported ${k} new keyword(s)`:h>0?w=`Merged variations into ${h} existing keyword(s)`:w="No new keywords or variations to import",g>0&&(w+=`
${g} error(s) encountered`,console.error("CSV Import Errors:",f)),new ie(w),this.close(),this.app.setting.close(),this.app.setting.open(),this.app.setting.openTabById(this.plugin.manifest.id)}catch(c){new ie(`Import failed: ${c.message}`),console.error("CSV Import Error:",c)}}),n.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close())}onClose(){let{contentEl:e}=this;e.empty()}};ct.exports=we});var gt=T((Go,ut)=>{var{Modal:Us}=require("obsidian"),ke=class extends Us{constructor(e,t,s){super(e),this.results=t,this.fileName=s}onOpen(){let{contentEl:e}=this;e.createEl("h2",{text:`Preview: ${this.fileName}`}),e.createEl("p",{text:`Found ${this.results.linkCount} keyword(s) to link:`});let t=e.createEl("ul");for(let a of this.results.changes){let i=t.createEl("li");i.createEl("strong",{text:a.keyword}),i.appendText(" \u2192 "),i.createEl("code",{text:`[[${a.target}]]`}),i.createEl("br"),i.createEl("small",{text:a.context,cls:"preview-context"})}let s=e.createDiv({cls:"modal-button-container"});s.style.marginTop="20px",s.style.display="flex",s.style.gap="10px",s.createEl("button",{text:"Close"}).addEventListener("click",()=>this.close())}onClose(){let{contentEl:e}=this;e.empty()}};ut.exports=ke});var ft=T((jo,ht)=>{var{Modal:_s,Notice:pt,MarkdownView:Zs}=require("obsidian"),ye=class extends _s{constructor(e,t,s){super(e),this.editor=t,this.suggestions=s,this.selectedSuggestions=new Set(s.map((n,a)=>a))}onOpen(){let{contentEl:e}=this;e.empty(),e.addClass("akl-suggestion-review-modal"),e.createEl("h2",{text:"Review Link Suggestions"});let t=e.createEl("p",{text:`Found ${this.suggestions.length} link suggestion${this.suggestions.length>1?"s":""} in this note. Select which ones to accept:`});t.style.marginBottom="1em",t.style.color="var(--text-muted)";let s=e.createDiv({cls:"akl-button-container"});s.style.marginBottom="1em",s.style.display="flex",s.style.gap="0.5em",s.createEl("button",{text:"Select All"}).addEventListener("click",()=>{this.suggestions.forEach((d,p)=>{this.selectedSuggestions.add(p);let k=e.querySelector(`input[data-index="${p}"]`);k&&(k.checked=!0)})}),s.createEl("button",{text:"Deselect All"}).addEventListener("click",()=>{this.selectedSuggestions.clear(),e.querySelectorAll('input[type="checkbox"]').forEach(d=>d.checked=!1)});let i=e.createDiv({cls:"akl-suggestions-list"});i.style.maxHeight="400px",i.style.overflowY="auto",i.style.marginBottom="1em",i.style.border="1px solid var(--background-modifier-border)",i.style.borderRadius="6px",i.style.padding="0.5em",this.suggestions.forEach((d,p)=>{let k=i.createDiv({cls:"akl-suggestion-item"});k.style.padding="0.75em",k.style.marginBottom="0.5em",k.style.background="var(--background-secondary)",k.style.borderRadius="6px",k.style.display="flex",k.style.alignItems="center",k.style.gap="0.75em";let h=k.createEl("input",{type:"checkbox"});h.checked=!0,h.setAttribute("data-index",p.toString()),h.addEventListener("change",v=>{v.target.checked?this.selectedSuggestions.add(p):this.selectedSuggestions.delete(p)});let g=k.createDiv({cls:"akl-suggestion-content"});g.style.flex="1";let f=g.createDiv();f.style.marginBottom="0.25em",f.createSpan({text:d.matchText,cls:"akl-keyword-highlight"}),f.createSpan({text:" \u2192 ",cls:"akl-arrow"}),f.createSpan({text:d.targetNote,cls:"akl-target-highlight"});let w=g.createDiv();w.style.fontSize="0.9em",w.style.color="var(--text-muted)",w.createSpan({text:`Line ${d.lineNumber+1}`}),f.querySelectorAll(".akl-keyword-highlight").forEach(v=>{v.style.background="rgba(255, 170, 0, 0.25)",v.style.padding="2px 4px",v.style.borderRadius="3px",v.style.fontWeight="500"}),f.querySelectorAll(".akl-target-highlight").forEach(v=>{v.style.color="var(--text-accent)",v.style.fontWeight="500"})});let r=e.createDiv({cls:"akl-action-buttons"});r.style.display="flex",r.style.gap="0.5em",r.style.justifyContent="flex-end",r.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close());let c=r.createEl("button",{text:`Accept Selected (${this.selectedSuggestions.size})`,cls:"mod-cta"});c.addEventListener("click",()=>{this.acceptSelected()});let u=()=>{c.textContent=`Accept Selected (${this.selectedSuggestions.size})`};e.querySelectorAll('input[type="checkbox"]').forEach(d=>{d.addEventListener("change",u)})}acceptSelected(){if(this.selectedSuggestions.size===0){new pt("No suggestions selected");return}let e=Array.from(this.selectedSuggestions).sort((s,n)=>this.suggestions[n].lineNumber-this.suggestions[s].lineNumber),t=0;e.forEach(s=>{let n=this.suggestions[s],a=this.editor.getLine(n.lineNumber);if(!a.includes(n.fullMatch))return;let i=this.editor.getValue(),r=this.editor.posToOffset({line:n.lineNumber,ch:0}),l=this.app.plugins.plugins["auto-keyword-linker"],c=l?l.isInsideTable(i,r):!1,u,d=n.blockRef?`${n.targetNote}#${n.blockRef}`:n.targetNote;if(n.useRelative){let k=c?n.matchText.replace(/\|/g,"\\|"):n.matchText,h=encodeURIComponent(n.targetNote)+".md",g=n.blockRef?`#${n.blockRef}`:"";u=`[${k}](${h}${g})`}else c?u=n.targetNote===n.matchText&&!n.blockRef?`[[${n.matchText}]]`:`[[${d}\\|${n.matchText}]]`:u=n.targetNote===n.matchText&&!n.blockRef?`[[${n.matchText}]]`:`[[${d}|${n.matchText}]]`;let p=a.replace(n.fullMatch,u);this.editor.setLine(n.lineNumber,p),t++}),new pt(`Accepted ${t} link suggestion${t>1?"s":""}`),this.close(),setTimeout(()=>{let s=this.app.workspace.getActiveViewOfType(Zs);if(s&&s.editor){let n=this.app.plugins.plugins["auto-keyword-linker"];n&&n.updateStatusBar&&n.updateStatusBar()}},100)}onClose(){let{contentEl:e}=this;e.empty()}};ht.exports=ye});var kt=T((Ho,wt)=>{var{Modal:Js,Notice:me}=require("obsidian"),ve=class extends Js{constructor(e,t,s){super(e),this.results=t,this.plugin=s,this.selectedLinks=new Map,this.results.forEach((n,a)=>{let i=new Set(n.changes.map((r,l)=>l));this.selectedLinks.set(a,i)})}onOpen(){let{contentEl:e}=this;e.createEl("h2",{text:"Preview: Select Links to Create"});let t=this.results.reduce((h,g)=>h+g.linkCount,0),s=this.getSelectedLinksCount(),n=`Found ${t} link(s) in ${this.results.length} note(s). ${s} link(s) selected.`,a=e.createEl("p",{text:n,cls:"bulk-preview-stats"}),i=e.createDiv({cls:"bulk-preview-select-buttons"});i.style.marginBottom="15px",i.style.display="flex",i.style.gap="10px",i.createEl("button",{text:"Select All Links"}).addEventListener("click",()=>{this.results.forEach((h,g)=>{let f=new Set(h.changes.map((w,m)=>m));this.selectedLinks.set(g,f)}),e.querySelectorAll('input[type="checkbox"]').forEach(h=>h.checked=!0),this.updateStats(a)}),i.createEl("button",{text:"Deselect All Links"}).addEventListener("click",()=>{this.selectedLinks.clear(),e.querySelectorAll('input[type="checkbox"]').forEach(h=>h.checked=!1),this.updateStats(a)});let c=e.createDiv({cls:"preview-scroll"});c.style.maxHeight="400px",c.style.overflowY="auto",c.style.marginBottom="20px",c.style.border="1px solid var(--background-modifier-border)",c.style.borderRadius="6px",c.style.padding="10px",this.results.forEach((h,g)=>{let f=c.createDiv({cls:"preview-note"});f.style.marginBottom="15px",f.style.padding="10px",f.style.background="var(--background-secondary)",f.style.borderRadius="6px";let w=f.createDiv();w.style.display="flex",w.style.alignItems="center",w.style.gap="10px",w.style.marginBottom="10px";let m=w.createEl("input",{type:"checkbox"});m.checked=!0,m.setAttribute("data-note-index",g.toString()),m.addEventListener("change",N=>{let F=N.target.checked,L=this.selectedLinks.get(g)||new Set;F?(h.changes.forEach((B,I)=>L.add(I)),this.selectedLinks.set(g,L),e.querySelectorAll(`input[data-note="${g}"]`).forEach(B=>B.checked=!0)):(this.selectedLinks.delete(g),e.querySelectorAll(`input[data-note="${g}"]`).forEach(B=>B.checked=!1)),this.updateStats(a)});let b=w.createDiv();b.style.flex="1",b.createEl("strong",{text:h.fileName}),b.createEl("span",{text:` (${h.linkCount} link${h.linkCount!==1?"s":""})`,cls:"bulk-preview-link-count"});let v=f.createDiv();v.style.marginLeft="30px",h.changes.forEach((N,F)=>{let L=v.createDiv();L.style.display="flex",L.style.alignItems="flex-start",L.style.gap="8px",L.style.marginBottom="8px",L.style.padding="4px",L.style.borderRadius="4px",L.style.transition="background 0.2s",L.addEventListener("mouseenter",()=>{L.style.background="var(--background-modifier-hover)"}),L.addEventListener("mouseleave",()=>{L.style.background="transparent"});let B=L.createEl("input",{type:"checkbox"});B.checked=!0,B.setAttribute("data-note",g.toString()),B.setAttribute("data-link",F.toString()),B.style.marginTop="2px",B.addEventListener("change",D=>{let $=this.selectedLinks.get(g)||new Set;D.target.checked?$.add(F):$.delete(F),$.size===0?this.selectedLinks.delete(g):this.selectedLinks.set(g,$);let M=h.changes.every((O,K)=>{let z=this.selectedLinks.get(g);return z&&z.has(K)});m.checked=M,this.updateStats(a)});let I=L.createDiv();I.style.flex="1",I.style.fontSize="0.9em";let V=I.createDiv();if(V.createEl("strong",{text:N.keyword}),V.appendText(" \u2192 "),V.createEl("code",{text:`[[${N.target}]]`}),N.lineNumber!==void 0){let D=I.createDiv();D.style.fontSize="0.85em",D.style.color="var(--text-muted)",D.style.marginTop="2px",D.textContent=`Line ${N.lineNumber+1}`}})});let u=e.createDiv({cls:"modal-button-container"});u.style.display="flex",u.style.gap="10px",u.style.justifyContent="flex-end",u.style.marginTop="20px",u.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close());let p=this.getSelectedLinksCount(),k=u.createEl("button",{text:`Apply Selected Links (${p})`,cls:"mod-cta"});k.addEventListener("click",async()=>{await this.applySelected()}),this.applyBtn=k}updateStats(e){let t=this.results.reduce((n,a)=>n+a.linkCount,0),s=this.getSelectedLinksCount();e.textContent=`Found ${t} link(s) in ${this.results.length} note(s). ${s} link(s) selected.`,this.applyBtn&&(this.applyBtn.textContent=`Apply Selected Links (${s})`)}getSelectedLinksCount(){let e=0;for(let t of this.selectedLinks.values())e+=t.size;return e}async applySelected(){if(this.selectedLinks.size===0){new me("No links selected");return}this.close();let e=this.getSelectedLinksCount();new me(`Creating ${e} link(s)...`);let t=0,s=0;for(let[n,a]of this.selectedLinks){if(a.size===0)continue;let i=this.results[n];if(!i||!i.file)continue;let r=i.file,l=i.changes.filter((d,p)=>a.has(p)),c=new Set(l.map(d=>d.keyword.toLowerCase())),u=this.plugin.buildKeywordMap.bind(this.plugin);this.plugin.buildKeywordMap=()=>{let d=u(),p={};for(let[k,h]of Object.entries(d))c.has(k.toLowerCase())&&(p[k]=h);return p};try{let d=await this.plugin.linkKeywordsInFile(r,!1);d&&d.changed&&(t+=d.linkCount,s++)}finally{this.plugin.buildKeywordMap=u}}this.plugin.settings.statistics.totalLinksCreated+=t,this.plugin.settings.statistics.totalNotesProcessed+=s,this.plugin.settings.statistics.lastRunDate=new Date().toISOString(),await this.plugin.saveSettings(),new me(`\u2713 Processed ${s} note(s), created ${t} link(s)`)}onClose(){let{contentEl:e}=this;e.empty()}};wt.exports=ve});var be=T((Uo,yt)=>{var{FuzzySuggestModal:Qs,Notice:Ys}=require("obsidian"),Se=class extends Qs{constructor(e,t,s,n){super(e),this.plugin=t,this.groupId=s,this.currentKeywordIds=new Set(n.map(a=>a.id))}getItems(){return this.plugin.settings.keywords.filter(e=>!this.currentKeywordIds.has(e.id))}getItemText(e){let t=e.groupId?" [In another group]":"";return`${e.keyword||"Untitled"} \u2192 ${e.target||"(no target)"}${t}`}async onChooseItem(e){e.groupId=this.groupId,e.enableTags=null,e.linkScope=null,e.scopeFolder=null,e.useRelativeLinks=null,e.blockRef=null,e.requireTag=null,e.onlyInNotesLinkingTo=null,e.suggestMode=null,e.preventSelfLink=null,await this.plugin.saveSettings(),new Ys(`Keyword "${e.keyword}" assigned to group. Group settings will apply to new links.`);let t=this.app.setting.activeTab,s=Ce();t instanceof s&&t.display()}};yt.exports=Se});var vt=T((_o,mt)=>{var{AbstractInputSuggest:Xs}=require("obsidian"),xe=class extends Xs{constructor(e,t,s){super(e,t),this.inputEl=t,this.folders=s}getSuggestions(e){let t=e.toLowerCase();return this.folders.filter(n=>(n||"/ (Root)").toLowerCase().includes(t)).sort((n,a)=>{let i=(n||"/ (Root)").toLowerCase(),r=(a||"/ (Root)").toLowerCase(),l=i.startsWith(t),c=r.startsWith(t);return l&&!c?-1:!l&&c?1:i.localeCompare(r)})}renderSuggestion(e,t){t.setText(e||"/ (Root)")}selectSuggestion(e,t){this.inputEl&&(this.inputEl.value=e||"",this.inputEl.trigger("input")),this.close()}};mt.exports=xe});var bt=T((Zo,St)=>{var{AbstractInputSuggest:en}=require("obsidian"),Le=class extends en{constructor(e,t,s){super(e,t),this.inputEl=t,this.notes=s}getSuggestions(e){let t=e.toLowerCase();return this.notes.filter(n=>n.toLowerCase().includes(t)).sort((n,a)=>{let i=n.toLowerCase(),r=a.toLowerCase(),l=i.startsWith(t),c=r.startsWith(t);return l&&!c?-1:!l&&c?1:i.localeCompare(r)})}renderSuggestion(e,t){t.setText(e)}selectSuggestion(e,t){this.inputEl&&(this.inputEl.value=e,this.inputEl.trigger("input")),this.close()}};St.exports=Le});var Ce=T((Jo,Tt)=>{var{PluginSettingTab:tn,Setting:x,Notice:Te,normalizePath:Ct}=require("obsidian"),sn=be(),xt=vt(),nn=bt(),{generateId:Lt}=P(),Ee=class extends tn{constructor(e,t){super(e,t),this.plugin=t,this.searchFilter="",this.currentTab="keywords"}display(){let{containerEl:e}=this;e.empty(),this.addCustomStyles();let t=e.createDiv({cls:"akl-tab-nav"});[{id:"keywords",label:"Keywords",icon:"\u{1F524}"},{id:"groups",label:"Groups",icon:"\u{1F4C1}"},{id:"general",label:"General",icon:"\u2699\uFE0F"},{id:"import-export",label:"Import/export",icon:"\u{1F4E6}"}].forEach(a=>{t.createEl("button",{text:`${a.icon} ${a.label}`,cls:`akl-tab-button ${this.currentTab===a.id?"akl-tab-active":""}`}).addEventListener("click",()=>{this.currentTab=a.id,this.display()})});let n=e.createDiv({cls:"akl-tab-content"});switch(this.currentTab){case"keywords":this.displayKeywordsTab(n);break;case"groups":this.displayGroupsTab(n);break;case"general":this.displayGeneralTab(n);break;case"import-export":this.displayImportExportTab(n);break}}displayKeywordsTab(e){e.createDiv({cls:"akl-stats-bar"}).createEl("span",{text:`${this.plugin.settings.keywords.length} keyword${this.plugin.settings.keywords.length!==1?"s":""} configured`}),new x(e).setName("Keywords & variations").setDesc("Define keywords and their variations. All variations will link to the target note.").setHeading(),e.createDiv({cls:"akl-search-container"}).createEl("input",{type:"text",placeholder:"Search keywords...",cls:"akl-search-input",value:this.searchFilter}).addEventListener("input",l=>{this.searchFilter=l.target.value,this.renderKeywords(a)});let a=e.createDiv({cls:"akl-keywords-container"});this.renderKeywords(a),e.createDiv({cls:"akl-add-button-container"}).createEl("button",{text:"+ Add keyword",cls:"mod-cta akl-add-button"}).addEventListener("click",()=>{this.plugin.settings.keywords.push({id:Lt("kw"),keyword:"",target:"",variations:[],enableTags:null,linkScope:"vault-wide",scopeFolder:"",useRelativeLinks:null,blockRef:"",requireTag:"",onlyInNotesLinkingTo:null,suggestMode:null,preventSelfLink:null,collapsed:!1,groupId:null}),this.display()})}updateCardHeader(e,t,s){e.empty();let n=t||"New Keyword",a=s?` \u2192 ${s}`:"";e.createSpan({text:n,cls:"akl-keyword-name"}),a&&e.createSpan({text:a,cls:"akl-target-name"})}displayGroupsTab(e){let t=e.createDiv({cls:"akl-stats-bar"}),s=this.plugin.settings.keywordGroups.reduce((r,l)=>r+this.plugin.settings.keywords.filter(c=>c.groupId===l.id).length,0);t.createEl("span",{text:`${this.plugin.settings.keywordGroups.length} group${this.plugin.settings.keywordGroups.length!==1?"s":""} \u2022 ${s} keyword${s!==1?"s":""} in groups`}),new x(e).setName("Keyword groups").setDesc("Organize keywords into groups with shared settings. Keywords inherit settings from their group.").setHeading();let n=e.createDiv({cls:"akl-groups-container"});this.renderGroups(n),e.createDiv({cls:"akl-add-button-container"}).createEl("button",{text:"+ Create group",cls:"mod-cta akl-add-button"}).addEventListener("click",()=>{this.plugin.settings.keywordGroups.push({id:Lt("grp"),name:"New group",collapsed:!1,settings:{enableTags:!1,linkScope:"vault-wide",scopeFolder:"",useRelativeLinks:!1,blockRef:"",requireTag:"",onlyInNotesLinkingTo:!1,suggestMode:!1,preventSelfLink:!1}}),this.display()})}displayGeneralTab(e){new x(e).setName("Linking behavior").setDesc("Configure how keywords are linked in your notes.").setHeading(),new x(e).setName("First occurrence only").setDesc("Link only the first mention of each keyword per note").addToggle(n=>n.setValue(this.plugin.settings.firstOccurrenceOnly).onChange(async a=>{this.plugin.settings.firstOccurrenceOnly=a,await this.plugin.saveSettings()})),new x(e).setName("Case sensitive").setDesc("Match keywords with exact case").addToggle(n=>n.setValue(this.plugin.settings.caseSensitive).onChange(async a=>{this.plugin.settings.caseSensitive=a,await this.plugin.saveSettings()})),new x(e).setName("Prevent self-links (global)").setDesc("Prevent keywords from linking on their own target note (applies to all keywords unless overridden per-keyword)").addToggle(n=>n.setValue(this.plugin.settings.preventSelfLinkGlobal).onChange(async a=>{this.plugin.settings.preventSelfLinkGlobal=a,await this.plugin.saveSettings()})),new x(e).setName("Auto-link on save").setDesc("Automatically link keywords when you save a note (requires reload)").addToggle(n=>n.setValue(this.plugin.settings.autoLinkOnSave).onChange(async a=>{this.plugin.settings.autoLinkOnSave=a,await this.plugin.saveSettings(),new Te("Please reload the plugin for this change to take effect")})),new x(e).setName("Note creation").setDesc("Configure how new notes are created when target notes don't exist.").setHeading(),new x(e).setName("Auto-create notes").setDesc("Automatically create target notes if they don't exist").addToggle(n=>n.setValue(this.plugin.settings.autoCreateNotes).onChange(async a=>{this.plugin.settings.autoCreateNotes=a,await this.plugin.saveSettings()}));let s=["",...this.getAllFolders()];new x(e).setName("New note folder").setDesc("Type to search and select folder where new notes will be created").addText(n=>{let a=this.plugin.settings.newNoteFolder||"/ (Root)";n.setValue(a).setPlaceholder("Type to search folders..."),new xt(this.app,n.inputEl,s),n.onChange(async i=>{let r=i==="/ (Root)"?"":i;r&&(r=Ct(r)),this.plugin.settings.newNoteFolder=r,await this.plugin.saveSettings()})}),new x(e).setName("New note template").setDesc("Template for auto-created notes. Use {{keyword}} and {{date}} as placeholders.").addTextArea(n=>n.setPlaceholder(`# {{keyword}}

Created: {{date}}`).setValue(this.plugin.settings.newNoteTemplate).onChange(async a=>{this.plugin.settings.newNoteTemplate=a,await this.plugin.saveSettings()})),new x(e).setName("Keyword suggestions").setDesc("Configure how the keyword suggestion feature works.").setHeading(),new x(e).setName("Custom stop words").setDesc("Additional words to exclude from keyword suggestions (comma-separated). These are added to the default stop word list.").addTextArea(n=>{n.setPlaceholder("example, test, demo, sample").setValue((this.plugin.settings.customStopWords||[]).join(", ")).onChange(async a=>{let i=a.split(",").map(r=>r.trim()).filter(r=>r.length>0);this.plugin.settings.customStopWords=i,await this.plugin.saveSettings()}),n.inputEl.rows=4,n.inputEl.cols=50}),new x(e).setName("Reset custom stop words").setDesc("Clear all custom stop words").addButton(n=>n.setButtonText("Reset").onClick(async()=>{this.plugin.settings.customStopWords=[],await this.plugin.saveSettings(),new Te("Custom stop words cleared"),this.display()}))}displayImportExportTab(e){new x(e).setName("Import & export keywords").setDesc("Export your keywords to CSV or import keywords from a CSV file.").setHeading(),new x(e).setName("Export keywords to CSV").setDesc("Export all keywords and their settings to a CSV file").addButton(t=>t.setButtonText("Export to CSV").setCta().onClick(()=>this.plugin.exportKeywordsToCSV())),new x(e).setName("Import keywords from CSV").setDesc("Import keywords from a CSV file (opens file picker)").addButton(t=>t.setButtonText("Import from CSV").onClick(()=>this.plugin.importKeywordsFromCSV())),new x(e).setName("Statistics").setDesc("View usage statistics for the plugin.").setHeading(),new x(e).setName("View statistics").setDesc("See how many links have been created and which notes have been processed").addButton(t=>t.setButtonText("View statistics").onClick(()=>this.plugin.showStatistics()))}renderKeywords(e){var n;e.empty();let t=this.searchFilter.toLowerCase(),s=0;for(let a=0;a<this.plugin.settings.keywords.length;a++){let i=this.plugin.settings.keywords[a];if(t){let S=i.keyword&&i.keyword.toLowerCase().includes(t),C=i.target&&i.target.toLowerCase().includes(t),y=i.variations&&i.variations.some(E=>E.toLowerCase().includes(t));if(!S&&!C&&!y)continue}s++,i.collapsed===void 0&&(i.collapsed=!1);let r=e.createDiv({cls:"akl-keyword-card"}),l=r.createDiv({cls:"akl-card-header"}),c=l.createDiv({cls:"akl-collapse-btn"});c.innerHTML=i.collapsed?"\u25B6":"\u25BC",c.setAttribute("aria-label",i.collapsed?"Expand":"Collapse"),c.addEventListener("click",async()=>{i.collapsed=!i.collapsed,await this.plugin.saveSettings(),this.display()});let u=l.createDiv({cls:"akl-card-title"}),d=i.keyword||"New Keyword",p=i.target?` \u2192 ${i.target}`:"";u.createSpan({text:d,cls:"akl-keyword-name"}),p&&u.createSpan({text:p,cls:"akl-target-name"});let k=l.createDiv({cls:"akl-card-badges"});if(i.groupId){let S=this.plugin.settings.keywordGroups.find(C=>C.id===i.groupId);S&&k.createSpan({text:`\u{1F4C1} ${S.name}`,cls:"akl-badge akl-badge-group"})}let h=this.plugin.getEffectiveKeywordSettings(i);h.enableTags&&k.createSpan({text:"Tags",cls:"akl-badge akl-badge-tags"}),h.useRelativeLinks&&k.createSpan({text:"MD Links",cls:"akl-badge akl-badge-md-links"}),h.suggestMode&&k.createSpan({text:"Suggest",cls:"akl-badge akl-badge-suggest"});let g=this.plugin.getAliasesForNote(i.target),f=i.variations&&i.variations.length||0,w=g&&g.length||0,m=f+w;m>0&&k.createSpan({text:`${m} var`,cls:"akl-badge akl-badge-variations"});let b=r.createDiv({cls:"akl-card-body"});i.collapsed&&(b.style.display="none");let v=!!i.groupId,N=v?(n=this.plugin.settings.keywordGroups.find(S=>S.id===i.groupId))==null?void 0:n.name:null;new x(b).setName("Keyword").setDesc("The text to search for in your notes").addText(S=>{S.setValue(i.keyword).setPlaceholder("Enter keyword...").onChange(async C=>{this.plugin.settings.keywords[a].keyword=C,await this.plugin.saveSettings(),this.updateCardHeader(u,C,this.plugin.settings.keywords[a].target)}),S.inputEl.addClass("akl-input"),S.inputEl.addEventListener("blur",async()=>{!this.plugin.settings.keywords[a].target&&this.plugin.settings.keywords[a].keyword&&(this.plugin.settings.keywords[a].target=this.plugin.settings.keywords[a].keyword,await this.plugin.saveSettings(),this.display())})}),new x(b).setName("Target note").setDesc("Click to search and select the note to create links to").addText(S=>{let C=this.app.vault.getMarkdownFiles(),y=new Set;for(let A of C)if(y.add(A.basename),A.path.includes("/")){let q=A.path.endsWith(".md")?A.path.slice(0,-3):A.path;y.add(q)}let E=Array.from(y).sort((A,q)=>A.toLowerCase().localeCompare(q.toLowerCase())),R=i.target||"";S.setValue(R).setPlaceholder("Type to search notes..."),new nn(this.app,S.inputEl,E),S.onChange(async A=>{this.plugin.settings.keywords[a].target=A,await this.plugin.saveSettings(),this.updateCardHeader(u,this.plugin.settings.keywords[a].keyword,A)})}),new x(b).setName("Block reference").setDesc("Optional: Link to a specific block (e.g., ^block-id for abbreviation definitions)").addText(S=>{S.setValue(i.blockRef||"").setPlaceholder("^block-id").onChange(async C=>{let y=C;y=y.replace(/\[\[.*?\]\]/g,""),y&&!y.startsWith("^")&&(y="^"+y),y=y.replace(/\s/g,""),this.plugin.settings.keywords[a].blockRef=y,await this.plugin.saveSettings(),y!==C&&S.setValue(y)}),S.inputEl.setAttribute("autocomplete","off"),S.inputEl.setAttribute("data-no-suggest","true")}),new x(b).setName("Require tag").setDesc("Optional: Only link to target note if it has this tag (e.g., #reviewed or reviewed)").addText(S=>{S.setValue(i.requireTag||"").setPlaceholder("#tag or tag").onChange(async C=>{let y=C.trim();y.startsWith("#")&&(y=y.substring(1)),this.plugin.settings.keywords[a].requireTag=y,await this.plugin.saveSettings()}),S.inputEl.setAttribute("autocomplete","off")}),new x(b).setName("Only link in notes already linking to target").setDesc("Only create keyword links in notes that already have at least one link to the target note").addToggle(S=>{let C=this.plugin.getEffectiveKeywordSettings(i);S.setValue(C.onlyInNotesLinkingTo||!1).onChange(async y=>{this.plugin.settings.keywords[a].onlyInNotesLinkingTo=y,await this.plugin.saveSettings()})});let F=b.createDiv({cls:"akl-variations-section"});F.createEl("div",{text:"Variations",cls:"setting-item-name"}),F.createEl("div",{text:"Alternative spellings that also link to the target note",cls:"setting-item-description"});let L=F.createDiv({cls:"akl-chips-container"}),B=i.variations&&i.variations.length>0,I=g&&g.length>0;!B&&!I?L.createSpan({text:"No variations added yet",cls:"akl-no-variations"}):(this.renderVariationChips(L,i.variations||[],a),I&&this.renderAliasChips(L,g));let D=F.createDiv({cls:"akl-add-variation"}).createEl("input",{type:"text",placeholder:"Type and press Enter to add...",cls:"akl-variation-input"});D.addEventListener("keydown",async S=>{if(S.key==="Enter"){S.preventDefault();let C=D.value.trim();if(!C)return;if(i.variations||(i.variations=[]),i.variations.some(A=>A.toLowerCase()===C.toLowerCase())){new Te("Variation already exists"),D.value="";return}D.value="",i.variations.push(C),await this.plugin.saveSettings(),L.empty();let E=i.variations&&i.variations.length>0,R=g&&g.length>0;!E&&!R?L.createSpan({text:"No variations added yet",cls:"akl-no-variations"}):(this.renderVariationChips(L,i.variations||[],a),R&&this.renderAliasChips(L,g)),D.focus()}});let $=new x(b).setName("Enable tags").setDesc(v?`Inherited from group "${N}"`:"Automatically add tags to source and target notes").addToggle(S=>{let C=this.plugin.getEffectiveKeywordSettings(i);S.setValue(C.enableTags||!1).setDisabled(v).onChange(async y=>{v||(this.plugin.settings.keywords[a].enableTags=y,await this.plugin.saveSettings(),this.display())})});v&&$.settingEl.addClass("akl-disabled-setting");let M=new x(b).setName("Use relative Markdown links").setDesc(v?`Inherited from group "${N}"`:"Create Markdown links [text](note.md) instead of wikilinks [[note]]").addToggle(S=>{let C=this.plugin.getEffectiveKeywordSettings(i);S.setValue(C.useRelativeLinks||!1).setDisabled(v).onChange(async y=>{v||(this.plugin.settings.keywords[a].useRelativeLinks=y,await this.plugin.saveSettings())})});v&&M.settingEl.addClass("akl-disabled-setting");let O=new x(b).setName("Suggest instead of auto-link").setDesc(v?`Inherited from group "${N}"`:"Highlight keywords as suggestions instead of automatically creating links. Right-click to accept.").addToggle(S=>{let C=this.plugin.getEffectiveKeywordSettings(i);S.setValue(C.suggestMode||!1).setDisabled(v).onChange(async y=>{v||(this.plugin.settings.keywords[a].suggestMode=y,await this.plugin.saveSettings(),this.display())})});v&&O.settingEl.addClass("akl-disabled-setting"),new x(b).setName("Keyword group").setDesc("Assign to a group to inherit group settings. Group settings will be locked and cannot be overridden per-keyword.").addDropdown(S=>{S.addOption("","(No group)"),this.plugin.settings.keywordGroups.forEach(C=>{S.addOption(C.id,C.name)}),S.setValue(i.groupId||"").onChange(async C=>{this.plugin.settings.keywords[a].groupId=C||null,await this.plugin.saveSettings(),this.display()})});let K=new x(b).setName("Prevent self-link").setDesc(v?`Inherited from group "${N}"`:"Prevent this keyword from linking on its own target note (overrides global setting)").addToggle(S=>{let C=this.plugin.getEffectiveKeywordSettings(i);S.setValue(C.preventSelfLink||!1).setDisabled(v).onChange(async y=>{v||(this.plugin.settings.keywords[a].preventSelfLink=y,await this.plugin.saveSettings())})});v&&K.settingEl.addClass("akl-disabled-setting");let z=new x(b).setName("Link scope").setDesc(v?`Inherited from group "${N}"`:"Control where this keyword will be linked").addDropdown(S=>{let C=this.plugin.getEffectiveKeywordSettings(i);S.addOption("vault-wide","Vault-wide (everywhere)").addOption("same-folder","Same folder only").addOption("source-folder","Source in specific folder").addOption("target-folder","Target in specific folder").setValue(C.linkScope||"vault-wide").setDisabled(v).onChange(async y=>{v||(this.plugin.settings.keywords[a].linkScope=y,await this.plugin.saveSettings(),this.display())})});if(v&&z.settingEl.addClass("akl-disabled-setting"),i.linkScope==="source-folder"||i.linkScope==="target-folder"){let C=["",...this.getAllFolders()];new x(b).setName("Folder").setDesc("Type to search and select a folder").addText(y=>{let E=i.scopeFolder||"/ (Root)";y.setValue(E).setPlaceholder("Type to search folders..."),new xt(this.app,y.inputEl,C),y.onChange(async R=>{let A=R==="/ (Root)"?"":R;A&&(A=Ct(A)),this.plugin.settings.keywords[a].scopeFolder=A,await this.plugin.saveSettings()})})}b.createDiv({cls:"akl-card-footer"}).createEl("button",{text:"Delete keyword",cls:"akl-delete-btn"}).addEventListener("click",async()=>{this.plugin.settings.keywords.splice(a,1),await this.plugin.saveSettings(),this.display()})}if(s===0&&t){let a=e.createDiv({cls:"akl-no-results"});a.createEl("p",{text:"No keywords found"}),a.createEl("p",{text:`No keywords match "${this.searchFilter}"`,cls:"akl-no-results-hint"})}}renderGroups(e){if(e.empty(),this.plugin.settings.keywordGroups.length===0){let t=e.createDiv({cls:"akl-empty-state"});t.createEl("p",{text:"No groups yet"}),t.createEl("p",{text:"Create a group to organize your keywords with shared settings",cls:"akl-empty-hint"});return}for(let t=0;t<this.plugin.settings.keywordGroups.length;t++){let s=this.plugin.settings.keywordGroups[t];s.collapsed===void 0&&(s.collapsed=!1);let n=this.plugin.settings.keywords.filter(h=>h.groupId===s.id),a=e.createDiv({cls:"akl-keyword-card akl-group-card"}),i=a.createDiv({cls:"akl-card-header"}),r=i.createDiv({cls:"akl-collapse-btn"});r.innerHTML=s.collapsed?"\u25B6":"\u25BC",r.setAttribute("aria-label",s.collapsed?"Expand":"Collapse"),r.addEventListener("click",async()=>{s.collapsed=!s.collapsed,await this.plugin.saveSettings(),this.display()});let l=i.createDiv({cls:"akl-card-title"});l.createSpan({text:s.name,cls:"akl-keyword-name"}),l.createSpan({text:` (${n.length} keywords)`,cls:"akl-target-name"}),i.createEl("button",{text:"\u{1F5D1}\uFE0F Delete",cls:"akl-delete-btn"}).addEventListener("click",async h=>{h.stopPropagation(),this.plugin.settings.keywords.forEach(g=>{g.groupId===s.id&&(g.groupId=null)}),this.plugin.settings.keywordGroups.splice(t,1),await this.plugin.saveSettings(),this.display()});let u=a.createDiv({cls:"akl-card-body"});s.collapsed&&(u.style.display="none"),new x(u).setName("Group name").setDesc("Name for this group of keywords").addText(h=>{h.setValue(s.name).setPlaceholder("Enter group name...").onChange(async g=>{this.plugin.settings.keywordGroups[t].name=g,await this.plugin.saveSettings(),l.empty(),l.createSpan({text:g,cls:"akl-keyword-name"}),l.createSpan({text:` (${n.length} keywords)`,cls:"akl-target-name"})}),h.inputEl.addClass("akl-input")});let d=u.createDiv({cls:"akl-group-keywords-section"});if(d.createEl("h4",{text:"Keywords in this group",cls:"akl-subsection-header"}),n.length===0)d.createEl("p",{text:"No keywords in this group yet. Add keywords below or assign them from the keywords tab.",cls:"akl-hint-text"});else{let h=d.createDiv({cls:"akl-keywords-list"});n.forEach(g=>{let f=h.createDiv({cls:"akl-keyword-chip"});f.createSpan({text:g.keyword||"Untitled"}),f.createSpan({text:"\xD7",cls:"akl-chip-remove"}).addEventListener("click",async()=>{g.groupId=null,await this.plugin.saveSettings(),this.display()})})}d.createEl("button",{text:"+ Add keywords to group",cls:"akl-button-secondary"}).addEventListener("click",()=>{let h=this.plugin.settings.keywords.filter(g=>g.groupId===s.id);new sn(this.app,this.plugin,s.id,h).open()});let k=u.createDiv({cls:"akl-group-settings-section"});k.createEl("h4",{text:"Group settings",cls:"akl-subsection-header"}),k.createEl("p",{text:"These settings apply to all keywords in this group (unless overridden per-keyword).",cls:"akl-hint-text"}),new x(k).setName("Link scope").setDesc("Where this group's keywords should create links").addDropdown(h=>h.addOption("vault-wide","Vault-wide (link in all notes)").addOption("source-folder","Source folder only").addOption("target-folder","Target folder only").setValue(s.settings.linkScope||"vault-wide").onChange(async g=>{s.settings.linkScope=g,await this.plugin.saveSettings()})),new x(k).setName("Enable tags").setDesc("Add #tag to target notes when linking").addToggle(h=>h.setValue(s.settings.enableTags||!1).onChange(async g=>{s.settings.enableTags=g,await this.plugin.saveSettings()})),new x(k).setName("Suggest mode").setDesc("Suggest links instead of creating them automatically").addToggle(h=>h.setValue(s.settings.suggestMode||!1).onChange(async g=>{s.settings.suggestMode=g,await this.plugin.saveSettings()})),new x(k).setName("Use Markdown links").setDesc("Use [text](link.md) format instead of [[wikilinks]]").addToggle(h=>h.setValue(s.settings.useRelativeLinks||!1).onChange(async g=>{s.settings.useRelativeLinks=g,await this.plugin.saveSettings()})),new x(k).setName("Prevent self-links").setDesc("Don't link keywords on their own target note").addToggle(h=>h.setValue(s.settings.preventSelfLink||!1).onChange(async g=>{s.settings.preventSelfLink=g,await this.plugin.saveSettings()}))}}renderVariationChips(e,t,s){t.length!==0&&t.forEach((n,a)=>{let i=e.createDiv({cls:"akl-chip"});i.createSpan({text:n,cls:"akl-chip-text"});let r=i.createSpan({text:"\xD7",cls:"akl-chip-remove"});r.setAttribute("aria-label",`Remove ${n}`),r.addEventListener("click",async()=>{this.plugin.settings.keywords[s].variations.splice(a,1),await this.plugin.saveSettings(),this.display()})})}renderAliasChips(e,t){!t||t.length===0||t.forEach(s=>{let n=e.createDiv({cls:"akl-chip akl-chip-auto"});n.createSpan({text:s,cls:"akl-chip-text"});let a=n.createSpan({text:"\u{1F517}",cls:"akl-chip-auto-indicator"});a.setAttribute("aria-label","Auto-discovered from note alias"),a.setAttribute("title","Auto-discovered from note frontmatter")})}getAllFolders(){let e=new Set;return this.app.vault.getAllLoadedFiles().filter(s=>s.children).map(s=>s.path).forEach(s=>{s&&s!=="/"&&e.add(s)}),Array.from(e).sort((s,n)=>s.toLowerCase().localeCompare(n.toLowerCase()))}addCustomStyles(){}};Tt.exports=Ee});var $t=T((Qo,Et)=>{var{FuzzySuggestModal:on}=require("obsidian"),$e=class extends on{constructor(e,t,s,n){super(e),this.folders=t,this.currentValue=s,this.onChooseCallback=n}getItems(){return this.folders}getItemText(e){return e||"/ (Root)"}onChooseItem(e,t){this.onChooseCallback(e)}};Et.exports=$e});var Nt=T((Yo,At)=>{var{FuzzySuggestModal:an}=require("obsidian"),Ae=class extends an{constructor(e,t,s,n){super(e),this.notes=t,this.currentValue=s,this.onChooseCallback=n}getItems(){return this.notes}getItemText(e){return e}onChooseItem(e,t){this.onChooseCallback(e)}};At.exports=Ae});var Fe=T((Xo,Bt)=>{var{Notice:It,Menu:De,MarkdownView:U}=require("obsidian"),{escapeRegex:Ne}=P();function rn(o,e){e.querySelectorAll(".akl-suggested-link").forEach(s=>{s.addEventListener("click",n=>{n.preventDefault(),n.stopPropagation(),new It("Switch to edit mode to accept suggestions, or use the review modal")}),s.addEventListener("contextmenu",n=>{n.preventDefault(),n.stopPropagation();let a=new De;a.addItem(i=>{i.setTitle("\u{1F4CB} Review link suggestions (opens in edit mode)").setIcon("list-checks").onClick(async()=>{let r=o.app.workspace.getActiveViewOfType(U);r&&(await r.setState({mode:"source"},{}),setTimeout(()=>{var c;let l=(c=o.app.workspace.getActiveViewOfType(U))==null?void 0:c.editor;l&&o.reviewSuggestions(l)},100))})}),a.showAtMouseEvent(n)})})}function Dt(o){var i;if(!o.statusBarItem)return;let e=(i=o.app.workspace.getActiveViewOfType(U))==null?void 0:i.editor;if(!e){o.statusBarItem.setText(""),o.statusBarItem.style.display="none";return}let t=e.getValue(),s=/<span class="akl-suggested-link"[^>]*>([^<]+)<\/span>/g,n=t.match(s),a=n?n.length:0;a>0?(o.statusBarItem.setText(`\u{1F4A1} ${a} link suggestion${a>1?"s":""}`),o.statusBarItem.style.cursor="pointer",o.statusBarItem.style.display="inline-block",o.statusBarItem.addClass("mod-clickable"),o.statusBarItem.setAttribute("aria-label","Click to review suggestions"),o.statusBarItem.onclick=()=>{var l;let r=(l=o.app.workspace.getActiveViewOfType(U))==null?void 0:l.editor;r&&o.reviewSuggestions(r)}):(o.statusBarItem.setText(""),o.statusBarItem.style.display="none",o.statusBarItem.onclick=null)}function ln(o){o.registerDomEvent(document,"contextmenu",e=>{let t=e.target;if(t&&t.classList&&t.classList.contains("akl-suggested-link")){e.preventDefault();let s=new De;s.addItem(n=>{n.setTitle("Accept link suggestion").setIcon("check").onClick(()=>{o.acceptSuggestionElement(t)})}),s.showAtMouseEvent(e)}})}function cn(o){o.registerDomEvent(document,"click",e=>{let t=o.app.workspace.getActiveViewOfType(U);if(!t)return;let s=t.editor;if(!s)return;let n=e.target,a=null;if(n.classList&&n.classList.contains("akl-suggested-link")?a=n:n.parentElement&&n.parentElement.classList&&n.parentElement.classList.contains("akl-suggested-link")&&(a=n.parentElement),a){e.preventDefault(),e.stopPropagation();let i=s.getCursor(),r=s.getLine(i.line);Ie(o,s,i.line,r,e)}}),o.registerDomEvent(document,"contextmenu",e=>{let t=o.app.workspace.getActiveViewOfType(U);if(!t)return;let s=t.editor;if(!s)return;let n=e.target,a=null;if(n.classList&&n.classList.contains("akl-suggested-link")?a=n:n.parentElement&&n.parentElement.classList&&n.parentElement.classList.contains("akl-suggested-link")&&(a=n.parentElement),a){e.preventDefault(),e.stopPropagation();let i=s.getCursor(),r=s.getLine(i.line);Ie(o,s,i.line,r,e)}})}function Ie(o,e,t,s,n){let a=/<span class="akl-suggested-link" data-target="([^"]*)" data-block="([^"]*)" data-use-relative="([^"]*)"[^>]*>([^<]+)<\/span>/g,i=[...s.matchAll(a)];if(i.length===0)return;let r=i[0],l=r[1],c=r[2],u=r[3]==="true",d=r[4],p=new De;p.addItem(k=>{k.setTitle(`Accept link suggestion: "${d}"`).setIcon("check").onClick(()=>{Ft(o,e,t,s,d,l,c,u)})}),p.showAtMouseEvent(n)}function Ft(o,e,t,s,n,a,i,r){let l=new RegExp(`<span class="akl-suggested-link" data-target="${Ne(a)}" data-block="${Ne(i)}" data-use-relative="${r?"true":"false"}"[^>]*>${Ne(n)}</span>`);if(!l.test(s))return;let c=e.getValue(),u=e.posToOffset({line:t,ch:0}),d=o.isInsideTable(c,u),p,k=i?`${a}#${i}`:a;if(r){let g=d?n.replace(/\|/g,"\\|"):n,f=encodeURIComponent(a)+".md",w=i?`#${i}`:"";p=`[${g}](${f}${w})`}else d?p=a===n&&!i?`[[${n}]]`:`[[${k}\\|${n}]]`:p=a===n&&!i?`[[${n}]]`:`[[${k}|${n}]]`;let h=s.replace(l,p);e.setLine(t,h),new It("Link suggestion accepted"),setTimeout(()=>Dt(o),100)}Bt.exports={processSuggestedLinks:rn,updateStatusBar:Dt,setupSuggestionContextMenu:ln,setupLivePreviewClickHandler:cn,showSuggestionMenuAtLine:Ie,acceptSuggestionInLine:Ft}});var Vt=T((ei,Mt)=>{function dn(){}Mt.exports={addCustomStyles:dn}});var Rt=T((ti,Kt)=>{function un(o){let e=null,t=new Map,s=new Set;o.registerEvent(o.app.vault.on("modify",n=>{n.extension==="md"&&!s.has(n.path)&&(s.add(n.path),o.linkKeywordsInFile(n,!1,!0).then(a=>{if(s.delete(n.path),a&&a.pendingTags){t.has(n.path)||t.set(n.path,{tagsToAdd:new Set,targetNotesForTags:new Map});let i=t.get(n.path);a.pendingTags.tagsToAdd.forEach(r=>i.tagsToAdd.add(r)),a.pendingTags.targetNotesForTags.forEach((r,l)=>{i.targetNotesForTags.set(l,r)}),e&&clearTimeout(e),e=setTimeout(async()=>{try{for(let[r,l]of t.entries()){let c=o.app.vault.getAbstractFileByPath(r);c&&c.extension==="md"&&(s.add(r),await o.addTagsToFile(c,Array.from(l.tagsToAdd),l.targetNotesForTags),setTimeout(()=>{s.delete(r)},100))}}finally{t.clear(),e=null}},1e3)}}))}))}Kt.exports={setupAutoLinkOnSave:un}});var zt=T((oi,Pt)=>{var{MarkdownView:gn}=require("obsidian"),{escapeRegex:te,getContext:pn}=P(),{getFrontmatterBounds:hn,isInsideAlias:fn,isPartOfUrl:wn,isInsideLinkOrCode:kn,isInsideBlockReference:yn,isInsideTable:mn,isInsideMath:vn}=ce(),{getEffectiveKeywordSettings:si,buildKeywordMap:qt,checkLinkScope:Sn}=re(),{findTargetFile:bn,getAliasesForNote:ni,noteHasTag:Cn,noteHasLinkToTarget:xn,ensureNoteExists:Ln}=oe(),{sanitizeTagName:Tn,addTagsToContent:En,addTagToTargetNote:Ot}=ue(),Be=class{constructor(e,t){this.app=e,this.settings=t}processContent(e,t,s=!1,n=!1){let a=e,i=e.length,r=hn(e),l=0,c=[],u=new Set,d=new Map,p=qt(this.app,this.settings),k=Object.keys(p).sort((w,m)=>m.length-w.length),h=new Set,g=[];for(let w of k){let m=p[w].target,b=p[w].enableTags,v=p[w].linkScope||"vault-wide",N=p[w].scopeFolder||"",F=p[w].useRelativeLinks||!1,L=p[w].blockRef||"",B=p[w].requireTag||"",I=p[w].onlyInNotesLinkingTo||!1,V=p[w].suggestMode||!1,D=p[w].preventSelfLink||!1,$=p[w].keywordIndex;if(!w.trim()||!m||!m.trim())continue;if(this.settings.preventSelfLinkGlobal||D){let y=t.basename,E=m.split("/").pop();if(y===E)continue}if(I&&!xn(this.app,t,m)||!Cn(this.app,m,B)||!Sn(this.app,t,m,v,N,bn))continue;let M=this.settings.caseSensitive?"g":"gi",O=te(w),K=/^\w/.test(w)?"\\b":"(?<![\\w])",z=/\w$/.test(w)?"\\b":"(?![\\w])",Me=new RegExp(`${K}${O}${z}`,M),se,S=[],C=!1;for(;(se=Me.exec(e))!==null;){let y=se.index,E=se[0];if(r&&y>=r.start&&y<r.end||y>0&&e[y-1]==="#"||yn(e,y)||kn(e,y)||fn(e,y)||wn(e,y,E.length)||vn(e,y))continue;if(this.settings.firstOccurrenceOnly){let W=w.toLowerCase();if(h.has(W))break;let J=this.settings.caseSensitive?new RegExp(`\\[\\[([^\\]]+\\|)?${te(w)}\\]\\]`):new RegExp(`\\[\\[([^\\]]+\\|)?${te(w)}\\]\\]`,"i"),ne=this.settings.caseSensitive?new RegExp(`<span class="akl-suggested-link"[^>]*>${te(w)}</span>`):new RegExp(`<span class="akl-suggested-link"[^>]*>${te(w)}</span>`,"i");if(J.test(e)||ne.test(e))break;h.add(W)}let R=mn(e,y),A=L?`${m}#${L}`:m,q;if(V){let W=m.replace(/"/g,"&quot;"),J=L.replace(/"/g,"&quot;");q=`<span class="akl-suggested-link" data-target="${W}" data-block="${J}" data-use-relative="${F?"true":"false"}" data-keyword-index="${$}">${E}</span>`}else if(F){let W=R?E.replace(/\|/g,"\\|"):E,J=encodeURIComponent(m)+".md",ne=L?`#${L}`:"";q=`[${W}](${J}${ne})`}else R?q=m===E&&!L?`[[${E}]]`:`[[${A}\\|${E}]]`:q=m===E&&!L?`[[${E}]]`:`[[${A}|${E}]]`;if(S.push({index:y,length:E.length,original:E,replacement:q,lengthDiff:q.length-E.length}),c.push({keyword:E,target:m,context:pn(e,y)}),C=!0,this.settings.firstOccurrenceOnly)break}if(C&&b){let y=Tn(w);u.add(y),m!==t.basename&&d.set(m,y)}for(let y=S.length-1;y>=0;y--){let E=S[y];e=e.substring(0,E.index)+E.replacement+e.substring(E.index+E.length),l++}for(let y=0;y<S.length;y++)g.push({index:S[y].index,lengthDiff:S[y].lengthDiff})}return g.sort((w,m)=>w.index-m.index),u.size>0&&!s&&!n&&(e=En(e,Array.from(u))),{newContent:e,originalContent:a,originalLength:i,changed:e!==a,linkCount:l,changes:c,tagsToAdd:u,targetNotesForTags:d,allReplacements:g}}async linkKeywordsInFile(e,t=!1,s=!1){if(e.extension!=="md")return null;let n=this.app.workspace.getActiveViewOfType(gn),i=n&&n.file.path===e.path?n.editor:null;if(this.settings.autoCreateNotes){let l=qt(this.app,this.settings);for(let c of Object.keys(l)){let u=l[c].target;u&&u.trim()&&await Ln(this.app,this.settings,u)}}let r=null;if(i){let l=t?null:i.getCursor(),c=i.getValue(),u=this.processContent(c,e,t,s);if(!u.changed)return null;if(!t){let d=u.originalContent.split(`
`),p=0;for(let f=0;f<l.line&&f<d.length;f++)p+=d[f].length+1;p+=l.ch;let k=0;for(let f of u.allReplacements)f.index<p&&(k+=f.lengthDiff);let h=p+k,g=p>=u.originalLength-10;if(i.setValue(u.newContent),u.tagsToAdd.size>0&&g){let f=u.newContent.split(`
`),w=-1;for(let m=f.length-1;m>=0;m--){let b=f[m].trim();if(b!==""&&!b.match(/^#[\w\-]+(\s+#[\w\-]+)*$/)){w=m;break}}w>=0?i.setCursor({line:w,ch:f[w].length}):i.setCursor({line:0,ch:0})}else{let f=u.newContent.split(`
`),w=h,m=0,b=0;for(let v=0;v<f.length;v++){if(w<=f[v].length){m=v,b=w;break}w-=f[v].length+1}i.setCursor({line:m,ch:b})}if(!s)for(let[f,w]of u.targetNotesForTags)await Ot(this.app,f,w)}r={changed:!0,linkCount:u.linkCount,changes:u.changes,preview:t?u.newContent:null},s&&(u.tagsToAdd.size>0||u.targetNotesForTags.size>0)&&(r.pendingTags={tagsToAdd:Array.from(u.tagsToAdd),targetNotesForTags:u.targetNotesForTags})}else{let l=null;if(await this.app.vault.process(e,c=>(l=this.processContent(c,e,t,s),!l.changed||t?c:l.newContent)),!l||!l.changed)return null;if(!t&&!s)for(let[c,u]of l.targetNotesForTags)await Ot(this.app,c,u);r={changed:!0,linkCount:l.linkCount,changes:l.changes,preview:t?l.newContent:null},s&&(l.tagsToAdd.size>0||l.targetNotesForTags.size>0)&&(r.pendingTags={tagsToAdd:Array.from(l.tagsToAdd),targetNotesForTags:l.targetNotesForTags})}return r}};Pt.exports=Be});var Gt=T((ii,Wt)=>{function $n(o){o.addCommand({id:"link-keywords-in-current-note",name:"Link keywords in current note",editorCheckCallback:(e,t,s)=>{if(e)return s.file!==null;o.linkKeywordsInCurrentNote(!1)}}),o.addCommand({id:"preview-keywords-in-current-note",name:"Preview keyword linking in current note",editorCheckCallback:(e,t,s)=>{if(e)return s.file!==null;o.linkKeywordsInCurrentNote(!0)}}),o.addCommand({id:"link-keywords-in-all-notes",name:"Link keywords in all notes",callback:()=>o.linkKeywordsInAllNotes(!1)}),o.addCommand({id:"preview-keywords-in-all-notes",name:"Preview keyword linking in all notes",callback:()=>o.linkKeywordsInAllNotes(!0)}),o.addCommand({id:"suggest-keywords",name:"Suggest keywords from notes",callback:()=>o.suggestKeywords()}),o.addCommand({id:"suggest-keywords-current-note",name:"Suggest keywords from current note only",editorCheckCallback:(e,t,s)=>{if(e)return s.file!==null;o.suggestKeywordsFromCurrentNote()}}),o.addCommand({id:"accept-suggestion-at-cursor",name:"Accept all suggestions on current line",editorCallback:e=>o.acceptSuggestionAtCursor(e)}),o.addCommand({id:"accept-all-suggestions",name:"Accept all link suggestions in current note",editorCallback:e=>o.acceptAllSuggestions(e)}),o.addCommand({id:"review-link-suggestions",name:"Review link suggestions",editorCallback:e=>o.reviewSuggestions(e)}),o.addCommand({id:"export-keywords",name:"Export keywords to JSON",callback:()=>o.exportKeywords()}),o.addCommand({id:"import-keywords",name:"Import keywords from JSON",callback:()=>o.importKeywords()}),o.addCommand({id:"download-csv-template",name:"Download CSV template",callback:()=>o.downloadCSVTemplate()}),o.addCommand({id:"export-keywords-csv",name:"Export keywords to CSV",callback:()=>o.exportKeywordsToCSV()}),o.addCommand({id:"import-keywords-csv",name:"Import keywords from CSV",callback:()=>o.importKeywordsFromCSV()}),o.addCommand({id:"view-statistics",name:"View statistics",callback:()=>o.showStatistics()})}Wt.exports={registerCommands:$n}});var Ht=T((ai,jt)=>{var _=Fe();function An(o){_.setupSuggestionContextMenu(o),o.registerMarkdownPostProcessor(e=>{_.processSuggestedLinks(o,e)}),_.setupLivePreviewClickHandler(o),o.registerEvent(o.app.workspace.on("editor-menu",(e,t)=>{let s=t.getValue();/<span class="akl-suggested-link"[^>]*>([^<]+)<\/span>/.test(s)&&(e.addItem(a=>{a.setTitle("\u{1F4CB} Review all link suggestions...").setIcon("list-checks").onClick(()=>{o.reviewSuggestions(t)})}),e.addItem(a=>{a.setTitle("\u2713 Accept all suggestions on this line").setIcon("check").onClick(()=>{o.acceptSuggestionAtCursor(t)})}),e.addSeparator())})),o.statusBarItem=o.addStatusBarItem(),_.updateStatusBar(o),o.registerEvent(o.app.workspace.on("active-leaf-change",()=>{_.updateStatusBar(o)})),o.registerEvent(o.app.workspace.on("editor-change",()=>{setTimeout(()=>_.updateStatusBar(o),100)}))}jt.exports={registerEvents:An}});var{Plugin:Nn}=require("obsidian"),{loadSettings:In,saveSettings:Dn,setupSettingsWatcher:Fn}=qe(),{getEffectiveKeywordSettings:Bn,buildKeywordMap:Mn,checkLinkScope:Vn}=re(),{getAliasesForNote:Kn,noteHasTag:Rn,noteHasLinkToTarget:qn,ensureNoteExists:On,findTargetFile:Ut}=oe(),{getStopWords:Pn,extractWordsFromText:zn,extractPhrasesFromText:Wn,analyzeNotesForKeywords:Gn,analyzeCurrentNoteForKeywords:jn}=Ge(),{getFrontmatterBounds:Hn,isInsideAlias:Un,isPartOfUrl:_n,isInsideLinkOrCode:Zn,isInsideBlockReference:Jn,isInsideTable:Qn,isInsideMath:Yn}=ce(),{sanitizeTagName:Xn,addTagsToContent:eo,addTagsToFile:to,addTagToTargetNote:so}=ue(),{linkKeywordsInCurrentNote:no,linkKeywordsInAllNotes:oo}=Ze(),{suggestKeywords:io,suggestKeywordsFromCurrentNote:ao,reviewSuggestions:ro,acceptSuggestionAtCursor:lo,acceptAllSuggestions:co}=Qe(),{exportKeywords:uo,importKeywords:go,downloadCSVTemplate:po,exportKeywordsToCSV:ho,importKeywordsFromCSV:fo}=Xe(),{showStatistics:wo}=tt(),ko=nt(),_t=it(),yo=rt(),mo=dt(),vo=gt(),So=ft(),bo=kt(),Co=Ce(),ri=be(),li=$t(),ci=Nt(),Z=Fe(),{addCustomStyles:Zt}=Vt(),{setupAutoLinkOnSave:Jt}=Rt(),xo=zt(),{registerCommands:Lo}=Gt(),{registerEvents:To}=Ht();module.exports=class extends Nn{async onExternalSettingsChange(){this._handleExternalSettingsChange&&await this._handleExternalSettingsChange()}async onload(){this.settings=await In(this),Fn(this),this.keywordLinker=new xo(this.app,this.settings),Lo(this),this.addSettingTab(new Co(this.app,this)),Zt(),To(this),this.settings.autoLinkOnSave&&Jt(this)}processSuggestedLinks(e){return Z.processSuggestedLinks(this,e)}updateStatusBar(){return Z.updateStatusBar(this)}setupSuggestionContextMenu(){return Z.setupSuggestionContextMenu(this)}setupLivePreviewClickHandler(){return Z.setupLivePreviewClickHandler(this)}showSuggestionMenuAtLine(e,t,s,n){return Z.showSuggestionMenuAtLine(this,e,t,s,n)}acceptSuggestionInLine(e,t,s,n,a,i,r){return Z.acceptSuggestionInLine(this,e,t,s,n,a,i,r)}reviewSuggestions(e){return ro(this.app,e,So)}acceptSuggestionAtCursor(e){return lo(e,this.isInsideTable.bind(this),this.updateStatusBar.bind(this))}acceptAllSuggestions(e){return co(e,this.isInsideTable.bind(this),this.updateStatusBar.bind(this))}showStatistics(){return wo(this.app,this.settings,ko)}async exportKeywords(){return await uo(this.app,this.settings)}async importKeywords(){return await go(this.app,this,yo)}async downloadCSVTemplate(){return await po(this.app)}async exportKeywordsToCSV(){return await ho(this.app,this.settings)}async importKeywordsFromCSV(){return await fo(this.app,this,mo)}async suggestKeywords(){return await io(this.app,this,_t)}async suggestKeywordsFromCurrentNote(){return await ao(this.app,this,_t)}getStopWords(){return Pn(this.settings)}extractWordsFromText(e,t=!1){return zn(e,t,this.settings)}extractPhrasesFromText(e){return Wn(e,this.settings)}async analyzeNotesForKeywords(){return await Gn(this.app,this.settings,this.getAliasesForNote.bind(this))}async analyzeCurrentNoteForKeywords(e){return await jn(this.app,this.settings,e,this.getAliasesForNote.bind(this))}setupAutoLinkOnSave(){return Jt(this)}async linkKeywordsInCurrentNote(e=!1){return await no(this.app,this.settings,this.linkKeywordsInFile.bind(this),this.saveSettings.bind(this),this.updateStatusBar.bind(this),vo,e)}async linkKeywordsInAllNotes(e=!1){return await oo(this.app,this.settings,this.linkKeywordsInFile.bind(this),this.saveSettings.bind(this),this,bo,e)}async linkKeywordsInFile(e,t=!1,s=!1){return this.keywordLinker.settings=this.settings,await this.keywordLinker.linkKeywordsInFile(e,t,s)}async addTagsToFile(e,t,s){return await to(this.app,e,t,s)}sanitizeTagName(e){return Xn(e)}addTagsToContent(e,t){return eo(e,t)}async addTagToTargetNote(e,t){return await so(this.app,e,t)}getFrontmatterBounds(e){return Hn(e)}isInsideAlias(e,t){return Un(e,t)}isPartOfUrl(e,t,s){return _n(e,t,s)}isInsideLinkOrCode(e,t){return Zn(e,t)}isInsideBlockReference(e,t){return Jn(e,t)}isInsideTable(e,t){return Qn(e,t)}isInsideMath(e,t){return Yn(e,t)}getEffectiveKeywordSettings(e){return Bn(this.settings,e)}buildKeywordMap(){return Mn(this.app,this.settings)}checkLinkScope(e,t,s,n){return Vn(this.app,e,t,s,n,Ut)}findTargetFile(e){return Ut(this.app,e)}getAliasesForNote(e){return Kn(this.app,e)}noteHasTag(e,t){return Rn(this.app,e,t)}noteHasLinkToTarget(e,t){return qn(this.app,e,t)}async ensureNoteExists(e){return await On(this.app,this.settings,e)}async saveSettings(){await Dn(this,this.settings)}addCustomStyles(){return Zt()}};

/* nosourcemap */