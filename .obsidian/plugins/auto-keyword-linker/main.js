/*
THIS IS A GENERATED FILE. DO NOT EDIT DIRECTLY.
Edit files in src/ and run 'npm run build'
*/

var T=(o,e)=>()=>(e||o((e={exports:{}}).exports,e),e.exports);var ce=T((Mo,qe)=>{var ss=["a","an","and","are","as","at","be","by","for","from","has","he","in","is","it","its","of","on","that","the","to","was","will","with","the","this","but","they","have","had","what","when","where","who","which","why","how","all","each","every","both","few","more","most","other","some","such","no","nor","not","only","own","same","so","than","too","very","can","will","just","should","now","my","me","we","us","our","your","their","his","her","i","you","do","does","did","am","been","being","get","got","if","or","may","could","would","should","might","must","one","two","three","four","five","six","seven","eight","nine","ten","there","then","these","those","also","any","about","after","again","before","because","between","during","through","under","over","above","below","up","down","out","off","into","since","until","while","once","here","there","see","saw","seen","go","goes","going","gone","went","want","wanted","make","made","use","used","using","day","days","way","ways","thing","things","yes","no","okay","ok"],ns={keywordGroups:[],keywords:[{id:"kw-1",keyword:"Keyword1",target:"Keyword1",variations:[],enableTags:!1,linkScope:"vault-wide",scopeFolder:"",useRelativeLinks:!1,blockRef:"",requireTag:"",onlyInNotesLinkingTo:!1,suggestMode:!1,preventSelfLink:!1,groupId:null},{id:"kw-2",keyword:"Keyword2",target:"Keyword2",variations:[],enableTags:!1,linkScope:"vault-wide",scopeFolder:"",useRelativeLinks:!1,blockRef:"",requireTag:"",onlyInNotesLinkingTo:!1,suggestMode:!1,preventSelfLink:!1,groupId:null}],autoLinkOnSave:!1,caseSensitive:!1,firstOccurrenceOnly:!0,autoCreateNotes:!1,newNoteFolder:"",newNoteTemplate:`# {{keyword}}

Created: {{date}}

`,customStopWords:[],preventSelfLinkGlobal:!1,statistics:{totalLinksCreated:0,totalNotesProcessed:0,lastRunDate:null}};qe.exports={DEFAULT_STOP_WORDS:ss,DEFAULT_SETTINGS:ns}});var z=T((Ro,Pe)=>{function os(o="id"){return`${o}-${Date.now()}-${Math.random().toString(36).substring(2,11)}`}function is(o){return o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function as(o,e,t=40){let n=Math.max(0,e-t),s=Math.min(o.length,e+t);return"..."+o.substring(n,s)+"..."}function rs(o){return typeof o!="string"?o:o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}function ls(o){let e=[],t="",n=!1;for(let s=0;s<o.length;s++){let a=o[s],l=o[s+1];a==='"'&&n&&l==='"'?(t+='"',s++):a==='"'?n=!n:a===","&&!n?(e.push(t.trim()),t=""):t+=a}return e.push(t.trim()),e}Pe.exports={generateId:os,escapeRegex:is,getContext:as,escapeCSV:rs,parseCSVLine:ls}});var ze=T((qo,Oe)=>{var{DEFAULT_SETTINGS:j}=ce(),{generateId:cs}=z();async function ds(o){let e=Object.assign({},j,await o.loadData());if(e.statistics||(e.statistics=j.statistics),(!e.customStopWords||!Array.isArray(e.customStopWords))&&(e.customStopWords=j.customStopWords),e.keywordGroups||(e.keywordGroups=[]),e.keywords)for(let t of e.keywords)t.id||(t.id=cs("kw")),t.groupId===void 0&&(t.groupId=null),t.enableTags===void 0&&(t.enableTags=null),t.groupId&&t.enableTags===!1&&(t.enableTags=null),t.linkScope===void 0&&(t.linkScope="vault-wide"),t.scopeFolder===void 0&&(t.scopeFolder=""),t.requireTag===void 0&&(t.requireTag=""),t.onlyInNotesLinkingTo===void 0&&(t.onlyInNotesLinkingTo=null),t.groupId&&t.onlyInNotesLinkingTo===!1&&(t.onlyInNotesLinkingTo=null),t.suggestMode===void 0&&(t.suggestMode=null),t.groupId&&t.suggestMode===!1&&(t.suggestMode=null),t.preventSelfLink===void 0&&(t.preventSelfLink=null),t.groupId&&t.preventSelfLink===!1&&(t.preventSelfLink=null),t.useRelativeLinks===void 0&&(t.useRelativeLinks=null),t.groupId&&t.useRelativeLinks===!1&&(t.useRelativeLinks=null);return e}async function us(o,e){o.isSaving=!0,await o.saveData(e),setTimeout(()=>{o.isSaving=!1},100)}function gs(o){o.isSaving=!1,o._handleExternalSettingsChange=async()=>{if(!o.isSaving)try{let e=await o.loadData();if(o.settings=Object.assign({},j,e),o.settings.statistics||(o.settings.statistics=j.statistics),(!o.settings.customStopWords||!Array.isArray(o.settings.customStopWords))&&(o.settings.customStopWords=j.customStopWords),o.settings.keywords)for(let t of o.settings.keywords)t.enableTags===void 0&&(t.enableTags=!1),t.linkScope===void 0&&(t.linkScope="vault-wide"),t.scopeFolder===void 0&&(t.scopeFolder=""),t.useRelativeLinks===void 0&&(t.useRelativeLinks=!1),t.blockRef===void 0&&(t.blockRef=""),t.requireTag===void 0&&(t.requireTag=""),t.onlyInNotesLinkingTo===void 0&&(t.onlyInNotesLinkingTo=!1)}catch(e){}}}Oe.exports={loadSettings:ds,saveSettings:us,setupSettingsWatcher:gs}});var oe=T((Po,We)=>{function ps(o,e){try{let t=o.vault.getMarkdownFiles(),n=null,s=e.endsWith(".md")?e.slice(0,-3):e;for(let i of t){if(i.basename.toLowerCase()===s.toLowerCase()){n=i;break}if((i.path.endsWith(".md")?i.path.slice(0,-3):i.path).toLowerCase()===s.toLowerCase()){n=i;break}}if(!n)return[];let a=o.metadataCache.getFileCache(n);if(!a||!a.frontmatter)return[];let l=a.frontmatter,r=[];return l.aliases&&(Array.isArray(l.aliases)?r=r.concat(l.aliases):typeof l.aliases=="string"&&r.push(l.aliases)),l.alias&&(Array.isArray(l.alias)?r=r.concat(l.alias):typeof l.alias=="string"&&r.push(l.alias)),r.filter(i=>i&&typeof i=="string"&&i.trim())}catch(t){return console.error("Error getting aliases for note:",e,t),[]}}function hs(o,e,t){try{if(!t||t.trim()==="")return!0;let n=t.trim().replace(/^#/,"").toLowerCase(),s=null,a=o.vault.getMarkdownFiles(),l=e.replace(/\.md$/,"");for(let i of a){if(i.basename.toLowerCase()===l.toLowerCase()){s=i;break}if((i.path.endsWith(".md")?i.path.slice(0,-3):i.path).toLowerCase()===l.toLowerCase()){s=i;break}}if(!s)return!1;let r=o.metadataCache.getFileCache(s);if(!r)return!1;if(r.frontmatter){let i=r.frontmatter,c=[];i.tags&&(Array.isArray(i.tags)?c=i.tags:typeof i.tags=="string"&&(c=[i.tags])),i.tag&&(Array.isArray(i.tag)?c=c.concat(i.tag):typeof i.tag=="string"&&c.push(i.tag));for(let u of c)if(typeof u=="string"&&u.replace(/^#/,"").toLowerCase()===n)return!0}if(r.tags){for(let i of r.tags)if(i.tag.replace(/^#/,"").toLowerCase()===n)return!0}return!1}catch(n){return console.error("Error checking tag for note:",e,n),!1}}function fs(o,e,t){try{if(!e)return!1;let n=o.metadataCache.getFileCache(e);if(!n||!n.links||n.links.length===0)return!1;let s=t.replace(/\.md$/,"").toLowerCase();for(let a of n.links){let l=a.link.toLowerCase();if(l===s||l.endsWith("/"+s)||s.endsWith("/"+l))return!0;let r=o.metadataCache.getFirstLinkpathDest(a.link,e.path);if(r){let i=r.basename.toLowerCase(),c=s.split("/").pop();if(i===c)return!0}}return!1}catch(n){return console.error("Error checking links in note:",e.path,n),!1}}async function ws(o,e,t){if(o.vault.getMarkdownFiles().find(i=>i.basename===t))return;let a=e.newNoteFolder||"",l=a?`${a}/${t}.md`:`${t}.md`,r=e.newNoteTemplate;r=r.replace(/{{keyword}}/g,t),r=r.replace(/{{date}}/g,new Date().toISOString().split("T")[0]),a&&(o.vault.getAbstractFileByPath(a)||await o.vault.createFolder(a)),await o.vault.create(l,r)}function ks(o,e){let t=o.vault.getMarkdownFiles(),n=e.endsWith(".md")?e.slice(0,-3):e;for(let s of t)if(s.basename.toLowerCase()===n.toLowerCase()||(s.path.endsWith(".md")?s.path.slice(0,-3):s.path).toLowerCase()===n.toLowerCase())return s;return null}We.exports={getAliasesForNote:ps,noteHasTag:hs,noteHasLinkToTarget:fs,ensureNoteExists:ws,findTargetFile:ks}});var de=T((Oo,je)=>{var{getAliasesForNote:ys}=oe();function Ge(o,e){let t={enableTags:!1,linkScope:"vault-wide",scopeFolder:"",useRelativeLinks:!1,blockRef:"",requireTag:"",onlyInNotesLinkingTo:!1,suggestMode:!1,preventSelfLink:!1};if(e.groupId){let n=o.keywordGroups.find(s=>s.id===e.groupId);return n&&n.settings&&Object.assign(t,n.settings),t}return e.enableTags!==null&&e.enableTags!==void 0&&(t.enableTags=e.enableTags),e.linkScope!==null&&e.linkScope!==void 0&&(t.linkScope=e.linkScope),e.scopeFolder!==null&&e.scopeFolder!==void 0&&(t.scopeFolder=e.scopeFolder),e.useRelativeLinks!==null&&e.useRelativeLinks!==void 0&&(t.useRelativeLinks=e.useRelativeLinks),e.blockRef!==null&&e.blockRef!==void 0&&(t.blockRef=e.blockRef),e.requireTag!==null&&e.requireTag!==void 0&&(t.requireTag=e.requireTag),e.onlyInNotesLinkingTo!==null&&e.onlyInNotesLinkingTo!==void 0&&(t.onlyInNotesLinkingTo=e.onlyInNotesLinkingTo),e.suggestMode!==null&&e.suggestMode!==void 0&&(t.suggestMode=e.suggestMode),e.preventSelfLink!==null&&e.preventSelfLink!==void 0&&(t.preventSelfLink=e.preventSelfLink),t}function ms(o,e){let t={},n=new Map,s=(a,l,r,i)=>{let c=a.toLowerCase();return n.has(c)?(console.warn(`Auto Keyword Linker: Skipping duplicate keyword "${a}" (already have "${n.get(c)}")`),!1):(n.set(c,a),t[a]={target:l,...r,keywordIndex:i},!0)};for(let a of e.keywords){if(!a.keyword||!a.keyword.trim()||!a.target||!a.target.trim())continue;let l=Ge(e,a),r=e.keywords.indexOf(a);if(s(a.keyword,a.target,l,r),a.variations&&a.variations.length>0)for(let c of a.variations)c.trim()&&s(c,a.target,l,r);let i=ys(o,a.target);if(i&&i.length>0)for(let c of i)c.trim()&&s(c,a.target,l,r)}return t}function vs(o,e,t,n,s,a){if(n==="vault-wide")return!0;let l=e.parent?e.parent.path:"";if(n==="same-folder"){let r=a(o,t);if(!r)return!1;let i=r.parent?r.parent.path:"";return l===i}if(n==="source-folder"){if(!s)return!0;let r=s.replace(/^\/+|\/+$/g,""),i=l.replace(/^\/+|\/+$/g,"");return i===r||i.startsWith(r+"/")}if(n==="target-folder"){if(!s)return!0;let r=a(o,t);if(!r)return!1;let i=r.parent?r.parent.path:"",c=s.replace(/^\/+|\/+$/g,""),u=i.replace(/^\/+|\/+$/g,"");return u===c||u.startsWith(c+"/")}return!0}je.exports={getEffectiveKeywordSettings:Ge,buildKeywordMap:ms,checkLinkScope:vs}});var Ue=T((zo,He)=>{var{DEFAULT_STOP_WORDS:Ss}=ce();function ue(o){let e=new Set(Ss);if(o.customStopWords&&Array.isArray(o.customStopWords))for(let t of o.customStopWords)t&&typeof t=="string"&&e.add(t.toLowerCase().trim());return e}function Y(o,e,t){let n=[],s=ue(t),a=o.split(/[\s\-_\/\\,;:]+/);for(let l of a){let r=l.split(/(?=[A-Z])/).filter(i=>i.length>0);for(let i of r){let c=i.trim().replace(/[^\w\s]/g,"").trim();c.length!==0&&(c=c.charAt(0).toUpperCase()+c.slice(1).toLowerCase(),c.length>=3&&!s.has(c.toLowerCase())&&n.push(c))}}return n}function X(o,e){let t=[],n=ue(e),s=o.split(/[.\n]/);for(let a of s){let l=a.match(/\b[A-Z][a-z]+(?:\s+[A-Z][a-z]+){1,3}\b/g);if(l)for(let r of l)r=r.trim(),r.split(/\s+/).some(u=>!n.has(u.toLowerCase()))&&r.length>=5&&t.push(r)}return t}async function bs(o,e,t){let n=o.vault.getMarkdownFiles(),s=new Map,a=new Map,l=new Set(e.keywords.map(i=>i.keyword.toLowerCase()));for(let i of e.keywords)if(i.variations&&i.variations.length>0)for(let c of i.variations)l.add(c.toLowerCase());for(let i of e.keywords){let c=t(i.target);if(c&&c.length>0)for(let u of c)l.add(u.toLowerCase())}for(let i of n){let c=Y(i.basename,!0,e),u=X(i.basename,e);for(let d of c)if(!l.has(d.toLowerCase())){s.has(d)||s.set(d,{count:0,notes:new Set});let g=s.get(d);g.count+=3,g.notes.add(i.basename)}for(let d of u)if(!l.has(d.toLowerCase())){a.has(d)||a.set(d,{count:0,notes:new Set});let g=a.get(d);g.count+=3,g.notes.add(i.basename)}try{let k=(await o.vault.read(i)).substring(0,5e3).replace(/^---[\s\S]*?---\n/,"");k=k.replace(/\[\[([^\]|]+)(?:\|[^\]]+)?\]\]/g,""),k=k.replace(/\[([^\]]+)\]\([^)]+\)/g,"");let h=Y(k,!1,e),p=X(k,e);for(let w of h)if(!l.has(w.toLowerCase())){s.has(w)||s.set(w,{count:0,notes:new Set});let f=s.get(w);f.count+=1,f.notes.add(i.basename)}for(let w of p)if(!l.has(w.toLowerCase())){a.has(w)||a.set(w,{count:0,notes:new Set});let f=a.get(w);f.count+=1,f.notes.add(i.basename)}}catch(d){console.log(`Error reading ${i.path}:`,d)}}let r=[];for(let[i,c]of s)r.push({keyword:i,count:c.count,notes:Array.from(c.notes).slice(0,5),totalNotes:c.notes.size});for(let[i,c]of a)r.push({keyword:i,count:c.count,notes:Array.from(c.notes).slice(0,5),totalNotes:c.notes.size});return r.sort((i,c)=>c.count!==i.count?c.count-i.count:c.keyword.length-i.keyword.length),r}async function Cs(o,e,t,n){let s=new Map,a=new Map,l=new Set(e.keywords.map(u=>u.keyword.toLowerCase()));for(let u of e.keywords)if(u.variations&&u.variations.length>0)for(let d of u.variations)l.add(d.toLowerCase());for(let u of e.keywords){let d=n(u.target);if(d&&d.length>0)for(let g of d)l.add(g.toLowerCase())}let r=Y(t.basename,!0,e),i=X(t.basename,e);for(let u of r)if(!l.has(u.toLowerCase())){s.has(u)||s.set(u,{count:0,notes:new Set});let d=s.get(u);d.count+=3,d.notes.add(t.basename)}for(let u of i)if(!l.has(u.toLowerCase())){a.has(u)||a.set(u,{count:0,notes:new Set});let d=a.get(u);d.count+=3,d.notes.add(t.basename)}try{let d=(await o.vault.read(t)).replace(/^---[\s\S]*?---\n/,"");d=d.replace(/\[\[([^\]|]+)(?:\|[^\]]+)?\]\]/g,""),d=d.replace(/\[([^\]]+)\]\([^)]+\)/g,"");let g=Y(d,!1,e),k=X(d,e);for(let h of g)if(!l.has(h.toLowerCase())){s.has(h)||s.set(h,{count:0,notes:new Set});let p=s.get(h);p.count+=1,p.notes.add(t.basename)}for(let h of k)if(!l.has(h.toLowerCase())){a.has(h)||a.set(h,{count:0,notes:new Set});let p=a.get(h);p.count+=1,p.notes.add(t.basename)}}catch(u){throw console.log(`Error reading ${t.path}:`,u),u}let c=[];for(let[u,d]of s)c.push({keyword:u,count:d.count,notes:Array.from(d.notes),totalNotes:d.notes.size});for(let[u,d]of a)c.push({keyword:u,count:d.count,notes:Array.from(d.notes),totalNotes:d.notes.size});return c.sort((u,d)=>d.count!==u.count?d.count-u.count:d.keyword.length-u.keyword.length),c}He.exports={getStopWords:ue,extractWordsFromText:Y,extractPhrasesFromText:X,analyzeNotesForKeywords:bs,analyzeCurrentNoteForKeywords:Cs}});var ge=T((Wo,_e)=>{function xs(o){if(!o.startsWith("---"))return null;let e=o.split(`
`),t=-1;for(let n=1;n<e.length;n++)if(e[n].trim()==="---"||e[n].trim()==="..."){t=n;break}if(t!==-1){let n=0;for(let s=0;s<=t;s++)n+=e[s].length+1;return{start:0,end:n}}return null}function Ls(o,e){let t=!1,n=!1;for(let s=e-1;s>=Math.max(0,e-500);s--){if(s>0&&o[s]==="]"&&o[s-1]==="]")return!1;if(o[s]==="|"&&!n&&(n=!0),s<o.length-1&&o[s]==="["&&o[s+1]==="["){t=!0;break}if(o[s]===`
`)return!1}if(t&&n)for(let s=e;s<Math.min(o.length,e+500);s++){if(s<o.length-1&&o[s]==="]"&&o[s+1]==="]")return!0;if(o[s]===`
`)break}return!1}function Ts(o,e,t){let n=Math.max(0,e-500),s=Math.min(o.length,e+t+500),a=o.substring(n,e),l=o.substring(e+t,s),r=o.substring(e,e+t),i=a+r+l,c=e-n,u=/(?:https?|ftp|ftps|sftp|file):\/\/[^\s\]]+/gi,d;for(;(d=u.exec(i))!==null;){let f=d.index,m=d.index+d[0].length;if(c>=f&&c<m)return!0}let g=/\bwww\.[a-zA-Z0-9][-a-zA-Z0-9]*(\.[a-zA-Z0-9][-a-zA-Z0-9]*)+[^\s\])"]*/gi;for(;(d=g.exec(i))!==null;){let f=d.index,m=d.index+d[0].length;if(c>=f&&c<m)return!0}let k=/\b[a-zA-Z0-9][-a-zA-Z0-9]*(\.[a-zA-Z0-9][-a-zA-Z0-9]*)*\.(com|org|net|edu|gov|mil|int|info|biz|name|museum|coop|aero|asia|cat|jobs|mobi|travel|xxx|pro|tel|post|co\.uk|co\.jp|co\.kr|co\.nz|co\.au|co\.za|co\.in|co\.id|co\.th|co\.il|ac\.uk|gov\.uk|org\.uk|de|fr|it|es|nl|be|ch|at|se|no|dk|fi|ie|pl|cz|hu|ro|bg|gr|pt|ru|ua|sk|si|hr|lt|lv|ee|cn|jp|kr|tw|hk|sg|my|th|vn|id|ph|in|pk|bd|lk|np|af|au|nz|fj|ca|mx|br|ar|cl|co|pe|ve|ec|uy|py|bo|cr|pa|gt|hn|ni|sv|cu|do|jm|tt|bs|bb|za|eg|ng|ke|gh|tz|ug|zw|ma|dz|tn|sn|ci|cm|ao|mz|na|bw|mw|zm|rw|so|sd|et|ly|iq|ir|sa|ae|kw|qa|om|ye|jo|lb|sy|il|ps|tr|am|az|ge|kz|uz|tm|tj|kg|mn|io|ai|sh|tv|me|cc|ws|to|ly|gl|gd|ms|vg|ag|lc|vc|dm|kn|gp|mq|aw|cw|sx|bq|tc|ky|bm|pr|vi)(?:\b|\/|:|\?|#|$)/gi;for(;(d=k.exec(i))!==null;){let f=d.index,m=d.index+d[0].length;if(c>=f&&c<m&&(f===0||/[\s\(\[\{<"']/.test(i[f-1])))return!0}if(/\.(com|org|net|edu|gov|io|ai|me|tv|co|uk|de|fr|it|jp|cn|au|ca|br|in|ru)\b/i.test(r))return!0;let p=o.substring(Math.max(0,e-100),e),w=o.substring(e+t,Math.min(o.length,e+t+100));return!!(/(?:https?|ftp|ftps):\/\/[^\s]*$/.test(p)||/www\.[^\s]*$/.test(p)||/^\.[a-zA-Z]{2,}(?:\.[a-zA-Z]{2,})?(?:\/|\?|#|:|\s|$)/.test(w))}function Es(o,e){let t=0,n=!1;for(let r=e-1;r>=Math.max(0,e-500);r--){if(r>0&&o[r]==="]"&&o[r-1]==="]"){t--,r--;continue}if(r<o.length-1&&o[r]==="["&&o[r+1]==="["){if(t++,t>0){n=!0;break}r--;continue}if(o[r]===`
`&&t===0)break}if(n)return!0;let s=0;for(let r=0;r<e;r++)o[r]==="`"&&s++;if(s%2===1)return!0;let a=0;for(let r=e-1;r>=Math.max(0,e-300);r--)if(o[r]===")")a--;else if(o[r]==="("){if(a++,a>0&&r>0&&o[r-1]==="]")return!0}else if(o[r]===`
`)break;let l=0;for(let r=e-1;r>=Math.max(0,e-300);r--)if(o[r]==="]")l--;else if(o[r]==="["){if(l++,l>0)for(let i=e;i<Math.min(o.length,e+300);i++){if(o[i]==="]"&&i<o.length-1&&o[i+1]==="(")return!0;if(o[i]===`
`)break}}else if(o[r]===`
`)break;return!1}function $s(o,e){let t=e;for(;t>0&&o[t-1]!==`
`;)t--;let n=e;for(;n<o.length&&o[n]!==`
`;)n++;let s=o.substring(t,n),a=e-t,l=s.lastIndexOf("^",a);if(l!==-1){let r=s.substring(l,a+1);if(/^\^[\w\-]*$/.test(r))return!0}return!1}function As(o,e){let t=0,n=0;for(;n<e;)n<o.length-1&&o[n]==="$"&&o[n+1]==="$"?(t++,n+=2):n++;if(t%2===1)return!0;let s=0;for(n=0;n<e;)o[n]==="$"?n<o.length-1&&o[n+1]==="$"?n+=2:(n>0&&o[n-1]==="$"||s++,n++):n++;return s%2===1}function Is(o,e){let t=e;for(;t>0&&o[t-1]!==`
`;)t--;let n=e;for(;n<o.length&&o[n]!==`
`;)n++;if(!o.substring(t,n).includes("|"))return!1;let a=t-1,l=10,r=0;for(;a>0&&r<l;){let c=a;for(;a>0&&o[a-1]!==`
`;)a--;let u=o.substring(a,c).trim();if(u.includes("|")&&u.includes("-")&&(u.replace(/\|/g,"").match(/-/g)||[]).length>=3)return!0;r++,a--}let i=n+1;for(r=0;i<o.length&&r<3;){let c=i;for(;i<o.length&&o[i]!==`
`;)i++;let u=o.substring(c,i).trim();if(u.includes("|")&&u.includes("-")&&(u.replace(/\|/g,"").match(/-/g)||[]).length>=3)return!0;r++,i++}return!1}_e.exports={getFrontmatterBounds:xs,isInsideAlias:Ls,isPartOfUrl:Ts,isInsideLinkOrCode:Es,isInsideBlockReference:$s,isInsideTable:Is,isInsideMath:As}});var he=T((Go,Je)=>{var{MarkdownView:Ns}=require("obsidian");function Ds(o){return o.replace(/\s+/g,"-").replace(/[^\w\-]/g,"").toLowerCase()}function pe(o,e){let t=o.match(/\n\n((?:#[\w\-]+\s*)+)$/),n=t?t[1].match(/#[\w\-]+/g).map(l=>l.substring(1)):[],s=e.filter(l=>!n.includes(l));if(s.length===0)return o;let a=s.map(l=>`#${l}`).join(" ");return n.length>0?o=o.replace(/\n\n((?:#[\w\-]+\s*)+)$/,`

$1 ${a}`):o=o.trimEnd()+`

${a}`,o}async function Ze(o,e,t){let s=o.vault.getMarkdownFiles().find(a=>a.basename===e);s&&await o.vault.process(s,a=>new RegExp(`#${t}\\b`).test(a)?a:pe(a,[t]))}async function Fs(o,e,t,n){if(t&&t.length>0){let s=o.workspace.getActiveViewOfType(Ns),l=s&&s.file.path===e.path?s.editor:null;if(l){let r=l.getValue();if(t.every(p=>new RegExp(`#${p}\\b`).test(r)))return;let c=r.match(/\n\n((?:#[\w\-]+\s*)+)$/),u=c?c[1].match(/#[\w\-]+/g).map(p=>p.substring(1)):[],d=t.filter(p=>!u.includes(p));if(d.length===0)return;let g=d.map(p=>`#${p}`).join(" "),k=l.lastLine(),h=l.getLine(k).length;if(u.length>0)for(let p=k;p>=Math.max(0,k-10);p--){let w=l.getLine(p);if(w.trim().match(/^#[\w\-]+(\s+#[\w\-]+)*$/)){l.replaceRange(` ${g}`,{line:p,ch:w.length});break}}else l.replaceRange(`

${g}`,{line:k,ch:h})}else await o.vault.process(e,r=>pe(r,t))}if(n&&n.size>0)for(let[s,a]of n)await Ze(o,s,a)}Je.exports={sanitizeTagName:Ds,addTagsToContent:pe,addTagToTargetNote:Ze,addTagsToFile:Fs}});var Ye=T((jo,Qe)=>{var{Notice:ee}=require("obsidian");async function Bs(o,e,t,n,s,a,l=!1){let r=o.workspace.getActiveFile();if(!r){new ee("No active file");return}let i=await t(r,l);l&&i?new a(o,i,r.basename).open():!l&&i&&i.changed?(new ee(`Linked ${i.linkCount} keyword(s) in current note!`),e.statistics.totalLinksCreated+=i.linkCount,e.statistics.totalNotesProcessed+=1,e.statistics.lastRunDate=new Date().toISOString(),await n(),setTimeout(()=>s(),100)):l||new ee("No keywords found to link")}async function Ks(o,e,t,n,s,a,l=!1){let r=o.vault.getMarkdownFiles(),i=0,c=0,u=[];for(let d of r){if(d.extension!=="md")continue;let g=await t(d,l);g&&g.changed&&(c++,i+=g.linkCount,l&&u.push({file:d,fileName:d.basename,...g}))}!l&&c>0&&(e.statistics.totalLinksCreated+=i,e.statistics.totalNotesProcessed+=c,e.statistics.lastRunDate=new Date().toISOString(),await n()),l&&u.length>0?new a(o,u,s).open():l?new ee("No keywords found to link in any notes"):new ee(`Linked ${i} keyword(s) in ${c} note(s)!`)}Qe.exports={linkKeywordsInCurrentNote:Bs,linkKeywordsInAllNotes:Ks}});var et=T((Ho,Xe)=>{var{Notice:H}=require("obsidian");async function Vs(o,e,t){new t(o,e).open()}async function Ms(o,e,t){let n=o.workspace.getActiveFile();if(!n){new H("No active note found. Please open a note first.");return}new t(o,e,n).open()}function Rs(o,e,t){let n=e.getValue(),s=[],a=n.split(`
`),l=/<span class="akl-suggested-link" data-target="([^"]*)" data-block="([^"]*)" data-use-relative="([^"]*)"[^>]*>([^<]+)<\/span>/g;if(a.forEach((r,i)=>{let c;for(l.lastIndex=0;(c=l.exec(r))!==null;)s.push({lineNumber:i,targetNote:c[1],blockRef:c[2],useRelative:c[3]==="true",matchText:c[4],fullMatch:c[0]})}),s.length===0){new H("No link suggestions found in current note");return}new t(o,e,s).open()}function qs(o,e,t){let n=o.getCursor(),s=o.getLine(n.line),a=/<span class="akl-suggested-link" data-target="([^"]*)" data-block="([^"]*)" data-use-relative="([^"]*)"[^>]*>([^<]+)<\/span>/g,l=[...s.matchAll(a)];if(l.length===0){new H("No link suggestions found on this line");return}let r=o.getValue(),i=o.posToOffset({line:n.line,ch:0}),c=e(r,i),u=0;l.forEach(d=>{let g=d[0],k=d[1],h=d[2],p=d[3]==="true",w=d[4],f,m=h?`${k}#${h}`:k;if(p){let A=c?w.replace(/\|/g,"\\|"):w,S=encodeURIComponent(k)+".md",E=h?`#${h}`:"";f=`[${A}](${S}${E})`}else c?f=k===w&&!h?`[[${w}]]`:`[[${m}\\|${w}]]`:f=k===w&&!h?`[[${w}]]`:`[[${m}|${w}]]`;s=s.replace(g,f),u++}),o.setLine(n.line,s),new H(`Accepted ${u} link suggestion${u>1?"s":""} on this line`),setTimeout(()=>t(),100)}function Ps(o,e,t){let n=o.getValue(),s=n,a=0,l=/<span class="akl-suggested-link" data-target="([^"]*)" data-block="([^"]*)" data-use-relative="([^"]*)"[^>]*>([^<]+)<\/span>/g;s=n.replace(l,(r,i,c,u,d,g)=>{a++;let k=e(n,g),h,p=c?`${i}#${c}`:i;if(u==="true"){let w=k?d.replace(/\|/g,"\\|"):d,f=encodeURIComponent(i)+".md",m=c?`#${c}`:"";h=`[${w}](${f}${m})`}else k?h=i===d&&!c?`[[${d}]]`:`[[${p}\\|${d}]]`:h=i===d&&!c?`[[${d}]]`:`[[${p}|${d}]]`;return h}),a>0?(o.setValue(s),new H(`Accepted ${a} link suggestion${a>1?"s":""}`),setTimeout(()=>t(),100)):new H("No link suggestions found in current note")}Xe.exports={suggestKeywords:Vs,suggestKeywordsFromCurrentNote:Ms,reviewSuggestions:Rs,acceptSuggestionAtCursor:qs,acceptAllSuggestions:Ps}});var st=T((Uo,tt)=>{var{Notice:U}=require("obsidian"),{escapeCSV:te}=z();async function Os(o,e){try{let t=JSON.stringify(e.keywords,null,2),s=`auto-keyword-linker-export-${new Date().toISOString().split("T")[0]}.json`;await o.vault.create(s,t),new U(`Keywords exported to ${s}`)}catch(t){new U(`Export failed: ${t.message}`)}}async function zs(o,e,t){new t(o,e).open()}async function Ws(o){try{let a=`keyword,target,variations,enableTags,linkScope,scopeFolder,useRelativeLinks,blockRef,requireTag,onlyInNotesLinkingTo,suggestMode,preventSelfLink
Python,Languages/Python,"python|py|Python3",false,vault-wide,,false,,,false,false
JavaScript,Languages/JavaScript,"js|javascript",false,vault-wide,,false,,,false,false
API,Documentation/API,"api|REST API",false,same-folder,,false,,reviewed,true,false
`,l="auto-keyword-linker-template.csv";await o.vault.create(l,a),new U(`CSV template downloaded: ${l}`)}catch(e){new U(`Template download failed: ${e.message}`)}}async function Gs(o,e){try{let n=["keyword,target,variations,enableTags,linkScope,scopeFolder,useRelativeLinks,blockRef,requireTag,onlyInNotesLinkingTo,suggestMode,preventSelfLink"];for(let c of e.keywords){let u=c.variations&&c.variations.length>0?`"${c.variations.join("|")}"`:"",d=[te(c.keyword),te(c.target),u,c.enableTags||!1,c.linkScope||"vault-wide",te(c.scopeFolder||""),c.useRelativeLinks||!1,te(c.blockRef||""),te(c.requireTag||""),c.onlyInNotesLinkingTo||!1,c.suggestMode||!1,c.preventSelfLink||!1].join(",");n.push(d)}let s=n.join(`
`),a=new Date,l=a.toISOString().split("T")[0],r=a.toTimeString().split(" ")[0].replace(/:/g,""),i=`auto-keyword-linker-export-${l}-${r}.csv`;await o.vault.create(i,s),new U(`Keywords exported to ${i}`)}catch(t){new U(`CSV export failed: ${t.message}`)}}async function js(o,e,t){new t(o,e).open()}tt.exports={exportKeywords:Os,importKeywords:zs,downloadCSVTemplate:Ws,exportKeywordsToCSV:Gs,importKeywordsFromCSV:js}});var ot=T((_o,nt)=>{function Hs(o,e,t){new t(o,e).open()}nt.exports={showStatistics:Hs}});var at=T((Zo,it)=>{var{Modal:Us}=require("obsidian"),fe=class extends Us{constructor(e,t){super(e),this.settings=t}onOpen(){let{contentEl:e}=this;e.createEl("h2",{text:"Auto Keyword Linker Statistics"});let t=this.settings.statistics;if(e.createEl("p",{text:`Total Links Created: ${t.totalLinksCreated||0}`}),e.createEl("p",{text:`Total Notes Processed: ${t.totalNotesProcessed||0}`}),e.createEl("p",{text:`Total Keywords Configured: ${this.settings.keywords.length}`}),t.lastRunDate){let a=new Date(t.lastRunDate);e.createEl("p",{text:`Last Run: ${a.toLocaleString()}`})}e.createEl("h3",{text:"Configured Keywords"});let n=e.createEl("ul");for(let a of this.settings.keywords){let l=n.createEl("li");l.appendText(`${a.keyword} \u2192 ${a.target}`),a.variations&&a.variations.length>0&&l.appendText(` (${a.variations.length} variations)`),a.enableTags&&l.appendText(" [Tags enabled]")}let s=e.createEl("button",{text:"Close"});s.style.marginTop="20px",s.addEventListener("click",()=>this.close())}onClose(){let{contentEl:e}=this;e.empty()}};it.exports=fe});var lt=T((Jo,rt)=>{var{Modal:_s,Notice:Zs}=require("obsidian"),we=class extends _s{constructor(e,t,n=null){super(e),this.plugin=t,this.currentFile=n,this.suggestions=[],this.selectedSuggestions=new Map,this.isAnalyzing=!0,this.searchQuery="",this.sortOrder="frequency-desc"}async onOpen(){let{contentEl:e}=this;e.addClass("akl-suggestion-modal");let t=this.currentFile?`Suggested Keyword Builder - ${this.currentFile.basename}`:"Suggested Keyword Builder";e.createEl("h2",{text:t});let n=e.createDiv({cls:"akl-status"}),s=this.currentFile?"Analyzing current note...":"Analyzing your notes...";n.createEl("p",{text:s,cls:"akl-analyzing"});try{this.currentFile?this.suggestions=await this.plugin.analyzeCurrentNoteForKeywords(this.currentFile):this.suggestions=await this.plugin.analyzeNotesForKeywords(),this.isAnalyzing=!1,n.empty();let a=this.currentFile?1:this.plugin.app.vault.getMarkdownFiles().length,l=a===1?"note":"notes";n.createEl("p",{text:`Found ${this.suggestions.length} suggestions from ${a} ${l}`,cls:"akl-stats"});for(let r of this.suggestions)this.selectedSuggestions.set(r.keyword,{selected:!1,addAsVariationTo:null});this.renderSuggestions(e)}catch(a){n.empty(),n.createEl("p",{text:`Error analyzing notes: ${a.message}`,cls:"akl-error"}),console.error("Error analyzing notes:",a)}}renderSuggestions(e){let t=e.createDiv({cls:"akl-controls-container"}),s=t.createDiv({cls:"akl-search-container"}).createEl("input",{type:"text",placeholder:"Search suggestions...",cls:"akl-search-input"});s.value=this.searchQuery,s.addEventListener("input",p=>{this.searchQuery=p.target.value,this.refreshSuggestionList()});let a=t.createDiv({cls:"akl-sort-container"}),l=a.createEl("label",{text:"Sort by: ",cls:"akl-sort-label"}),r=a.createEl("select",{cls:"akl-sort-select"}),i=[{value:"frequency-desc",label:"Most Common First"},{value:"frequency-asc",label:"Least Common First"},{value:"alpha-asc",label:"A to Z"},{value:"alpha-desc",label:"Z to A"},{value:"length-asc",label:"Shortest First"},{value:"length-desc",label:"Longest First"}];for(let p of i){let w=r.createEl("option",{value:p.value,text:p.label});p.value===this.sortOrder&&(w.selected=!0)}r.addEventListener("change",p=>{this.sortOrder=p.target.value,this.refreshSuggestionList()});let c=e.createDiv({cls:"akl-button-row"});c.createEl("button",{text:"Select All",cls:"akl-mini-button"}).addEventListener("click",()=>{for(let[p,w]of this.selectedSuggestions)this.matchesSearch(p)&&(w.selected=!0);this.refreshSuggestionList()}),c.createEl("button",{text:"Deselect All",cls:"akl-mini-button"}).addEventListener("click",()=>{for(let[p,w]of this.selectedSuggestions)this.matchesSearch(p)&&(w.selected=!1);this.refreshSuggestionList()}),this.suggestionsListEl=e.createDiv({cls:"akl-suggestions-list"}),this.refreshSuggestionList();let g=e.createDiv({cls:"akl-action-row"});g.createEl("button",{text:"Add Selected Keywords",cls:"mod-cta"}).addEventListener("click",()=>this.addSelectedKeywords()),g.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close())}matchesSearch(e){return this.searchQuery?e.toLowerCase().includes(this.searchQuery.toLowerCase()):!0}sortSuggestions(e){let t=[...e];switch(this.sortOrder){case"frequency-desc":t.sort((n,s)=>s.totalNotes-n.totalNotes);break;case"frequency-asc":t.sort((n,s)=>n.totalNotes-s.totalNotes);break;case"alpha-asc":t.sort((n,s)=>n.keyword.localeCompare(s.keyword));break;case"alpha-desc":t.sort((n,s)=>s.keyword.localeCompare(n.keyword));break;case"length-asc":t.sort((n,s)=>n.keyword.length-s.keyword.length);break;case"length-desc":t.sort((n,s)=>s.keyword.length-n.keyword.length);break;default:t.sort((n,s)=>s.totalNotes-n.totalNotes)}return t}refreshSuggestionList(){if(!this.suggestionsListEl)return;this.suggestionsListEl.empty();let e=this.suggestions.filter(t=>this.matchesSearch(t.keyword));if(e.length===0){this.suggestionsListEl.createEl("p",{text:"No suggestions match your search.",cls:"akl-no-results"});return}e=this.sortSuggestions(e);for(let t of e){let n=this.selectedSuggestions.get(t.keyword),s=this.suggestionsListEl.createDiv({cls:"akl-suggestion-item"}),a=s.createDiv({cls:"akl-suggestion-header"}),l=a.createEl("input",{type:"checkbox",cls:"akl-checkbox"});l.checked=n.selected,l.addEventListener("change",d=>{n.selected=d.target.checked});let r=a.createDiv({cls:"akl-suggestion-label"});if(r.createSpan({text:t.keyword,cls:"akl-keyword-text"}),r.createSpan({text:` (${t.totalNotes} notes)`,cls:"akl-count-text"}),t.notes.length>0){let d=s.createDiv({cls:"akl-notes-preview"});d.createEl("span",{text:"In: ",cls:"akl-notes-label"}),d.createEl("span",{text:t.notes.join(", ")+(t.totalNotes>5?"...":""),cls:"akl-notes-list"})}let i=s.createDiv({cls:"akl-variation-selector"});i.createEl("span",{text:"Or add as variation to: ",cls:"akl-variation-label"});let c=i.createEl("select",{cls:"akl-variation-dropdown"}),u=c.createEl("option",{value:"",text:"(None - add as new keyword)"});for(let d of this.plugin.settings.keywords)d.keyword.toLowerCase()!==t.keyword.toLowerCase()&&c.createEl("option",{value:d.keyword,text:d.keyword});c.value=n.addAsVariationTo||"",c.addEventListener("change",d=>{n.addAsVariationTo=d.target.value||null,d.target.value&&(l.checked=!0,n.selected=!0)})}}async addSelectedKeywords(){let e=0,t=0;for(let[s,a]of this.selectedSuggestions)if(a.selected)if(a.addAsVariationTo){let l=this.plugin.settings.keywords.find(r=>r.keyword===a.addAsVariationTo);l&&(l.variations||(l.variations=[]),l.variations.includes(s)||(l.variations.push(s),t++))}else this.plugin.settings.keywords.push({keyword:s,target:s,variations:[],enableTags:!1,linkScope:"vault-wide",scopeFolder:""}),e++;await this.plugin.saveSettings();let n="";e>0&&t>0?n=`Added ${e} new keyword(s) and ${t} variation(s)`:e>0?n=`Added ${e} new keyword(s)`:t>0?n=`Added ${t} variation(s)`:n="No keywords selected",new Zs(n),this.close()}onClose(){let{contentEl:e}=this;e.empty()}};rt.exports=we});var dt=T((Qo,ct)=>{var{Modal:Js,Notice:ke}=require("obsidian"),ye=class extends Js{constructor(e,t){super(e),this.plugin=t}onOpen(){let{contentEl:e}=this;e.createEl("h2",{text:"Import Keywords from JSON"}),e.createEl("p",{text:"Select a JSON file from your vault to import keywords. This will ADD to your existing keywords."});let t=this.app.vault.getFiles().filter(r=>r.extension==="json");if(t.length===0){e.createEl("p",{text:"No JSON files found in vault. Please create an export first.",cls:"mod-warning"}),e.createEl("button",{text:"Close"}).addEventListener("click",()=>this.close());return}let n=e.createEl("select");n.style.width="100%",n.style.marginBottom="10px";for(let r of t){let i=n.createEl("option",{text:r.path,value:r.path})}let s=e.createDiv();s.style.display="flex",s.style.gap="10px",s.style.marginTop="20px",s.createEl("button",{text:"Import",cls:"mod-cta"}).addEventListener("click",async()=>{let r=n.value,i=this.app.vault.getAbstractFileByPath(r);if(i)try{let c=await this.app.vault.read(i),u=JSON.parse(c);if(!Array.isArray(u)){new ke("Invalid JSON format: expected an array of keywords");return}let d=0,g=0;for(let h of u){h.enableTags===void 0&&(h.enableTags=!1);let p=this.plugin.settings.keywords.findIndex(w=>w.keyword.toLowerCase()===h.keyword.toLowerCase());if(p!==-1){let w=this.plugin.settings.keywords[p];w.variations||(w.variations=[]),h.variations||(h.variations=[]);let f=w.variations.map(A=>A.toLowerCase()),m=h.variations.filter(A=>!f.includes(A.toLowerCase()));m.length>0&&(w.variations.push(...m),g++)}else this.plugin.settings.keywords.push(h),d++}await this.plugin.saveSettings();let k="";d>0&&g>0?k=`Imported: ${d} new keyword(s), merged variations into ${g} existing keyword(s)`:d>0?k=`Imported ${d} new keyword(s)`:g>0?k=`Merged variations into ${g} existing keyword(s)`:k="No new keywords or variations to import",new ke(k),this.close(),this.app.setting.close(),this.app.setting.open(),this.app.setting.openTabById(this.plugin.manifest.id)}catch(c){new ke(`Import failed: ${c.message}`)}}),s.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close())}onClose(){let{contentEl:e}=this;e.empty()}};ct.exports=ye});var pt=T((Yo,gt)=>{var{Modal:Qs,Notice:ie}=require("obsidian"),{parseCSVLine:ut}=z(),me=class extends Qs{constructor(e,t){super(e),this.plugin=t}onOpen(){let{contentEl:e}=this;e.createEl("h2",{text:"Import Keywords from CSV"}),e.createEl("p",{text:"Select a CSV file from your vault to import keywords. This will ADD to your existing keywords."});let t=this.app.vault.getFiles().filter(r=>r.extension==="csv");if(t.length===0){e.createEl("p",{text:"No CSV files found in vault. Download a template first or export existing keywords.",cls:"mod-warning"}),e.createEl("button",{text:"Close"}).addEventListener("click",()=>this.close());return}let n=e.createEl("select");n.style.width="100%",n.style.marginBottom="10px";for(let r of t){let i=n.createEl("option",{text:r.path,value:r.path})}let s=e.createDiv();s.style.display="flex",s.style.gap="10px",s.style.marginTop="20px",s.createEl("button",{text:"Import",cls:"mod-cta"}).addEventListener("click",async()=>{let r=n.value,i=this.app.vault.getAbstractFileByPath(r);if(i)try{let u=(await this.app.vault.read(i)).split(`
`).filter(m=>m.trim());if(u.length===0){new ie("CSV file is empty");return}let d=ut(u[0]),g={};if(d.forEach((m,A)=>{g[m.toLowerCase()]=A}),g.keyword===void 0||g.target===void 0){new ie('CSV must have "keyword" and "target" columns');return}let k=0,h=0,p=0,w=[];for(let m=1;m<u.length;m++){let A=m+1;try{let S=ut(u[m]);if(S.length===0||!S[g.keyword])continue;let E=S[g.keyword]||"",x=S[g.target]||"";if(!E.trim()||!x.trim()){w.push(`Line ${A}: Missing keyword or target`),p++;continue}let L=S[g.variations]||"",F=L?L.split("|").map(I=>I.trim()).filter(I=>I):[],B=I=>{if(typeof I=="boolean")return I;let q=String(I).toLowerCase().trim();return q==="true"||q==="yes"||q==="1"},K={keyword:E.trim(),target:x.trim(),variations:F,enableTags:B(S[g.enabletags]||!1),linkScope:S[g.linkscope]||"vault-wide",scopeFolder:S[g.scopefolder]||"",useRelativeLinks:B(S[g.userelativelinks]||!1),blockRef:S[g.blockref]||"",requireTag:S[g.requiretag]||"",onlyInNotesLinkingTo:B(S[g.onlyinnoteslinkingto]||!1),suggestMode:B(S[g.suggestmode]||!1),preventSelfLink:B(S[g.preventselflink]||!1)},M=this.plugin.settings.keywords.findIndex(I=>I.keyword.toLowerCase()===K.keyword.toLowerCase());if(M!==-1){let I=this.plugin.settings.keywords[M],q=!1,P=["target","enableTags","linkScope","scopeFolder","useRelativeLinks","blockRef","requireTag","onlyInNotesLinkingTo","suggestMode","preventSelfLink"];for(let V of P)I[V]!==K[V]&&(I[V]=K[V],q=!0);let G=new Set(I.variations.map(V=>V.toLowerCase()));for(let V of K.variations)G.has(V.toLowerCase())||(I.variations.push(V),q=!0);q&&h++}else this.plugin.settings.keywords.push(K),k++}catch(S){w.push(`Line ${A}: ${S.message}`),p++}}await this.plugin.saveSettings();let f="";k>0&&h>0?f=`Added ${k} new keyword(s), updated ${h} existing keyword(s)`:k>0?f=`Added ${k} new keyword(s)`:h>0?f=`Updated ${h} existing keyword(s)`:f="No changes to import",p>0&&(f+=`
${p} error(s) encountered`,console.error("CSV Import Errors:",w)),new ie(f),this.close(),this.app.setting.close(),this.app.setting.open(),this.app.setting.openTabById(this.plugin.manifest.id)}catch(c){new ie(`Import failed: ${c.message}`),console.error("CSV Import Error:",c)}}),s.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close())}onClose(){let{contentEl:e}=this;e.empty()}};gt.exports=me});var ft=T((Xo,ht)=>{var{Modal:Ys}=require("obsidian"),ve=class extends Ys{constructor(e,t,n){super(e),this.results=t,this.fileName=n}onOpen(){let{contentEl:e}=this;e.createEl("h2",{text:`Preview: ${this.fileName}`}),e.createEl("p",{text:`Found ${this.results.linkCount} keyword(s) to link:`});let t=e.createEl("ul");for(let a of this.results.changes){let l=t.createEl("li");l.createEl("strong",{text:a.keyword}),l.appendText(" \u2192 "),l.createEl("code",{text:`[[${a.target}]]`}),l.createEl("br"),l.createEl("small",{text:a.context,cls:"preview-context"})}let n=e.createDiv({cls:"modal-button-container"});n.style.marginTop="20px",n.style.display="flex",n.style.gap="10px",n.createEl("button",{text:"Close"}).addEventListener("click",()=>this.close())}onClose(){let{contentEl:e}=this;e.empty()}};ht.exports=ve});var yt=T((ei,kt)=>{var{Modal:Xs,Notice:wt,MarkdownView:en}=require("obsidian"),Se=class extends Xs{constructor(e,t,n){super(e),this.editor=t,this.suggestions=n,this.selectedSuggestions=new Set(n.map((s,a)=>a))}onOpen(){let{contentEl:e}=this;e.empty(),e.addClass("akl-suggestion-review-modal"),e.createEl("h2",{text:"Review Link Suggestions"});let t=e.createEl("p",{text:`Found ${this.suggestions.length} link suggestion${this.suggestions.length>1?"s":""} in this note. Select which ones to accept:`});t.style.marginBottom="1em",t.style.color="var(--text-muted)";let n=e.createDiv({cls:"akl-button-container"});n.style.marginBottom="1em",n.style.display="flex",n.style.gap="0.5em",n.createEl("button",{text:"Select All"}).addEventListener("click",()=>{this.suggestions.forEach((d,g)=>{this.selectedSuggestions.add(g);let k=e.querySelector(`input[data-index="${g}"]`);k&&(k.checked=!0)})}),n.createEl("button",{text:"Deselect All"}).addEventListener("click",()=>{this.selectedSuggestions.clear(),e.querySelectorAll('input[type="checkbox"]').forEach(d=>d.checked=!1)});let l=e.createDiv({cls:"akl-suggestions-list"});l.style.maxHeight="400px",l.style.overflowY="auto",l.style.marginBottom="1em",l.style.border="1px solid var(--background-modifier-border)",l.style.borderRadius="6px",l.style.padding="0.5em",this.suggestions.forEach((d,g)=>{let k=l.createDiv({cls:"akl-suggestion-item"});k.style.padding="0.75em",k.style.marginBottom="0.5em",k.style.background="var(--background-secondary)",k.style.borderRadius="6px",k.style.display="flex",k.style.alignItems="center",k.style.gap="0.75em";let h=k.createEl("input",{type:"checkbox"});h.checked=!0,h.setAttribute("data-index",g.toString()),h.addEventListener("change",S=>{S.target.checked?this.selectedSuggestions.add(g):this.selectedSuggestions.delete(g)});let p=k.createDiv({cls:"akl-suggestion-content"});p.style.flex="1";let w=p.createDiv();w.style.marginBottom="0.25em",w.createSpan({text:d.matchText,cls:"akl-keyword-highlight"}),w.createSpan({text:" \u2192 ",cls:"akl-arrow"}),w.createSpan({text:d.targetNote,cls:"akl-target-highlight"});let f=p.createDiv();f.style.fontSize="0.9em",f.style.color="var(--text-muted)",f.createSpan({text:`Line ${d.lineNumber+1}`}),w.querySelectorAll(".akl-keyword-highlight").forEach(S=>{S.style.background="rgba(255, 170, 0, 0.25)",S.style.padding="2px 4px",S.style.borderRadius="3px",S.style.fontWeight="500"}),w.querySelectorAll(".akl-target-highlight").forEach(S=>{S.style.color="var(--text-accent)",S.style.fontWeight="500"})});let r=e.createDiv({cls:"akl-action-buttons"});r.style.display="flex",r.style.gap="0.5em",r.style.justifyContent="flex-end",r.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close());let c=r.createEl("button",{text:`Accept Selected (${this.selectedSuggestions.size})`,cls:"mod-cta"});c.addEventListener("click",()=>{this.acceptSelected()});let u=()=>{c.textContent=`Accept Selected (${this.selectedSuggestions.size})`};e.querySelectorAll('input[type="checkbox"]').forEach(d=>{d.addEventListener("change",u)})}acceptSelected(){if(this.selectedSuggestions.size===0){new wt("No suggestions selected");return}let e=Array.from(this.selectedSuggestions).sort((n,s)=>this.suggestions[s].lineNumber-this.suggestions[n].lineNumber),t=0;e.forEach(n=>{let s=this.suggestions[n],a=this.editor.getLine(s.lineNumber);if(!a.includes(s.fullMatch))return;let l=this.editor.getValue(),r=this.editor.posToOffset({line:s.lineNumber,ch:0}),i=this.app.plugins.plugins["auto-keyword-linker"],c=i?i.isInsideTable(l,r):!1,u,d=s.blockRef?`${s.targetNote}#${s.blockRef}`:s.targetNote;if(s.useRelative){let k=c?s.matchText.replace(/\|/g,"\\|"):s.matchText,h=encodeURIComponent(s.targetNote)+".md",p=s.blockRef?`#${s.blockRef}`:"";u=`[${k}](${h}${p})`}else c?u=s.targetNote===s.matchText&&!s.blockRef?`[[${s.matchText}]]`:`[[${d}\\|${s.matchText}]]`:u=s.targetNote===s.matchText&&!s.blockRef?`[[${s.matchText}]]`:`[[${d}|${s.matchText}]]`;let g=a.replace(s.fullMatch,u);this.editor.setLine(s.lineNumber,g),t++}),new wt(`Accepted ${t} link suggestion${t>1?"s":""}`),this.close(),setTimeout(()=>{let n=this.app.workspace.getActiveViewOfType(en);if(n&&n.editor){let s=this.app.plugins.plugins["auto-keyword-linker"];s&&s.updateStatusBar&&s.updateStatusBar()}},100)}onClose(){let{contentEl:e}=this;e.empty()}};kt.exports=Se});var vt=T((ti,mt)=>{var{Modal:tn,Notice:be}=require("obsidian"),Ce=class extends tn{constructor(e,t,n){super(e),this.results=t,this.plugin=n,this.selectedLinks=new Map,this.results.forEach((s,a)=>{let l=new Set(s.changes.map((r,i)=>i));this.selectedLinks.set(a,l)})}onOpen(){let{contentEl:e}=this;e.createEl("h2",{text:"Preview: Select Links to Create"});let t=this.results.reduce((h,p)=>h+p.linkCount,0),n=this.getSelectedLinksCount(),s=`Found ${t} link(s) in ${this.results.length} note(s). ${n} link(s) selected.`,a=e.createEl("p",{text:s,cls:"bulk-preview-stats"}),l=e.createDiv({cls:"bulk-preview-select-buttons"});l.style.marginBottom="15px",l.style.display="flex",l.style.gap="10px",l.createEl("button",{text:"Select All Links"}).addEventListener("click",()=>{this.results.forEach((h,p)=>{let w=new Set(h.changes.map((f,m)=>m));this.selectedLinks.set(p,w)}),e.querySelectorAll('input[type="checkbox"]').forEach(h=>h.checked=!0),this.updateStats(a)}),l.createEl("button",{text:"Deselect All Links"}).addEventListener("click",()=>{this.selectedLinks.clear(),e.querySelectorAll('input[type="checkbox"]').forEach(h=>h.checked=!1),this.updateStats(a)});let c=e.createDiv({cls:"preview-scroll"});c.style.maxHeight="400px",c.style.overflowY="auto",c.style.marginBottom="20px",c.style.border="1px solid var(--background-modifier-border)",c.style.borderRadius="6px",c.style.padding="10px",this.results.forEach((h,p)=>{let w=c.createDiv({cls:"preview-note"});w.style.marginBottom="15px",w.style.padding="10px",w.style.background="var(--background-secondary)",w.style.borderRadius="6px";let f=w.createDiv();f.style.display="flex",f.style.alignItems="center",f.style.gap="10px",f.style.marginBottom="10px";let m=f.createEl("input",{type:"checkbox"});m.checked=!0,m.setAttribute("data-note-index",p.toString()),m.addEventListener("change",E=>{let x=E.target.checked,L=this.selectedLinks.get(p)||new Set;x?(h.changes.forEach((F,B)=>L.add(B)),this.selectedLinks.set(p,L),e.querySelectorAll(`input[data-note="${p}"]`).forEach(F=>F.checked=!0)):(this.selectedLinks.delete(p),e.querySelectorAll(`input[data-note="${p}"]`).forEach(F=>F.checked=!1)),this.updateStats(a)});let A=f.createDiv();A.style.flex="1",A.createEl("strong",{text:h.fileName}),A.createEl("span",{text:` (${h.linkCount} link${h.linkCount!==1?"s":""})`,cls:"bulk-preview-link-count"});let S=w.createDiv();S.style.marginLeft="30px",h.changes.forEach((E,x)=>{let L=S.createDiv();L.style.display="flex",L.style.alignItems="flex-start",L.style.gap="8px",L.style.marginBottom="8px",L.style.padding="4px",L.style.borderRadius="4px",L.style.transition="background 0.2s",L.addEventListener("mouseenter",()=>{L.style.background="var(--background-modifier-hover)"}),L.addEventListener("mouseleave",()=>{L.style.background="transparent"});let F=L.createEl("input",{type:"checkbox"});F.checked=!0,F.setAttribute("data-note",p.toString()),F.setAttribute("data-link",x.toString()),F.style.marginTop="2px",F.addEventListener("change",M=>{let I=this.selectedLinks.get(p)||new Set;M.target.checked?I.add(x):I.delete(x),I.size===0?this.selectedLinks.delete(p):this.selectedLinks.set(p,I);let q=h.changes.every((P,G)=>{let V=this.selectedLinks.get(p);return V&&V.has(G)});m.checked=q,this.updateStats(a)});let B=L.createDiv();B.style.flex="1",B.style.fontSize="0.9em";let K=B.createDiv();if(K.createEl("strong",{text:E.keyword}),K.appendText(" \u2192 "),K.createEl("code",{text:`[[${E.target}]]`}),E.lineNumber!==void 0){let M=B.createDiv();M.style.fontSize="0.85em",M.style.color="var(--text-muted)",M.style.marginTop="2px",M.textContent=`Line ${E.lineNumber+1}`}})});let u=e.createDiv({cls:"modal-button-container"});u.style.display="flex",u.style.gap="10px",u.style.justifyContent="flex-end",u.style.marginTop="20px",u.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close());let g=this.getSelectedLinksCount(),k=u.createEl("button",{text:`Apply Selected Links (${g})`,cls:"mod-cta"});k.addEventListener("click",async()=>{await this.applySelected()}),this.applyBtn=k}updateStats(e){let t=this.results.reduce((s,a)=>s+a.linkCount,0),n=this.getSelectedLinksCount();e.textContent=`Found ${t} link(s) in ${this.results.length} note(s). ${n} link(s) selected.`,this.applyBtn&&(this.applyBtn.textContent=`Apply Selected Links (${n})`)}getSelectedLinksCount(){let e=0;for(let t of this.selectedLinks.values())e+=t.size;return e}async applySelected(){if(this.selectedLinks.size===0){new be("No links selected");return}this.close();let e=this.getSelectedLinksCount();new be(`Creating ${e} link(s)...`);let t=0,n=0;for(let[s,a]of this.selectedLinks){if(a.size===0)continue;let l=this.results[s];if(!l||!l.file)continue;let r=l.file,i=l.changes.filter((d,g)=>a.has(g)),c=new Set(i.map(d=>d.keyword.toLowerCase())),u=this.plugin.buildKeywordMap.bind(this.plugin);this.plugin.buildKeywordMap=()=>{let d=u(),g={};for(let[k,h]of Object.entries(d))c.has(k.toLowerCase())&&(g[k]=h);return g};try{let d=await this.plugin.linkKeywordsInFile(r,!1);d&&d.changed&&(t+=d.linkCount,n++)}finally{this.plugin.buildKeywordMap=u}}this.plugin.settings.statistics.totalLinksCreated+=t,this.plugin.settings.statistics.totalNotesProcessed+=n,this.plugin.settings.statistics.lastRunDate=new Date().toISOString(),await this.plugin.saveSettings(),new be(`\u2713 Processed ${n} note(s), created ${t} link(s)`)}onClose(){let{contentEl:e}=this;e.empty()}};mt.exports=Ce});var Le=T((si,St)=>{var{FuzzySuggestModal:sn,Notice:nn}=require("obsidian"),xe=class extends sn{constructor(e,t,n,s){super(e),this.plugin=t,this.groupId=n,this.currentKeywordIds=new Set(s.map(a=>a.id))}getItems(){return this.plugin.settings.keywords.filter(e=>!this.currentKeywordIds.has(e.id))}getItemText(e){let t=e.groupId?" [In another group]":"";return`${e.keyword||"Untitled"} \u2192 ${e.target||"(no target)"}${t}`}async onChooseItem(e){e.groupId=this.groupId,e.enableTags=null,e.linkScope=null,e.scopeFolder=null,e.useRelativeLinks=null,e.blockRef=null,e.requireTag=null,e.onlyInNotesLinkingTo=null,e.suggestMode=null,e.preventSelfLink=null,await this.plugin.saveSettings(),new nn(`Keyword "${e.keyword}" assigned to group. Group settings will apply to new links.`);let t=this.app.setting.activeTab,n=Te();t instanceof n&&t.display()}};St.exports=xe});var Ct=T((ni,bt)=>{var{AbstractInputSuggest:on}=require("obsidian"),Ee=class extends on{constructor(e,t,n){super(e,t),this.inputEl=t,this.folders=n}getSuggestions(e){let t=e.toLowerCase();return this.folders.filter(s=>(s||"/ (Root)").toLowerCase().includes(t)).sort((s,a)=>{let l=(s||"/ (Root)").toLowerCase(),r=(a||"/ (Root)").toLowerCase(),i=l.startsWith(t),c=r.startsWith(t);return i&&!c?-1:!i&&c?1:l.localeCompare(r)})}renderSuggestion(e,t){t.setText(e||"/ (Root)")}selectSuggestion(e,t){this.inputEl&&(this.inputEl.value=e||"",this.inputEl.trigger("input")),this.close()}};bt.exports=Ee});var Ae=T((oi,xt)=>{var{AbstractInputSuggest:an}=require("obsidian"),$e=class extends an{constructor(e,t,n){super(e,t),this.inputEl=t,this.notes=n}getSuggestions(e){let t=e.toLowerCase();return this.notes.filter(s=>s.toLowerCase().includes(t)).sort((s,a)=>{let l=s.toLowerCase(),r=a.toLowerCase(),i=l.startsWith(t),c=r.startsWith(t);return i&&!c?-1:!i&&c?1:l.localeCompare(r)})}renderSuggestion(e,t){t.setText(e)}selectSuggestion(e,t){this.inputEl&&(this.inputEl.value=e,this.inputEl.trigger("input")),this.close()}};xt.exports=$e});var Te=T((ii,$t)=>{var{PluginSettingTab:rn,Setting:C,Notice:ae,normalizePath:Lt}=require("obsidian"),ln=Le(),Tt=Ct(),cn=Ae(),{generateId:Et}=z(),Ie=class extends rn{constructor(e,t){super(e,t),this.plugin=t,this.searchFilter="",this.currentTab="keywords"}isDuplicateKeyword(e,t=null){if(!e||!e.trim())return null;let n=e.toLowerCase().trim();for(let s of this.plugin.settings.keywords)if(!(t&&s.id===t)&&(s.keyword&&s.keyword.toLowerCase().trim()===n||s.variations&&s.variations.some(a=>a.toLowerCase().trim()===n)))return s;return null}display(){let{containerEl:e}=this;e.empty(),this.addCustomStyles(),this.plugin.scrollToKeywordId&&(this.currentTab="keywords");let t=e.createDiv({cls:"akl-tab-nav"});[{id:"keywords",label:"Keywords",icon:"\u{1F524}"},{id:"groups",label:"Groups",icon:"\u{1F4C1}"},{id:"general",label:"General",icon:"\u2699\uFE0F"},{id:"import-export",label:"Import/export",icon:"\u{1F4E6}"}].forEach(a=>{t.createEl("button",{text:`${a.icon} ${a.label}`,cls:`akl-tab-button ${this.currentTab===a.id?"akl-tab-active":""}`}).addEventListener("click",()=>{this.currentTab=a.id,this.display()})});let s=e.createDiv({cls:"akl-tab-content"});switch(this.currentTab){case"keywords":this.displayKeywordsTab(s);break;case"groups":this.displayGroupsTab(s);break;case"general":this.displayGeneralTab(s);break;case"import-export":this.displayImportExportTab(s);break}}displayKeywordsTab(e){e.createDiv({cls:"akl-stats-bar"}).createEl("span",{text:`${this.plugin.settings.keywords.length} keyword${this.plugin.settings.keywords.length!==1?"s":""} configured`}),new C(e).setName("Keywords & variations").setDesc("Define keywords and their variations. All variations will link to the target note.").setHeading();let n=e.createDiv({cls:"akl-controls-row"});n.createDiv({cls:"akl-search-container"}).createEl("input",{type:"text",placeholder:"Search keywords...",cls:"akl-search-input",value:this.searchFilter}).addEventListener("input",g=>{this.searchFilter=g.target.value,this.renderKeywords(c)});let l=n.createDiv({cls:"akl-fold-btn-container"}),r=this.plugin.settings.keywords.every(g=>g.collapsed!==!1);l.createEl("button",{text:r?"\u25BC Unfold All":"\u25B2 Fold All",cls:"akl-fold-button"}).addEventListener("click",async()=>{let g=!r;for(let k of this.plugin.settings.keywords)k.collapsed=g;await this.plugin.saveSettings(),this.display()});let c=e.createDiv({cls:"akl-keywords-container"});this.renderKeywords(c),e.createDiv({cls:"akl-add-button-container"}).createEl("button",{text:"+ Add keyword",cls:"mod-cta akl-add-button"}).addEventListener("click",()=>{this.plugin.settings.keywords.push({id:Et("kw"),keyword:"",target:"",variations:[],enableTags:null,linkScope:"vault-wide",scopeFolder:"",useRelativeLinks:null,blockRef:"",requireTag:"",onlyInNotesLinkingTo:null,suggestMode:null,preventSelfLink:null,collapsed:!1,groupId:null}),this.display()})}updateCardHeader(e,t,n){e.empty();let s=t||"New Keyword",a=n?` \u2192 ${n}`:"";e.createSpan({text:s,cls:"akl-keyword-name"}),a&&e.createSpan({text:a,cls:"akl-target-name"})}displayGroupsTab(e){let t=e.createDiv({cls:"akl-stats-bar"}),n=this.plugin.settings.keywordGroups.reduce((r,i)=>r+this.plugin.settings.keywords.filter(c=>c.groupId===i.id).length,0);t.createEl("span",{text:`${this.plugin.settings.keywordGroups.length} group${this.plugin.settings.keywordGroups.length!==1?"s":""} \u2022 ${n} keyword${n!==1?"s":""} in groups`}),new C(e).setName("Keyword groups").setDesc("Organize keywords into groups with shared settings. Keywords in a group use the group's settings.").setHeading();let s=e.createDiv({cls:"akl-groups-container"});this.renderGroups(s),e.createDiv({cls:"akl-add-button-container"}).createEl("button",{text:"+ Create group",cls:"mod-cta akl-add-button"}).addEventListener("click",()=>{this.plugin.settings.keywordGroups.push({id:Et("grp"),name:"New group",collapsed:!1,settings:{enableTags:!1,linkScope:"vault-wide",scopeFolder:"",useRelativeLinks:!1,blockRef:"",requireTag:"",onlyInNotesLinkingTo:!1,suggestMode:!1,preventSelfLink:!1}}),this.display()})}displayGeneralTab(e){new C(e).setName("Linking behavior").setDesc("Configure how keywords are linked in your notes.").setHeading(),new C(e).setName("First occurrence only").setDesc("Link only the first mention of each keyword per note").addToggle(s=>s.setValue(this.plugin.settings.firstOccurrenceOnly).onChange(async a=>{this.plugin.settings.firstOccurrenceOnly=a,await this.plugin.saveSettings()})),new C(e).setName("Case sensitive").setDesc("Match keywords with exact case").addToggle(s=>s.setValue(this.plugin.settings.caseSensitive).onChange(async a=>{this.plugin.settings.caseSensitive=a,await this.plugin.saveSettings()})),new C(e).setName("Prevent self-links (global)").setDesc("Prevent keywords from linking on their own target note (applies to all keywords unless overridden per-keyword)").addToggle(s=>s.setValue(this.plugin.settings.preventSelfLinkGlobal).onChange(async a=>{this.plugin.settings.preventSelfLinkGlobal=a,await this.plugin.saveSettings()})),new C(e).setName("Auto-link on save").setDesc("Automatically link keywords when you save a note (requires reload)").addToggle(s=>s.setValue(this.plugin.settings.autoLinkOnSave).onChange(async a=>{this.plugin.settings.autoLinkOnSave=a,await this.plugin.saveSettings(),new ae("Please reload the plugin for this change to take effect")})),new C(e).setName("Note creation").setDesc("Configure how new notes are created when target notes don't exist.").setHeading(),new C(e).setName("Auto-create notes").setDesc("Automatically create target notes if they don't exist").addToggle(s=>s.setValue(this.plugin.settings.autoCreateNotes).onChange(async a=>{this.plugin.settings.autoCreateNotes=a,await this.plugin.saveSettings()}));let n=["",...this.getAllFolders()];new C(e).setName("New note folder").setDesc("Type to search and select folder where new notes will be created").addText(s=>{let a=this.plugin.settings.newNoteFolder||"/ (Root)";s.setValue(a).setPlaceholder("Type to search folders..."),new Tt(this.app,s.inputEl,n),s.onChange(async l=>{let r=l==="/ (Root)"?"":l;r&&(r=Lt(r)),this.plugin.settings.newNoteFolder=r,await this.plugin.saveSettings()})}),new C(e).setName("New note template").setDesc("Template for auto-created notes. Use {{keyword}} and {{date}} as placeholders.").addTextArea(s=>s.setPlaceholder(`# {{keyword}}

Created: {{date}}`).setValue(this.plugin.settings.newNoteTemplate).onChange(async a=>{this.plugin.settings.newNoteTemplate=a,await this.plugin.saveSettings()})),new C(e).setName("Keyword suggestions").setDesc("Configure how the keyword suggestion feature works.").setHeading(),new C(e).setName("Custom stop words").setDesc("Additional words to exclude from keyword suggestions (comma-separated). These are added to the default stop word list.").addTextArea(s=>{s.setPlaceholder("example, test, demo, sample").setValue((this.plugin.settings.customStopWords||[]).join(", ")).onChange(async a=>{let l=a.split(",").map(r=>r.trim()).filter(r=>r.length>0);this.plugin.settings.customStopWords=l,await this.plugin.saveSettings()}),s.inputEl.rows=4,s.inputEl.cols=50}),new C(e).setName("Reset custom stop words").setDesc("Clear all custom stop words").addButton(s=>s.setButtonText("Reset").onClick(async()=>{this.plugin.settings.customStopWords=[],await this.plugin.saveSettings(),new ae("Custom stop words cleared"),this.display()}))}displayImportExportTab(e){new C(e).setName("Import & export keywords").setDesc("Export your keywords to CSV or import keywords from a CSV file.").setHeading(),new C(e).setName("Export keywords to CSV").setDesc("Export all keywords and their settings to a CSV file").addButton(t=>t.setButtonText("Export to CSV").setCta().onClick(()=>this.plugin.exportKeywordsToCSV())),new C(e).setName("Import keywords from CSV").setDesc("Import keywords from a CSV file (opens file picker)").addButton(t=>t.setButtonText("Import from CSV").onClick(()=>this.plugin.importKeywordsFromCSV())),new C(e).setName("Statistics").setDesc("View usage statistics for the plugin.").setHeading(),new C(e).setName("View statistics").setDesc("See how many links have been created and which notes have been processed").addButton(t=>t.setButtonText("View statistics").onClick(()=>this.plugin.showStatistics()))}renderKeywords(e){var l;e.empty();let t=this.searchFilter.toLowerCase(),n=0,s=this.plugin.scrollToKeywordId,a=null;for(let r=0;r<this.plugin.settings.keywords.length;r++){let i=this.plugin.settings.keywords[r];if(t&&i.id!==s){let y=i.keyword&&i.keyword.toLowerCase().includes(t),b=i.target&&i.target.toLowerCase().includes(t),v=i.variations&&i.variations.some(D=>D.toLowerCase().includes(t));if(!y&&!b&&!v)continue}n++,i.collapsed===void 0&&(i.collapsed=!1),s&&i.id===s&&(i.collapsed=!1);let c=e.createDiv({cls:"akl-keyword-card"});s&&i.id===s&&(a=c,c.addClass("akl-highlight-card"));let u=c.createDiv({cls:"akl-card-header"}),d=u.createDiv({cls:"akl-collapse-btn"});d.innerHTML=i.collapsed?"\u25B6":"\u25BC",d.setAttribute("aria-label",i.collapsed?"Expand":"Collapse"),d.addEventListener("click",async()=>{i.collapsed=!i.collapsed,await this.plugin.saveSettings(),this.display()});let g=u.createDiv({cls:"akl-card-title"}),k=i.keyword||"New Keyword",h=i.target?` \u2192 ${i.target}`:"";g.createSpan({text:k,cls:"akl-keyword-name"}),h&&g.createSpan({text:h,cls:"akl-target-name"});let p=u.createDiv({cls:"akl-card-badges"});if(i.groupId){let y=this.plugin.settings.keywordGroups.find(b=>b.id===i.groupId);y&&p.createSpan({text:`\u{1F4C1} ${y.name}`,cls:"akl-badge akl-badge-group"})}let w=this.plugin.getEffectiveKeywordSettings(i);w.enableTags&&p.createSpan({text:"Tags",cls:"akl-badge akl-badge-tags"}),w.useRelativeLinks&&p.createSpan({text:"MD Links",cls:"akl-badge akl-badge-md-links"}),w.suggestMode&&p.createSpan({text:"Suggest",cls:"akl-badge akl-badge-suggest"});let f=this.plugin.getAliasesForNote(i.target),m=i.variations&&i.variations.length||0,A=f&&f.length||0,S=m+A;S>0&&p.createSpan({text:`${S} var`,cls:"akl-badge akl-badge-variations"});let E=c.createDiv({cls:"akl-card-body"});i.collapsed&&(E.style.display="none");let x=!!i.groupId,L=x?(l=this.plugin.settings.keywordGroups.find(y=>y.id===i.groupId))==null?void 0:l.name:null,F=new C(E).setName("Keyword").setDesc("The text to search for in your notes").addText(y=>{y.setValue(i.keyword).setPlaceholder("Enter keyword..."),y.inputEl.addClass("akl-input");let b=i.keyword;y.inputEl.addEventListener("input",()=>{b=y.inputEl.value,y.inputEl.removeClass("akl-input-error"),F.setDesc("The text to search for in your notes"),F.descEl.removeClass("akl-error-text")}),y.inputEl.addEventListener("blur",async()=>{let v=b.trim();if(v){let D=this.isDuplicateKeyword(v,i.id);if(D){y.inputEl.addClass("akl-input-error"),F.setDesc(`Duplicate: "${v}" already exists (keyword: "${D.keyword}" \u2192 ${D.target})`),F.descEl.addClass("akl-error-text"),y.setValue(i.keyword),b=i.keyword;return}}this.plugin.settings.keywords[r].keyword=v,await this.plugin.saveSettings(),this.updateCardHeader(g,v,this.plugin.settings.keywords[r].target),!this.plugin.settings.keywords[r].target&&v&&(this.plugin.settings.keywords[r].target=v,await this.plugin.saveSettings(),this.display())}),i.keyword||setTimeout(()=>y.inputEl.focus(),50)});new C(E).setName("Target note").setDesc("Click to search and select the note to create links to").addText(y=>{let b=this.app.vault.getMarkdownFiles(),v=new Set;for(let N of b)if(v.add(N.basename),N.path.includes("/")){let O=N.path.endsWith(".md")?N.path.slice(0,-3):N.path;v.add(O)}let D=Array.from(v).sort((N,O)=>N.toLowerCase().localeCompare(O.toLowerCase())),R=i.target||"";y.setValue(R).setPlaceholder("Type to search notes..."),new cn(this.app,y.inputEl,D),y.onChange(async N=>{this.plugin.settings.keywords[r].target=N,await this.plugin.saveSettings(),this.updateCardHeader(g,this.plugin.settings.keywords[r].keyword,N)})}),new C(E).setName("Block reference").setDesc("Optional: Link to a specific block (e.g., ^block-id for abbreviation definitions)").addText(y=>{y.setValue(i.blockRef||"").setPlaceholder("^block-id").onChange(async b=>{let v=b;v=v.replace(/\[\[.*?\]\]/g,""),v&&!v.startsWith("^")&&(v="^"+v),v=v.replace(/\s/g,""),this.plugin.settings.keywords[r].blockRef=v,await this.plugin.saveSettings(),v!==b&&y.setValue(v)}),y.inputEl.setAttribute("autocomplete","off"),y.inputEl.setAttribute("data-no-suggest","true")}),new C(E).setName("Require tag").setDesc("Optional: Only link to target note if it has this tag (e.g., #reviewed or reviewed)").addText(y=>{y.setValue(i.requireTag||"").setPlaceholder("#tag or tag").onChange(async b=>{let v=b.trim();v.startsWith("#")&&(v=v.substring(1)),this.plugin.settings.keywords[r].requireTag=v,await this.plugin.saveSettings()}),y.inputEl.setAttribute("autocomplete","off")}),new C(E).setName("Only link in notes already linking to target").setDesc("Only create keyword links in notes that already have at least one link to the target note").addToggle(y=>{let b=this.plugin.getEffectiveKeywordSettings(i);y.setValue(b.onlyInNotesLinkingTo||!1).onChange(async v=>{this.plugin.settings.keywords[r].onlyInNotesLinkingTo=v,await this.plugin.saveSettings()})});let B=E.createDiv({cls:"akl-variations-section"});B.createEl("div",{text:"Variations",cls:"setting-item-name"}),B.createEl("div",{text:"Alternative spellings that also link to the target note",cls:"setting-item-description"});let K=B.createDiv({cls:"akl-chips-container"}),M=i.variations&&i.variations.length>0,I=f&&f.length>0;!M&&!I?K.createSpan({text:"No variations added yet",cls:"akl-no-variations"}):(this.renderVariationChips(K,i.variations||[],r),I&&this.renderAliasChips(K,f));let P=B.createDiv({cls:"akl-add-variation"}).createEl("input",{type:"text",placeholder:"Type and press Enter to add...",cls:"akl-variation-input"});P.addEventListener("keydown",async y=>{if(y.key==="Enter"){y.preventDefault();let b=P.value.trim();if(!b)return;if(i.variations||(i.variations=[]),i.variations.some(O=>O.toLowerCase()===b.toLowerCase())){new ae("Variation already exists in this keyword"),P.value="";return}let D=this.isDuplicateKeyword(b,i.id);if(D){new ae(`"${b}" already exists as keyword "${D.keyword}" \u2192 ${D.target}`),P.value="";return}P.value="",i.variations.push(b),await this.plugin.saveSettings(),K.empty();let R=i.variations&&i.variations.length>0,N=f&&f.length>0;!R&&!N?K.createSpan({text:"No variations added yet",cls:"akl-no-variations"}):(this.renderVariationChips(K,i.variations||[],r),N&&this.renderAliasChips(K,f)),P.focus()}});let G=new C(E).setName("Enable tags").setDesc(x?`Inherited from group "${L}"`:"Automatically add tags to source and target notes").addToggle(y=>{let b=this.plugin.getEffectiveKeywordSettings(i);y.setValue(b.enableTags||!1).setDisabled(x).onChange(async v=>{x||(this.plugin.settings.keywords[r].enableTags=v,await this.plugin.saveSettings(),this.display())})});x&&G.settingEl.addClass("akl-disabled-setting");let V=new C(E).setName("Use relative Markdown links").setDesc(x?`Inherited from group "${L}"`:"Create Markdown links [text](note.md) instead of wikilinks [[note]]").addToggle(y=>{let b=this.plugin.getEffectiveKeywordSettings(i);y.setValue(b.useRelativeLinks||!1).setDisabled(x).onChange(async v=>{x||(this.plugin.settings.keywords[r].useRelativeLinks=v,await this.plugin.saveSettings())})});x&&V.settingEl.addClass("akl-disabled-setting");let re=new C(E).setName("Suggest instead of auto-link").setDesc(x?`Inherited from group "${L}"`:"Highlight keywords as suggestions instead of automatically creating links. Right-click to accept.").addToggle(y=>{let b=this.plugin.getEffectiveKeywordSettings(i);y.setValue(b.suggestMode||!1).setDisabled(x).onChange(async v=>{x||(this.plugin.settings.keywords[r].suggestMode=v,await this.plugin.saveSettings(),this.display())})});x&&re.settingEl.addClass("akl-disabled-setting"),new C(E).setName("Keyword group").setDesc("Assign to a group to inherit group settings. Group settings will be locked and cannot be overridden per-keyword.").addDropdown(y=>{y.addOption("","(No group)"),this.plugin.settings.keywordGroups.forEach(b=>{y.addOption(b.id,b.name)}),y.setValue(i.groupId||"").onChange(async b=>{this.plugin.settings.keywords[r].groupId=b||null,await this.plugin.saveSettings(),this.display()})});let Q=new C(E).setName("Prevent self-link").setDesc(x?`Inherited from group "${L}"`:"Prevent this keyword from linking on its own target note (overrides global setting)").addToggle(y=>{let b=this.plugin.getEffectiveKeywordSettings(i);y.setValue(b.preventSelfLink||!1).setDisabled(x).onChange(async v=>{x||(this.plugin.settings.keywords[r].preventSelfLink=v,await this.plugin.saveSettings())})});x&&Q.settingEl.addClass("akl-disabled-setting");let W=new C(E).setName("Link scope").setDesc(x?`Inherited from group "${L}"`:"Control where this keyword will be linked").addDropdown(y=>{let b=this.plugin.getEffectiveKeywordSettings(i);y.addOption("vault-wide","Vault-wide (everywhere)").addOption("same-folder","Same folder only").addOption("source-folder","Source in specific folder").addOption("target-folder","Target in specific folder").setValue(b.linkScope||"vault-wide").setDisabled(x).onChange(async v=>{x||(this.plugin.settings.keywords[r].linkScope=v,await this.plugin.saveSettings(),this.display())})});if(x&&W.settingEl.addClass("akl-disabled-setting"),i.linkScope==="source-folder"||i.linkScope==="target-folder"){let b=["",...this.getAllFolders()];new C(E).setName("Folder").setDesc("Type to search and select a folder").addText(v=>{let D=i.scopeFolder||"/ (Root)";v.setValue(D).setPlaceholder("Type to search folders..."),new Tt(this.app,v.inputEl,b),v.onChange(async R=>{let N=R==="/ (Root)"?"":R;N&&(N=Lt(N)),this.plugin.settings.keywords[r].scopeFolder=N,await this.plugin.saveSettings()})})}E.createDiv({cls:"akl-card-footer"}).createEl("button",{text:"Delete keyword",cls:"akl-delete-btn"}).addEventListener("click",async()=>{this.plugin.settings.keywords.splice(r,1),await this.plugin.saveSettings(),this.display()})}if(n===0&&t){let r=e.createDiv({cls:"akl-no-results"});r.createEl("p",{text:"No keywords found"}),r.createEl("p",{text:`No keywords match "${this.searchFilter}"`,cls:"akl-no-results-hint"})}a&&s&&(this.plugin.scrollToKeywordId=null,setTimeout(()=>{a.scrollIntoView({behavior:"smooth",block:"center"}),a.addClass("akl-highlight-pulse"),setTimeout(()=>{a.removeClass("akl-highlight-pulse"),a.removeClass("akl-highlight-card")},2e3)},300))}renderGroups(e){if(e.empty(),this.plugin.settings.keywordGroups.length===0){let t=e.createDiv({cls:"akl-empty-state"});t.createEl("p",{text:"No groups yet"}),t.createEl("p",{text:"Create a group to organize your keywords with shared settings",cls:"akl-empty-hint"});return}for(let t=0;t<this.plugin.settings.keywordGroups.length;t++){let n=this.plugin.settings.keywordGroups[t];n.collapsed===void 0&&(n.collapsed=!1);let s=this.plugin.settings.keywords.filter(h=>h.groupId===n.id),a=e.createDiv({cls:"akl-keyword-card akl-group-card"}),l=a.createDiv({cls:"akl-card-header"}),r=l.createDiv({cls:"akl-collapse-btn"});r.innerHTML=n.collapsed?"\u25B6":"\u25BC",r.setAttribute("aria-label",n.collapsed?"Expand":"Collapse"),r.addEventListener("click",async()=>{n.collapsed=!n.collapsed,await this.plugin.saveSettings(),this.display()});let i=l.createDiv({cls:"akl-card-title"});i.createSpan({text:n.name,cls:"akl-keyword-name"}),i.createSpan({text:` (${s.length} keywords)`,cls:"akl-target-name"}),l.createEl("button",{text:"\u{1F5D1}\uFE0F Delete",cls:"akl-delete-btn"}).addEventListener("click",async h=>{h.stopPropagation(),this.plugin.settings.keywords.forEach(p=>{p.groupId===n.id&&(p.groupId=null)}),this.plugin.settings.keywordGroups.splice(t,1),await this.plugin.saveSettings(),this.display()});let u=a.createDiv({cls:"akl-card-body"});n.collapsed&&(u.style.display="none"),new C(u).setName("Group name").setDesc("Name for this group of keywords").addText(h=>{h.setValue(n.name).setPlaceholder("Enter group name...").onChange(async p=>{this.plugin.settings.keywordGroups[t].name=p,await this.plugin.saveSettings(),i.empty(),i.createSpan({text:p,cls:"akl-keyword-name"}),i.createSpan({text:` (${s.length} keywords)`,cls:"akl-target-name"})}),h.inputEl.addClass("akl-input")});let d=u.createDiv({cls:"akl-group-keywords-section"});if(d.createEl("h4",{text:"Keywords in this group",cls:"akl-subsection-header"}),s.length===0)d.createEl("p",{text:"No keywords in this group yet. Add keywords below or assign them from the keywords tab.",cls:"akl-hint-text"});else{let h=d.createDiv({cls:"akl-keywords-list"});s.forEach(p=>{let w=h.createDiv({cls:"akl-keyword-chip"});w.createSpan({text:p.keyword||"Untitled"}),w.createSpan({text:"\xD7",cls:"akl-chip-remove"}).addEventListener("click",async()=>{p.groupId=null,await this.plugin.saveSettings(),this.display()})})}d.createEl("button",{text:"+ Add keywords to group",cls:"akl-button-secondary"}).addEventListener("click",()=>{let h=this.plugin.settings.keywords.filter(p=>p.groupId===n.id);new ln(this.app,this.plugin,n.id,h).open()});let k=u.createDiv({cls:"akl-group-settings-section"});k.createEl("h4",{text:"Group settings",cls:"akl-subsection-header"}),k.createEl("p",{text:"These settings apply to all keywords in this group.",cls:"akl-hint-text"}),new C(k).setName("Link scope").setDesc("Control where keywords in this group will be linked").addDropdown(h=>h.addOption("vault-wide","Vault-wide (everywhere)").addOption("same-folder","Same folder only").addOption("source-folder","Source in specific folder").addOption("target-folder","Target in specific folder").setValue(n.settings.linkScope||"vault-wide").onChange(async p=>{n.settings.linkScope=p,await this.plugin.saveSettings()})),new C(k).setName("Enable tags").setDesc("Add #tag to target notes when linking").addToggle(h=>h.setValue(n.settings.enableTags||!1).onChange(async p=>{n.settings.enableTags=p,await this.plugin.saveSettings()})),new C(k).setName("Suggest mode").setDesc("Suggest links instead of creating them automatically").addToggle(h=>h.setValue(n.settings.suggestMode||!1).onChange(async p=>{n.settings.suggestMode=p,await this.plugin.saveSettings()})),new C(k).setName("Use Markdown links").setDesc("Use [text](link.md) format instead of [[wikilinks]]").addToggle(h=>h.setValue(n.settings.useRelativeLinks||!1).onChange(async p=>{n.settings.useRelativeLinks=p,await this.plugin.saveSettings()})),new C(k).setName("Prevent self-links").setDesc("Don't link keywords on their own target note").addToggle(h=>h.setValue(n.settings.preventSelfLink||!1).onChange(async p=>{n.settings.preventSelfLink=p,await this.plugin.saveSettings()}))}}renderVariationChips(e,t,n){t.length!==0&&t.forEach((s,a)=>{let l=e.createDiv({cls:"akl-chip"});l.createSpan({text:s,cls:"akl-chip-text"});let r=l.createSpan({text:"\xD7",cls:"akl-chip-remove"});r.setAttribute("aria-label",`Remove ${s}`),r.addEventListener("click",async()=>{this.plugin.settings.keywords[n].variations.splice(a,1),await this.plugin.saveSettings(),this.display()})})}renderAliasChips(e,t){!t||t.length===0||t.forEach(n=>{let s=e.createDiv({cls:"akl-chip akl-chip-auto"});s.createSpan({text:n,cls:"akl-chip-text"});let a=s.createSpan({text:"\u{1F517}",cls:"akl-chip-auto-indicator"});a.setAttribute("aria-label","Auto-discovered from note alias"),a.setAttribute("title","Auto-discovered from note frontmatter")})}getAllFolders(){let e=new Set;return this.app.vault.getAllLoadedFiles().filter(n=>n.children).map(n=>n.path).forEach(n=>{n&&n!=="/"&&e.add(n)}),Array.from(e).sort((n,s)=>n.toLowerCase().localeCompare(s.toLowerCase()))}addCustomStyles(){}};$t.exports=Ie});var It=T((ai,At)=>{var{FuzzySuggestModal:dn}=require("obsidian"),Ne=class extends dn{constructor(e,t,n,s){super(e),this.folders=t,this.currentValue=n,this.onChooseCallback=s}getItems(){return this.folders}getItemText(e){return e||"/ (Root)"}onChooseItem(e,t){this.onChooseCallback(e)}};At.exports=Ne});var Dt=T((ri,Nt)=>{var{FuzzySuggestModal:un}=require("obsidian"),De=class extends un{constructor(e,t,n,s){super(e),this.notes=t,this.currentValue=n,this.onChooseCallback=s}getItems(){return this.notes}getItemText(e){return e}onChooseItem(e,t){this.onChooseCallback(e)}};Nt.exports=De});var Ve=T((li,Vt)=>{var{Notice:Ft,Menu:Ke,MarkdownView:_}=require("obsidian"),{escapeRegex:Fe}=z();function gn(o,e){e.querySelectorAll(".akl-suggested-link").forEach(n=>{n.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation(),new Ft("Switch to edit mode to accept suggestions, or use the review modal")}),n.addEventListener("contextmenu",s=>{s.preventDefault(),s.stopPropagation();let a=new Ke;a.addItem(l=>{l.setTitle("\u{1F4CB} Review link suggestions (opens in edit mode)").setIcon("list-checks").onClick(async()=>{let r=o.app.workspace.getActiveViewOfType(_);r&&(await r.setState({mode:"source"},{}),setTimeout(()=>{var c;let i=(c=o.app.workspace.getActiveViewOfType(_))==null?void 0:c.editor;i&&o.reviewSuggestions(i)},100))})}),a.showAtMouseEvent(s)})})}function Bt(o){var l;if(!o.statusBarItem)return;let e=(l=o.app.workspace.getActiveViewOfType(_))==null?void 0:l.editor;if(!e){o.statusBarItem.setText(""),o.statusBarItem.style.display="none";return}let t=e.getValue(),n=/<span class="akl-suggested-link"[^>]*>([^<]+)<\/span>/g,s=t.match(n),a=s?s.length:0;a>0?(o.statusBarItem.setText(`\u{1F4A1} ${a} link suggestion${a>1?"s":""}`),o.statusBarItem.style.cursor="pointer",o.statusBarItem.style.display="inline-block",o.statusBarItem.addClass("mod-clickable"),o.statusBarItem.setAttribute("aria-label","Click to review suggestions"),o.statusBarItem.onclick=()=>{var i;let r=(i=o.app.workspace.getActiveViewOfType(_))==null?void 0:i.editor;r&&o.reviewSuggestions(r)}):(o.statusBarItem.setText(""),o.statusBarItem.style.display="none",o.statusBarItem.onclick=null)}function pn(o){o.registerDomEvent(document,"contextmenu",e=>{let t=e.target;if(t&&t.classList&&t.classList.contains("akl-suggested-link")){e.preventDefault();let n=new Ke;n.addItem(s=>{s.setTitle("Accept link suggestion").setIcon("check").onClick(()=>{o.acceptSuggestionElement(t)})}),n.showAtMouseEvent(e)}})}function hn(o){o.registerDomEvent(document,"click",e=>{let t=o.app.workspace.getActiveViewOfType(_);if(!t)return;let n=t.editor;if(!n)return;let s=e.target,a=null;if(s.classList&&s.classList.contains("akl-suggested-link")?a=s:s.parentElement&&s.parentElement.classList&&s.parentElement.classList.contains("akl-suggested-link")&&(a=s.parentElement),a){e.preventDefault(),e.stopPropagation();let l=n.getCursor(),r=n.getLine(l.line);Be(o,n,l.line,r,e)}}),o.registerDomEvent(document,"contextmenu",e=>{let t=o.app.workspace.getActiveViewOfType(_);if(!t)return;let n=t.editor;if(!n)return;let s=e.target,a=null;if(s.classList&&s.classList.contains("akl-suggested-link")?a=s:s.parentElement&&s.parentElement.classList&&s.parentElement.classList.contains("akl-suggested-link")&&(a=s.parentElement),a){e.preventDefault(),e.stopPropagation();let l=n.getCursor(),r=n.getLine(l.line);Be(o,n,l.line,r,e)}})}function Be(o,e,t,n,s){let a=/<span class="akl-suggested-link" data-target="([^"]*)" data-block="([^"]*)" data-use-relative="([^"]*)"[^>]*>([^<]+)<\/span>/g,l=[...n.matchAll(a)];if(l.length===0)return;let r=l[0],i=r[1],c=r[2],u=r[3]==="true",d=r[4],g=new Ke;g.addItem(k=>{k.setTitle(`Accept link suggestion: "${d}"`).setIcon("check").onClick(()=>{Kt(o,e,t,n,d,i,c,u)})}),g.showAtMouseEvent(s)}function Kt(o,e,t,n,s,a,l,r){let i=new RegExp(`<span class="akl-suggested-link" data-target="${Fe(a)}" data-block="${Fe(l)}" data-use-relative="${r?"true":"false"}"[^>]*>${Fe(s)}</span>`);if(!i.test(n))return;let c=e.getValue(),u=e.posToOffset({line:t,ch:0}),d=o.isInsideTable(c,u),g,k=l?`${a}#${l}`:a;if(r){let p=d?s.replace(/\|/g,"\\|"):s,w=encodeURIComponent(a)+".md",f=l?`#${l}`:"";g=`[${p}](${w}${f})`}else d?g=a===s&&!l?`[[${s}]]`:`[[${k}\\|${s}]]`:g=a===s&&!l?`[[${s}]]`:`[[${k}|${s}]]`;let h=n.replace(i,g);e.setLine(t,h),new Ft("Link suggestion accepted"),setTimeout(()=>Bt(o),100)}Vt.exports={processSuggestedLinks:gn,updateStatusBar:Bt,setupSuggestionContextMenu:pn,setupLivePreviewClickHandler:hn,showSuggestionMenuAtLine:Be,acceptSuggestionInLine:Kt}});var Rt=T((ci,Mt)=>{function fn(){}Mt.exports={addCustomStyles:fn}});var Pt=T((di,qt)=>{function wn(o){let e=null,t=new Map,n=new Set;o.registerEvent(o.app.vault.on("modify",s=>{s.extension==="md"&&!n.has(s.path)&&(n.add(s.path),o.linkKeywordsInFile(s,!1,!0).then(a=>{if(n.delete(s.path),a&&a.pendingTags){t.has(s.path)||t.set(s.path,{tagsToAdd:new Set,targetNotesForTags:new Map});let l=t.get(s.path);a.pendingTags.tagsToAdd.forEach(r=>l.tagsToAdd.add(r)),a.pendingTags.targetNotesForTags.forEach((r,i)=>{l.targetNotesForTags.set(i,r)}),e&&clearTimeout(e),e=setTimeout(async()=>{try{for(let[r,i]of t.entries()){let c=o.app.vault.getAbstractFileByPath(r);c&&c.extension==="md"&&(n.add(r),await o.addTagsToFile(c,Array.from(i.tagsToAdd),i.targetNotesForTags),setTimeout(()=>{n.delete(r)},100))}}finally{t.clear(),e=null}},1e3)}}))}))}qt.exports={setupAutoLinkOnSave:wn}});var Gt=T((pi,Wt)=>{var{MarkdownView:kn}=require("obsidian"),{escapeRegex:se,getContext:yn}=z(),{getFrontmatterBounds:mn,isInsideAlias:vn,isPartOfUrl:Sn,isInsideLinkOrCode:bn,isInsideBlockReference:Cn,isInsideTable:xn,isInsideMath:Ln}=ge(),{getEffectiveKeywordSettings:ui,buildKeywordMap:Ot,checkLinkScope:Tn}=de(),{findTargetFile:En,getAliasesForNote:gi,noteHasTag:$n,noteHasLinkToTarget:An,ensureNoteExists:In}=oe(),{sanitizeTagName:Nn,addTagsToContent:Dn,addTagToTargetNote:zt}=he(),Me=class{constructor(e,t){this.app=e,this.settings=t}processContent(e,t,n=!1,s=!1){let a=e,l=e.length,r=mn(e),i=0,c=[],u=new Set,d=new Map,g=Ot(this.app,this.settings),k=Object.keys(g).sort((f,m)=>m.length-f.length),h=new Set,p=[];for(let f of k){let m=g[f].target,A=g[f].enableTags,S=g[f].linkScope||"vault-wide",E=g[f].scopeFolder||"",x=g[f].useRelativeLinks||!1,L=g[f].blockRef||"",F=g[f].requireTag||"",B=g[f].onlyInNotesLinkingTo||!1,K=g[f].suggestMode||!1,M=g[f].preventSelfLink||!1,I=g[f].keywordIndex;if(!f.trim()||!m||!m.trim())continue;if(this.settings.preventSelfLinkGlobal||M){let $=t.basename,y=m.split("/").pop();if($===y)continue}if(B&&!An(this.app,t,m)||!$n(this.app,m,F)||!Tn(this.app,t,m,S,E,En))continue;let q=this.settings.caseSensitive?"g":"gi",P=se(f),G=/^\w/.test(f)?"\\b":"(?<![\\w])",V=/\w$/.test(f)?"\\b":"(?![\\w])",re=new RegExp(`${G}${P}${V}`,q),Q,W=[],le=!1;for(;(Q=re.exec(e))!==null;){let $=Q.index,y=Q[0];if(r&&$>=r.start&&$<r.end||$>0&&e[$-1]==="#"||Cn(e,$)||bn(e,$)||vn(e,$)||Sn(e,$,y.length)||Ln(e,$))continue;if(this.settings.firstOccurrenceOnly){let R=f.toLowerCase();if(h.has(R))break;let N=this.settings.caseSensitive?new RegExp(`\\[\\[([^\\]]+\\|)?${se(f)}\\]\\]`):new RegExp(`\\[\\[([^\\]]+\\|)?${se(f)}\\]\\]`,"i"),O=this.settings.caseSensitive?new RegExp(`<span class="akl-suggested-link"[^>]*>${se(f)}</span>`):new RegExp(`<span class="akl-suggested-link"[^>]*>${se(f)}</span>`,"i");if(N.test(e)||O.test(e))break;h.add(R)}let b=xn(e,$),v=L?`${m}#${L}`:m,D;if(K){let R=m.replace(/"/g,"&quot;"),N=L.replace(/"/g,"&quot;");D=`<span class="akl-suggested-link" data-target="${R}" data-block="${N}" data-use-relative="${x?"true":"false"}" data-keyword-index="${I}">${y}</span>`}else if(x){let R=b?y.replace(/\|/g,"\\|"):y,N=encodeURIComponent(m)+".md",O=L?`#${L}`:"";D=`[${R}](${N}${O})`}else b?D=m===y&&!L?`[[${y}]]`:`[[${v}\\|${y}]]`:D=m===y&&!L?`[[${y}]]`:`[[${v}|${y}]]`;if(W.push({index:$,length:y.length,original:y,replacement:D,lengthDiff:D.length-y.length}),c.push({keyword:y,target:m,context:yn(e,$)}),le=!0,this.settings.firstOccurrenceOnly)break}if(le&&A){let $=Nn(f);u.add($),m!==t.basename&&d.set(m,$)}for(let $=W.length-1;$>=0;$--){let y=W[$];e=e.substring(0,y.index)+y.replacement+e.substring(y.index+y.length),i++}for(let $=0;$<W.length;$++)p.push({index:W[$].index,lengthDiff:W[$].lengthDiff})}return p.sort((f,m)=>f.index-m.index),u.size>0&&!n&&!s&&(e=Dn(e,Array.from(u))),{newContent:e,originalContent:a,originalLength:l,changed:e!==a,linkCount:i,changes:c,tagsToAdd:u,targetNotesForTags:d,allReplacements:p}}async linkKeywordsInFile(e,t=!1,n=!1){if(e.extension!=="md")return null;let s=this.app.workspace.getActiveViewOfType(kn),l=s&&s.file.path===e.path?s.editor:null;if(this.settings.autoCreateNotes){let i=Ot(this.app,this.settings);for(let c of Object.keys(i)){let u=i[c].target;u&&u.trim()&&await In(this.app,this.settings,u)}}let r=null;if(l){let i=t?null:l.getCursor(),c=l.getValue(),u=this.processContent(c,e,t,n);if(!u.changed)return null;if(!t){let d=u.originalContent.split(`
`),g=0;for(let w=0;w<i.line&&w<d.length;w++)g+=d[w].length+1;g+=i.ch;let k=0;for(let w of u.allReplacements)w.index<g&&(k+=w.lengthDiff);let h=g+k,p=g>=u.originalLength-10;if(l.setValue(u.newContent),u.tagsToAdd.size>0&&p){let w=u.newContent.split(`
`),f=-1;for(let m=w.length-1;m>=0;m--){let A=w[m].trim();if(A!==""&&!A.match(/^#[\w\-]+(\s+#[\w\-]+)*$/)){f=m;break}}f>=0?l.setCursor({line:f,ch:w[f].length}):l.setCursor({line:0,ch:0})}else{let w=u.newContent.split(`
`),f=h,m=0,A=0;for(let S=0;S<w.length;S++){if(f<=w[S].length){m=S,A=f;break}f-=w[S].length+1}l.setCursor({line:m,ch:A})}if(!n)for(let[w,f]of u.targetNotesForTags)await zt(this.app,w,f)}r={changed:!0,linkCount:u.linkCount,changes:u.changes,preview:t?u.newContent:null},n&&(u.tagsToAdd.size>0||u.targetNotesForTags.size>0)&&(r.pendingTags={tagsToAdd:Array.from(u.tagsToAdd),targetNotesForTags:u.targetNotesForTags})}else{let i=null;if(await this.app.vault.process(e,c=>(i=this.processContent(c,e,t,n),!i.changed||t?c:i.newContent)),!i||!i.changed)return null;if(!t&&!n)for(let[c,u]of i.targetNotesForTags)await zt(this.app,c,u);r={changed:!0,linkCount:i.linkCount,changes:i.changes,preview:t?i.newContent:null},n&&(i.tagsToAdd.size>0||i.targetNotesForTags.size>0)&&(r.pendingTags={tagsToAdd:Array.from(i.tagsToAdd),targetNotesForTags:i.targetNotesForTags})}return r}};Wt.exports=Me});var Ht=T((hi,jt)=>{function Fn(o){o.addCommand({id:"link-keywords-in-current-note",name:"Link keywords in current note",editorCheckCallback:(e,t,n)=>{if(e)return n.file!==null;o.linkKeywordsInCurrentNote(!1)}}),o.addCommand({id:"preview-keywords-in-current-note",name:"Preview keyword linking in current note",editorCheckCallback:(e,t,n)=>{if(e)return n.file!==null;o.linkKeywordsInCurrentNote(!0)}}),o.addCommand({id:"link-keywords-in-all-notes",name:"Link keywords in all notes",callback:()=>o.linkKeywordsInAllNotes(!1)}),o.addCommand({id:"preview-keywords-in-all-notes",name:"Preview keyword linking in all notes",callback:()=>o.linkKeywordsInAllNotes(!0)}),o.addCommand({id:"suggest-keywords",name:"Suggest keywords from notes",callback:()=>o.suggestKeywords()}),o.addCommand({id:"suggest-keywords-current-note",name:"Suggest keywords from current note only",editorCheckCallback:(e,t,n)=>{if(e)return n.file!==null;o.suggestKeywordsFromCurrentNote()}}),o.addCommand({id:"accept-suggestion-at-cursor",name:"Accept all suggestions on current line",editorCallback:e=>o.acceptSuggestionAtCursor(e)}),o.addCommand({id:"accept-all-suggestions",name:"Accept all link suggestions in current note",editorCallback:e=>o.acceptAllSuggestions(e)}),o.addCommand({id:"review-link-suggestions",name:"Review link suggestions",editorCallback:e=>o.reviewSuggestions(e)}),o.addCommand({id:"export-keywords",name:"Export keywords to JSON",callback:()=>o.exportKeywords()}),o.addCommand({id:"import-keywords",name:"Import keywords from JSON",callback:()=>o.importKeywords()}),o.addCommand({id:"download-csv-template",name:"Download CSV template",callback:()=>o.downloadCSVTemplate()}),o.addCommand({id:"export-keywords-csv",name:"Export keywords to CSV",callback:()=>o.exportKeywordsToCSV()}),o.addCommand({id:"import-keywords-csv",name:"Import keywords from CSV",callback:()=>o.importKeywordsFromCSV()}),o.addCommand({id:"view-statistics",name:"View statistics",callback:()=>o.showStatistics()})}jt.exports={registerCommands:Fn}});var Zt=T((fi,_t)=>{var{Modal:Bn,Setting:Ut,Notice:ne}=require("obsidian"),{generateId:Kn}=z(),Vn=Ae(),Re=class extends Bn{constructor(e,t,n){super(e),this.plugin=t,this.selectedText=n.trim(),this.targetValue="",this.allNotes=[]}onOpen(){let{contentEl:e,modalEl:t}=this;e.empty(),t.addClass("akl-quick-add-modal"),this.allNotes=this.app.vault.getMarkdownFiles().map(i=>i.path.replace(/\.md$/,"")),e.createEl("h2",{text:"Quick Add Keyword",cls:"akl-modal-title"}),new Ut(e).setName("Keyword").setDesc("The text that will be linked").addText(i=>{i.setValue(this.selectedText).setDisabled(!0),i.inputEl.addClass("akl-input")});let n=new Ut(e).setName("Target note").setDesc("The note to link to (type to search, or enter a new note name to create it)").addText(i=>{i.setPlaceholder("Search or create note...").setValue(this.selectedText),i.inputEl.addClass("akl-input"),this.targetInput=i.inputEl,this.targetValue=this.selectedText,new Vn(this.app,i.inputEl,this.allNotes),i.inputEl.addEventListener("input",()=>{this.targetValue=i.inputEl.value}),setTimeout(()=>{i.inputEl.focus(),i.inputEl.select()},50)});e.createDiv({cls:"akl-hint-text"}).setText("Tip: If the note doesn't exist, it will be created automatically.");let a=e.createDiv({cls:"akl-action-row"});a.createEl("button",{text:"Cancel"}).addEventListener("click",()=>this.close()),a.createEl("button",{text:"Add Keyword",cls:"mod-cta"}).addEventListener("click",()=>this.addKeyword()),e.addEventListener("keydown",i=>{i.key==="Enter"&&!i.shiftKey&&setTimeout(()=>{this.targetValue=this.targetInput.value,this.addKeyword()},100)})}async addKeyword(){let e=this.targetValue.trim();if(!e){new ne("Please enter a target note");return}if(this.plugin.settings.keywords.find(l=>l.keyword.toLowerCase()===this.selectedText.toLowerCase())){new ne(`Keyword "${this.selectedText}" already exists`);return}let n=e.endsWith(".md")?e:`${e}.md`;if(!this.app.vault.getAbstractFileByPath(n))try{let r=(this.plugin.settings.newNoteTemplate||`# {{keyword}}

Created: {{date}}

`).replace(/\{\{keyword\}\}/g,this.selectedText).replace(/\{\{date\}\}/g,new Date().toISOString().split("T")[0]),i=n.substring(0,n.lastIndexOf("/"));i&&(this.app.vault.getAbstractFileByPath(i)||await this.app.vault.createFolder(i)),await this.app.vault.create(n,r),new ne(`Created note: ${e}`)}catch(l){new ne(`Failed to create note: ${l.message}`);return}let a={id:Kn("kw"),keyword:this.selectedText,target:e,variations:[],enableTags:null,linkScope:"vault-wide",scopeFolder:"",useRelativeLinks:null,blockRef:"",requireTag:"",onlyInNotesLinkingTo:null,suggestMode:null,preventSelfLink:null,collapsed:!1,groupId:null};this.plugin.settings.keywords.push(a),await this.plugin.saveSettings(),new ne(`Keyword "${this.selectedText}" added \u2192 ${e}`),this.close()}onClose(){let{contentEl:e}=this;e.empty()}};_t.exports=Re});var Qt=T((wi,Jt)=>{var Z=Ve(),Mn=Zt();function Rn(o){Z.setupSuggestionContextMenu(o),o.registerMarkdownPostProcessor(e=>{Z.processSuggestedLinks(o,e)}),Z.setupLivePreviewClickHandler(o),o.registerEvent(o.app.workspace.on("editor-menu",(e,t)=>{let n=t.getSelection();n&&n.trim().length>0&&(e.addItem(l=>{l.setTitle("Quick add keyword").setIcon("plus-circle").onClick(()=>{new Mn(o.app,o,n).open()})}),e.addItem(l=>{l.setTitle("Add keyword...").setIcon("file-plus").onClick(()=>{o.addKeywordFromSelection(n.trim())})}),e.addSeparator());let s=t.getValue();/<span class="akl-suggested-link"[^>]*>([^<]+)<\/span>/.test(s)&&(e.addItem(l=>{l.setTitle("Review all link suggestions...").setIcon("list-checks").onClick(()=>{o.reviewSuggestions(t)})}),e.addItem(l=>{l.setTitle("Accept all suggestions on this line").setIcon("check").onClick(()=>{o.acceptSuggestionAtCursor(t)})}),e.addSeparator())})),o.statusBarItem=o.addStatusBarItem(),Z.updateStatusBar(o),o.registerEvent(o.app.workspace.on("active-leaf-change",()=>{Z.updateStatusBar(o)})),o.registerEvent(o.app.workspace.on("editor-change",()=>{setTimeout(()=>Z.updateStatusBar(o),100)}))}Jt.exports={registerEvents:Rn}});var{Plugin:qn}=require("obsidian"),{loadSettings:Pn,saveSettings:On,setupSettingsWatcher:zn}=ze(),{getEffectiveKeywordSettings:Wn,buildKeywordMap:Gn,checkLinkScope:jn}=de(),{getAliasesForNote:Hn,noteHasTag:Un,noteHasLinkToTarget:_n,ensureNoteExists:Zn,findTargetFile:Yt}=oe(),{getStopWords:Jn,extractWordsFromText:Qn,extractPhrasesFromText:Yn,analyzeNotesForKeywords:Xn,analyzeCurrentNoteForKeywords:eo}=Ue(),{getFrontmatterBounds:to,isInsideAlias:so,isPartOfUrl:no,isInsideLinkOrCode:oo,isInsideBlockReference:io,isInsideTable:ao,isInsideMath:ro}=ge(),{sanitizeTagName:lo,addTagsToContent:co,addTagsToFile:uo,addTagToTargetNote:go}=he(),{linkKeywordsInCurrentNote:po,linkKeywordsInAllNotes:ho}=Ye(),{suggestKeywords:fo,suggestKeywordsFromCurrentNote:wo,reviewSuggestions:ko,acceptSuggestionAtCursor:yo,acceptAllSuggestions:mo}=et(),{exportKeywords:vo,importKeywords:So,downloadCSVTemplate:bo,exportKeywordsToCSV:Co,importKeywordsFromCSV:xo}=st(),{showStatistics:Lo}=ot(),To=at(),Xt=lt(),Eo=dt(),$o=pt(),Ao=ft(),Io=yt(),No=vt(),Do=Te(),ki=Le(),yi=It(),mi=Dt(),J=Ve(),{addCustomStyles:es}=Rt(),{setupAutoLinkOnSave:ts}=Pt(),Fo=Gt(),{registerCommands:Bo}=Ht(),{registerEvents:Ko}=Qt();module.exports=class extends qn{async onExternalSettingsChange(){this._handleExternalSettingsChange&&await this._handleExternalSettingsChange()}async onload(){this.settings=await Pn(this),zn(this),this.keywordLinker=new Fo(this.app,this.settings),Bo(this),this.addSettingTab(new Do(this.app,this)),es(),Ko(this),this.settings.autoLinkOnSave&&ts(this)}processSuggestedLinks(e){return J.processSuggestedLinks(this,e)}updateStatusBar(){return J.updateStatusBar(this)}setupSuggestionContextMenu(){return J.setupSuggestionContextMenu(this)}setupLivePreviewClickHandler(){return J.setupLivePreviewClickHandler(this)}showSuggestionMenuAtLine(e,t,n,s){return J.showSuggestionMenuAtLine(this,e,t,n,s)}acceptSuggestionInLine(e,t,n,s,a,l,r){return J.acceptSuggestionInLine(this,e,t,n,s,a,l,r)}reviewSuggestions(e){return ko(this.app,e,Io)}acceptSuggestionAtCursor(e){return yo(e,this.isInsideTable.bind(this),this.updateStatusBar.bind(this))}acceptAllSuggestions(e){return mo(e,this.isInsideTable.bind(this),this.updateStatusBar.bind(this))}showStatistics(){return Lo(this.app,this.settings,To)}async exportKeywords(){return await vo(this.app,this.settings)}async importKeywords(){return await So(this.app,this,Eo)}async downloadCSVTemplate(){return await bo(this.app)}async exportKeywordsToCSV(){return await Co(this.app,this.settings)}async importKeywordsFromCSV(){return await xo(this.app,this,$o)}async suggestKeywords(){return await fo(this.app,this,Xt)}async suggestKeywordsFromCurrentNote(){return await wo(this.app,this,Xt)}getStopWords(){return Jn(this.settings)}extractWordsFromText(e,t=!1){return Qn(e,t,this.settings)}extractPhrasesFromText(e){return Yn(e,this.settings)}async analyzeNotesForKeywords(){return await Xn(this.app,this.settings,this.getAliasesForNote.bind(this))}async analyzeCurrentNoteForKeywords(e){return await eo(this.app,this.settings,e,this.getAliasesForNote.bind(this))}setupAutoLinkOnSave(){return ts(this)}async linkKeywordsInCurrentNote(e=!1){return await po(this.app,this.settings,this.linkKeywordsInFile.bind(this),this.saveSettings.bind(this),this.updateStatusBar.bind(this),Ao,e)}async linkKeywordsInAllNotes(e=!1){return await ho(this.app,this.settings,this.linkKeywordsInFile.bind(this),this.saveSettings.bind(this),this,No,e)}async linkKeywordsInFile(e,t=!1,n=!1){return this.keywordLinker.settings=this.settings,await this.keywordLinker.linkKeywordsInFile(e,t,n)}async addTagsToFile(e,t,n){return await uo(this.app,e,t,n)}sanitizeTagName(e){return lo(e)}addTagsToContent(e,t){return co(e,t)}async addTagToTargetNote(e,t){return await go(this.app,e,t)}getFrontmatterBounds(e){return to(e)}isInsideAlias(e,t){return so(e,t)}isPartOfUrl(e,t,n){return no(e,t,n)}isInsideLinkOrCode(e,t){return oo(e,t)}isInsideBlockReference(e,t){return io(e,t)}isInsideTable(e,t){return ao(e,t)}isInsideMath(e,t){return ro(e,t)}getEffectiveKeywordSettings(e){return Wn(this.settings,e)}buildKeywordMap(){return Gn(this.app,this.settings)}checkLinkScope(e,t,n,s){return jn(this.app,e,t,n,s,Yt)}findTargetFile(e){return Yt(this.app,e)}getAliasesForNote(e){return Hn(this.app,e)}noteHasTag(e,t){return Un(this.app,e,t)}noteHasLinkToTarget(e,t){return _n(this.app,e,t)}async ensureNoteExists(e){return await Zn(this.app,this.settings,e)}async saveSettings(){await On(this,this.settings)}addCustomStyles(){return es()}async addKeywordFromSelection(e){let{generateId:t}=z(),{Notice:n}=require("obsidian");if(this.settings.keywords.find(l=>l.keyword.toLowerCase()===e.toLowerCase())){new n(`Keyword "${e}" already exists`);return}let a={id:t("kw"),keyword:e,target:e,variations:[],enableTags:null,linkScope:"vault-wide",scopeFolder:"",useRelativeLinks:null,blockRef:"",requireTag:"",onlyInNotesLinkingTo:null,suggestMode:null,preventSelfLink:null,collapsed:!1,groupId:null};this.settings.keywords.push(a),await this.saveSettings(),this.scrollToKeywordId=a.id,this.app.setting.open(),this.app.setting.openTabById(this.manifest.id)}};

/* nosourcemap */